import{b7 as Fb,b8 as Mn,c as Yr,g as Fu,b9 as zb}from"./index-UlzrWozH.js";import{e as qr,$ as zu}from"./events-FWMKtoro.js";var Hu={},na={},Le={},kd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,y){var p=f>>>16&65535,v=f&65535,S=y>>>16&65535,D=y&65535;return v*D+(p*D+v*S<<16>>>0)|0}i.mul=Math.imul||e;function t(f,y){return f+y|0}i.add=t;function s(f,y){return f-y|0}i.sub=s;function o(f,y){return f<<y|f>>>32-y}i.rotl=o;function c(f,y){return f<<32-y|f>>>y}i.rotr=c;function l(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||l,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(kd);Object.defineProperty(Le,"__esModule",{value:!0});var Gd=kd;function Hb(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Le.readInt16BE=Hb;function Bb(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Le.readUint16BE=Bb;function Kb(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Le.readInt16LE=Kb;function Vb(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Le.readUint16LE=Vb;function Wd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Le.writeUint16BE=Wd;Le.writeInt16BE=Wd;function Yd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Le.writeUint16LE=Yd;Le.writeInt16LE=Yd;function uu(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Le.readInt32BE=uu;function hu(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Le.readUint32BE=hu;function lu(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Le.readInt32LE=lu;function fu(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Le.readUint32LE=fu;function Qo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Le.writeUint32BE=Qo;Le.writeInt32BE=Qo;function Xo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Le.writeUint32LE=Xo;Le.writeInt32LE=Xo;function kb(i,e){e===void 0&&(e=0);var t=uu(i,e),s=uu(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=kb;function Gb(i,e){e===void 0&&(e=0);var t=hu(i,e),s=hu(i,e+4);return t*4294967296+s}Le.readUint64BE=Gb;function Wb(i,e){e===void 0&&(e=0);var t=lu(i,e),s=lu(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Le.readInt64LE=Wb;function Yb(i,e){e===void 0&&(e=0);var t=fu(i,e),s=fu(i,e+4);return s*4294967296+t}Le.readUint64LE=Yb;function Jd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Qo(i/4294967296>>>0,e,t),Qo(i>>>0,e,t+4),e}Le.writeUint64BE=Jd;Le.writeInt64BE=Jd;function Qd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Xo(i>>>0,e,t),Xo(i/4294967296>>>0,e,t+4),e}Le.writeUint64LE=Qd;Le.writeInt64LE=Qd;function Jb(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Le.readUintBE=Jb;function Qb(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Le.readUintLE=Qb;function Xb(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Gd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Le.writeUintBE=Xb;function Zb(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Gd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Le.writeUintLE=Zb;function ew(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Le.readFloat32BE=ew;function tw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Le.readFloat32LE=tw;function rw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Le.readFloat64BE=rw;function iw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Le.readFloat64LE=iw;function nw(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Le.writeFloat32BE=nw;function sw(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Le.writeFloat32LE=sw;function ow(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Le.writeFloat64BE=ow;function aw(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Le.writeFloat64LE=aw;var Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});function cw(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Pr.wipe=cw;Object.defineProperty(na,"__esModule",{value:!0});var Zt=Le,du=Pr,uw=20;function hw(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,l=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],y=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],v=t[15]<<24|t[14]<<16|t[13]<<8|t[12],S=t[19]<<24|t[18]<<16|t[17]<<8|t[16],D=t[23]<<24|t[22]<<16|t[21]<<8|t[20],x=t[27]<<24|t[26]<<16|t[25]<<8|t[24],O=t[31]<<24|t[30]<<16|t[29]<<8|t[28],z=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ne=e[11]<<24|e[10]<<16|e[9]<<8|e[8],$=e[15]<<24|e[14]<<16|e[13]<<8|e[12],L=s,P=o,R=c,E=l,u=f,b=y,G=p,W=v,se=S,ce=D,de=x,w=O,A=z,ee=B,Q=ne,V=$,k=0;k<uw;k+=2)L=L+u|0,A^=L,A=A>>>16|A<<16,se=se+A|0,u^=se,u=u>>>20|u<<12,P=P+b|0,ee^=P,ee=ee>>>16|ee<<16,ce=ce+ee|0,b^=ce,b=b>>>20|b<<12,R=R+G|0,Q^=R,Q=Q>>>16|Q<<16,de=de+Q|0,G^=de,G=G>>>20|G<<12,E=E+W|0,V^=E,V=V>>>16|V<<16,w=w+V|0,W^=w,W=W>>>20|W<<12,R=R+G|0,Q^=R,Q=Q>>>24|Q<<8,de=de+Q|0,G^=de,G=G>>>25|G<<7,E=E+W|0,V^=E,V=V>>>24|V<<8,w=w+V|0,W^=w,W=W>>>25|W<<7,P=P+b|0,ee^=P,ee=ee>>>24|ee<<8,ce=ce+ee|0,b^=ce,b=b>>>25|b<<7,L=L+u|0,A^=L,A=A>>>24|A<<8,se=se+A|0,u^=se,u=u>>>25|u<<7,L=L+b|0,V^=L,V=V>>>16|V<<16,de=de+V|0,b^=de,b=b>>>20|b<<12,P=P+G|0,A^=P,A=A>>>16|A<<16,w=w+A|0,G^=w,G=G>>>20|G<<12,R=R+W|0,ee^=R,ee=ee>>>16|ee<<16,se=se+ee|0,W^=se,W=W>>>20|W<<12,E=E+u|0,Q^=E,Q=Q>>>16|Q<<16,ce=ce+Q|0,u^=ce,u=u>>>20|u<<12,R=R+W|0,ee^=R,ee=ee>>>24|ee<<8,se=se+ee|0,W^=se,W=W>>>25|W<<7,E=E+u|0,Q^=E,Q=Q>>>24|Q<<8,ce=ce+Q|0,u^=ce,u=u>>>25|u<<7,P=P+G|0,A^=P,A=A>>>24|A<<8,w=w+A|0,G^=w,G=G>>>25|G<<7,L=L+b|0,V^=L,V=V>>>24|V<<8,de=de+V|0,b^=de,b=b>>>25|b<<7;Zt.writeUint32LE(L+s|0,i,0),Zt.writeUint32LE(P+o|0,i,4),Zt.writeUint32LE(R+c|0,i,8),Zt.writeUint32LE(E+l|0,i,12),Zt.writeUint32LE(u+f|0,i,16),Zt.writeUint32LE(b+y|0,i,20),Zt.writeUint32LE(G+p|0,i,24),Zt.writeUint32LE(W+v|0,i,28),Zt.writeUint32LE(se+S|0,i,32),Zt.writeUint32LE(ce+D|0,i,36),Zt.writeUint32LE(de+x|0,i,40),Zt.writeUint32LE(w+O|0,i,44),Zt.writeUint32LE(A+z|0,i,48),Zt.writeUint32LE(ee+B|0,i,52),Zt.writeUint32LE(Q+ne|0,i,56),Zt.writeUint32LE(V+$|0,i,60)}function Xd(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,l;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),l=c.length-e.length,c.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,l=o}for(var f=new Uint8Array(64),y=0;y<t.length;y+=64){hw(f,c,i);for(var p=y;p<y+64&&p<t.length;p++)s[p]=t[p]^f[p-y];fw(c,0,l)}return du.wipe(f),o===0&&du.wipe(c),s}na.streamXOR=Xd;function lw(i,e,t,s){return s===void 0&&(s=0),du.wipe(t),Xd(i,e,t,t,s)}na.stream=lw;function fw(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Zd={},Mi={};Object.defineProperty(Mi,"__esModule",{value:!0});function dw(i,e,t){return~(i-1)&e|i-1&t}Mi.select=dw;function pw(i,e){return(i|0)-(e|0)-1>>>31&1}Mi.lessOrEqual=pw;function ep(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Mi.compare=ep;function gw(i,e){return i.length===0||e.length===0?!1:ep(i,e)!==0}Mi.equal=gw;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Mi,t=Pr;i.DIGEST_LENGTH=16;var s=function(){function l(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=f[0]|f[1]<<8;this._r[0]=y&8191;var p=f[2]|f[3]<<8;this._r[1]=(y>>>13|p<<3)&8191;var v=f[4]|f[5]<<8;this._r[2]=(p>>>10|v<<6)&7939;var S=f[6]|f[7]<<8;this._r[3]=(v>>>7|S<<9)&8191;var D=f[8]|f[9]<<8;this._r[4]=(S>>>4|D<<12)&255,this._r[5]=D>>>1&8190;var x=f[10]|f[11]<<8;this._r[6]=(D>>>14|x<<2)&8191;var O=f[12]|f[13]<<8;this._r[7]=(x>>>11|O<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(O>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return l.prototype._blocks=function(f,y,p){for(var v=this._fin?0:2048,S=this._h[0],D=this._h[1],x=this._h[2],O=this._h[3],z=this._h[4],B=this._h[5],ne=this._h[6],$=this._h[7],L=this._h[8],P=this._h[9],R=this._r[0],E=this._r[1],u=this._r[2],b=this._r[3],G=this._r[4],W=this._r[5],se=this._r[6],ce=this._r[7],de=this._r[8],w=this._r[9];p>=16;){var A=f[y+0]|f[y+1]<<8;S+=A&8191;var ee=f[y+2]|f[y+3]<<8;D+=(A>>>13|ee<<3)&8191;var Q=f[y+4]|f[y+5]<<8;x+=(ee>>>10|Q<<6)&8191;var V=f[y+6]|f[y+7]<<8;O+=(Q>>>7|V<<9)&8191;var k=f[y+8]|f[y+9]<<8;z+=(V>>>4|k<<12)&8191,B+=k>>>1&8191;var J=f[y+10]|f[y+11]<<8;ne+=(k>>>14|J<<2)&8191;var re=f[y+12]|f[y+13]<<8;$+=(J>>>11|re<<5)&8191;var be=f[y+14]|f[y+15]<<8;L+=(re>>>8|be<<8)&8191,P+=be>>>5|v;var oe=0,we=oe;we+=S*R,we+=D*(5*w),we+=x*(5*de),we+=O*(5*ce),we+=z*(5*se),oe=we>>>13,we&=8191,we+=B*(5*W),we+=ne*(5*G),we+=$*(5*b),we+=L*(5*u),we+=P*(5*E),oe+=we>>>13,we&=8191;var le=oe;le+=S*E,le+=D*R,le+=x*(5*w),le+=O*(5*de),le+=z*(5*ce),oe=le>>>13,le&=8191,le+=B*(5*se),le+=ne*(5*W),le+=$*(5*G),le+=L*(5*b),le+=P*(5*u),oe+=le>>>13,le&=8191;var _e=oe;_e+=S*u,_e+=D*E,_e+=x*R,_e+=O*(5*w),_e+=z*(5*de),oe=_e>>>13,_e&=8191,_e+=B*(5*ce),_e+=ne*(5*se),_e+=$*(5*W),_e+=L*(5*G),_e+=P*(5*b),oe+=_e>>>13,_e&=8191;var H=oe;H+=S*b,H+=D*u,H+=x*E,H+=O*R,H+=z*(5*w),oe=H>>>13,H&=8191,H+=B*(5*de),H+=ne*(5*ce),H+=$*(5*se),H+=L*(5*W),H+=P*(5*G),oe+=H>>>13,H&=8191;var F=oe;F+=S*G,F+=D*b,F+=x*u,F+=O*E,F+=z*R,oe=F>>>13,F&=8191,F+=B*(5*w),F+=ne*(5*de),F+=$*(5*ce),F+=L*(5*se),F+=P*(5*W),oe+=F>>>13,F&=8191;var U=oe;U+=S*W,U+=D*G,U+=x*b,U+=O*u,U+=z*E,oe=U>>>13,U&=8191,U+=B*R,U+=ne*(5*w),U+=$*(5*de),U+=L*(5*ce),U+=P*(5*se),oe+=U>>>13,U&=8191;var d=oe;d+=S*se,d+=D*W,d+=x*G,d+=O*b,d+=z*u,oe=d>>>13,d&=8191,d+=B*E,d+=ne*R,d+=$*(5*w),d+=L*(5*de),d+=P*(5*ce),oe+=d>>>13,d&=8191;var T=oe;T+=S*ce,T+=D*se,T+=x*W,T+=O*G,T+=z*b,oe=T>>>13,T&=8191,T+=B*u,T+=ne*E,T+=$*R,T+=L*(5*w),T+=P*(5*de),oe+=T>>>13,T&=8191;var ae=oe;ae+=S*de,ae+=D*ce,ae+=x*se,ae+=O*W,ae+=z*G,oe=ae>>>13,ae&=8191,ae+=B*b,ae+=ne*u,ae+=$*E,ae+=L*R,ae+=P*(5*w),oe+=ae>>>13,ae&=8191;var fe=oe;fe+=S*w,fe+=D*de,fe+=x*ce,fe+=O*se,fe+=z*W,oe=fe>>>13,fe&=8191,fe+=B*G,fe+=ne*b,fe+=$*u,fe+=L*E,fe+=P*R,oe+=fe>>>13,fe&=8191,oe=(oe<<2)+oe|0,oe=oe+we|0,we=oe&8191,oe=oe>>>13,le+=oe,S=we,D=le,x=_e,O=H,z=F,B=U,ne=d,$=T,L=ae,P=fe,y+=16,p-=16}this._h[0]=S,this._h[1]=D,this._h[2]=x,this._h[3]=O,this._h[4]=z,this._h[5]=B,this._h[6]=ne,this._h[7]=$,this._h[8]=L,this._h[9]=P},l.prototype.finish=function(f,y){y===void 0&&(y=0);var p=new Uint16Array(10),v,S,D,x;if(this._leftover){for(x=this._leftover,this._buffer[x++]=1;x<16;x++)this._buffer[x]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(v=this._h[1]>>>13,this._h[1]&=8191,x=2;x<10;x++)this._h[x]+=v,v=this._h[x]>>>13,this._h[x]&=8191;for(this._h[0]+=v*5,v=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=v,v=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=v,p[0]=this._h[0]+5,v=p[0]>>>13,p[0]&=8191,x=1;x<10;x++)p[x]=this._h[x]+v,v=p[x]>>>13,p[x]&=8191;for(p[9]-=8192,S=(v^1)-1,x=0;x<10;x++)p[x]&=S;for(S=~S,x=0;x<10;x++)this._h[x]=this._h[x]&S|p[x];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,D=this._h[0]+this._pad[0],this._h[0]=D&65535,x=1;x<8;x++)D=(this._h[x]+this._pad[x]|0)+(D>>>16)|0,this._h[x]=D&65535;return f[y+0]=this._h[0]>>>0,f[y+1]=this._h[0]>>>8,f[y+2]=this._h[1]>>>0,f[y+3]=this._h[1]>>>8,f[y+4]=this._h[2]>>>0,f[y+5]=this._h[2]>>>8,f[y+6]=this._h[3]>>>0,f[y+7]=this._h[3]>>>8,f[y+8]=this._h[4]>>>0,f[y+9]=this._h[4]>>>8,f[y+10]=this._h[5]>>>0,f[y+11]=this._h[5]>>>8,f[y+12]=this._h[6]>>>0,f[y+13]=this._h[6]>>>8,f[y+14]=this._h[7]>>>0,f[y+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(f){var y=0,p=f.length,v;if(this._leftover){v=16-this._leftover,v>p&&(v=p);for(var S=0;S<v;S++)this._buffer[this._leftover+S]=f[y+S];if(p-=v,y+=v,this._leftover+=v,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(v=p-p%16,this._blocks(f,y,v),y+=v,p-=v),p){for(var S=0;S<p;S++)this._buffer[this._leftover+S]=f[y+S];this._leftover+=p}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},l.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();i.Poly1305=s;function o(l,f){var y=new s(l);y.update(f);var p=y.digest();return y.clean(),p}i.oneTimeAuth=o;function c(l,f){return l.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(l,f)}i.equal=c})(Zd);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=na,t=Zd,s=Pr,o=Le,c=Mi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var l=new Uint8Array(16),f=function(){function y(p){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,p.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return y.prototype.seal=function(p,v,S,D){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var x=new Uint8Array(16);x.set(p,x.length-p.length);var O=new Uint8Array(32);e.stream(this._key,x,O,4);var z=v.length+this.tagLength,B;if(D){if(D.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");B=D}else B=new Uint8Array(z);return e.streamXOR(this._key,x,v,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),O,B.subarray(0,B.length-this.tagLength),S),s.wipe(x),B},y.prototype.open=function(p,v,S,D){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(v.length<this.tagLength)return null;var x=new Uint8Array(16);x.set(p,x.length-p.length);var O=new Uint8Array(32);e.stream(this._key,x,O,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,O,v.subarray(0,v.length-this.tagLength),S),!c.equal(z,v.subarray(v.length-this.tagLength,v.length)))return null;var B=v.length-this.tagLength,ne;if(D){if(D.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");ne=D}else ne=new Uint8Array(B);return e.streamXOR(this._key,x,v.subarray(0,v.length-this.tagLength),ne,4),s.wipe(x),ne},y.prototype.clean=function(){return s.wipe(this._key),this},y.prototype._authenticate=function(p,v,S,D){var x=new t.Poly1305(v);D&&(x.update(D),D.length%16>0&&x.update(l.subarray(D.length%16))),x.update(S),S.length%16>0&&x.update(l.subarray(S.length%16));var O=new Uint8Array(8);D&&o.writeUint64LE(D.length,O),x.update(O),o.writeUint64LE(S.length,O),x.update(O);for(var z=x.digest(),B=0;B<z.length;B++)p[B]=z[B];x.clean(),s.wipe(z),s.wipe(O)},y}();i.ChaCha20Poly1305=f})(Hu);var tp={},Cs={},Bu={};Object.defineProperty(Bu,"__esModule",{value:!0});function yw(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}Bu.isSerializableHash=yw;Object.defineProperty(Cs,"__esModule",{value:!0});var ri=Bu,vw=Mi,_w=Pr,rp=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),ri.isSerializableHash(this._inner)&&ri.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),_w.wipe(s)}return i.prototype.reset=function(){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){ri.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ri.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Cs.HMAC=rp;function mw(i,e,t){var s=new rp(i,e);s.update(t);var o=s.digest();return s.clean(),o}Cs.hmac=mw;Cs.equal=vw.equal;Object.defineProperty(tp,"__esModule",{value:!0});var uf=Cs,hf=Pr,bw=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=uf.hmac(this._hash,s,t);this._hmac=new uf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),hf.wipe(this._buffer),hf.wipe(this._counter),this._bufpos=0},i}(),ww=tp.HKDF=bw,qn={},sa={},oa={};Object.defineProperty(oa,"__esModule",{value:!0});oa.BrowserRandomSource=void 0;const lf=65536;class Ew{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=lf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,lf)));return t}}oa.BrowserRandomSource=Ew;function Dw(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.NodeRandomSource=void 0;const Sw=Pr;class Iw{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Dw<"u"){const e=Fb;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,Sw.wipe)(t),s}}aa.NodeRandomSource=Iw;Object.defineProperty(sa,"__esModule",{value:!0});sa.SystemRandomSource=void 0;const xw=oa,Ow=aa;class Pw{constructor(){if(this.isAvailable=!1,this.name="",this._source=new xw.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Ow.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}sa.SystemRandomSource=Pw;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=sa,t=Le,s=Pr;i.defaultRandomSource=new e.SystemRandomSource;function o(p,v=i.defaultRandomSource){return v.randomBytes(p)}i.randomBytes=o;function c(p=i.defaultRandomSource){const v=o(4,p),S=(0,t.readUint32LE)(v);return(0,s.wipe)(v),S}i.randomUint32=c;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(p,v=l,S=i.defaultRandomSource){if(v.length<2)throw new Error("randomString charset is too short");if(v.length>256)throw new Error("randomString charset is too long");let D="";const x=v.length,O=256-256%x;for(;p>0;){const z=o(Math.ceil(p*256/O),S);for(let B=0;B<z.length&&p>0;B++){const ne=z[B];ne<O&&(D+=v.charAt(ne%x),p--)}(0,s.wipe)(z)}return D}i.randomString=f;function y(p,v=l,S=i.defaultRandomSource){const D=Math.ceil(p/(Math.log(v.length)/Math.LN2));return f(D,v,S)}i.randomStringForEntropy=y})(qn);var ca={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Pr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(y,p){if(p===void 0&&(p=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=y[v++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._temp,this._state,y,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=y[v++],p--;return this},f.prototype.finish=function(y){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,S=p/536870912|0,D=p<<3,x=p%64<56?64:128;this._buffer[v]=128;for(var O=v+1;O<x-8;O++)this._buffer[O]=0;e.writeUint32BE(S,this._buffer,x-8),e.writeUint32BE(D,this._buffer,x-4),c(this._temp,this._state,this._buffer,0,x),this._finished=!0}for(var O=0;O<this.digestLength/4;O++)e.writeUint32BE(this._state[O],y,O*4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.state),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,y,p,v,S){for(;S>=64;){for(var D=y[0],x=y[1],O=y[2],z=y[3],B=y[4],ne=y[5],$=y[6],L=y[7],P=0;P<16;P++){var R=v+P*4;f[P]=e.readUint32BE(p,R)}for(var P=16;P<64;P++){var E=f[P-2],u=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=f[P-15];var b=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;f[P]=(u+f[P-7]|0)+(b+f[P-16]|0)}for(var P=0;P<64;P++){var u=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&ne^~B&$)|0)+(L+(o[P]+f[P]|0)|0)|0,b=((D>>>2|D<<30)^(D>>>13|D<<19)^(D>>>22|D<<10))+(D&x^D&O^x&O)|0;L=$,$=ne,ne=B,B=z+u|0,z=O,O=x,x=D,D=u+b|0}y[0]+=D,y[1]+=x,y[2]+=O,y[3]+=z,y[4]+=B,y[5]+=ne,y[6]+=$,y[7]+=L,v+=64,S-=64}return v}function l(f){var y=new s;y.update(f);var p=y.digest();return y.clean(),p}i.hash=l})(ca);var Ku={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=qn,t=Pr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(P){const R=new Float64Array(16);if(P)for(let E=0;E<P.length;E++)R[E]=P[E];return R}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function l(P){let R=1;for(let E=0;E<16;E++){let u=P[E]+R+65535;R=Math.floor(u/65536),P[E]=u-R*65536}P[0]+=R-1+37*(R-1)}function f(P,R,E){const u=~(E-1);for(let b=0;b<16;b++){const G=u&(P[b]^R[b]);P[b]^=G,R[b]^=G}}function y(P,R){const E=s(),u=s();for(let b=0;b<16;b++)u[b]=R[b];l(u),l(u),l(u);for(let b=0;b<2;b++){E[0]=u[0]-65517;for(let W=1;W<15;W++)E[W]=u[W]-65535-(E[W-1]>>16&1),E[W-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const G=E[15]>>16&1;E[14]&=65535,f(u,E,1-G)}for(let b=0;b<16;b++)P[2*b]=u[b]&255,P[2*b+1]=u[b]>>8}function p(P,R){for(let E=0;E<16;E++)P[E]=R[2*E]+(R[2*E+1]<<8);P[15]&=32767}function v(P,R,E){for(let u=0;u<16;u++)P[u]=R[u]+E[u]}function S(P,R,E){for(let u=0;u<16;u++)P[u]=R[u]-E[u]}function D(P,R,E){let u,b,G=0,W=0,se=0,ce=0,de=0,w=0,A=0,ee=0,Q=0,V=0,k=0,J=0,re=0,be=0,oe=0,we=0,le=0,_e=0,H=0,F=0,U=0,d=0,T=0,ae=0,fe=0,Ie=0,He=0,Ve=0,je=0,pt=0,gt=0,qe=E[0],xe=E[1],Ne=E[2],$e=E[3],Fe=E[4],Pe=E[5],Ue=E[6],Se=E[7],Ce=E[8],Be=E[9],Oe=E[10],ke=E[11],We=E[12],et=E[13],tt=E[14],Qe=E[15];u=R[0],G+=u*qe,W+=u*xe,se+=u*Ne,ce+=u*$e,de+=u*Fe,w+=u*Pe,A+=u*Ue,ee+=u*Se,Q+=u*Ce,V+=u*Be,k+=u*Oe,J+=u*ke,re+=u*We,be+=u*et,oe+=u*tt,we+=u*Qe,u=R[1],W+=u*qe,se+=u*xe,ce+=u*Ne,de+=u*$e,w+=u*Fe,A+=u*Pe,ee+=u*Ue,Q+=u*Se,V+=u*Ce,k+=u*Be,J+=u*Oe,re+=u*ke,be+=u*We,oe+=u*et,we+=u*tt,le+=u*Qe,u=R[2],se+=u*qe,ce+=u*xe,de+=u*Ne,w+=u*$e,A+=u*Fe,ee+=u*Pe,Q+=u*Ue,V+=u*Se,k+=u*Ce,J+=u*Be,re+=u*Oe,be+=u*ke,oe+=u*We,we+=u*et,le+=u*tt,_e+=u*Qe,u=R[3],ce+=u*qe,de+=u*xe,w+=u*Ne,A+=u*$e,ee+=u*Fe,Q+=u*Pe,V+=u*Ue,k+=u*Se,J+=u*Ce,re+=u*Be,be+=u*Oe,oe+=u*ke,we+=u*We,le+=u*et,_e+=u*tt,H+=u*Qe,u=R[4],de+=u*qe,w+=u*xe,A+=u*Ne,ee+=u*$e,Q+=u*Fe,V+=u*Pe,k+=u*Ue,J+=u*Se,re+=u*Ce,be+=u*Be,oe+=u*Oe,we+=u*ke,le+=u*We,_e+=u*et,H+=u*tt,F+=u*Qe,u=R[5],w+=u*qe,A+=u*xe,ee+=u*Ne,Q+=u*$e,V+=u*Fe,k+=u*Pe,J+=u*Ue,re+=u*Se,be+=u*Ce,oe+=u*Be,we+=u*Oe,le+=u*ke,_e+=u*We,H+=u*et,F+=u*tt,U+=u*Qe,u=R[6],A+=u*qe,ee+=u*xe,Q+=u*Ne,V+=u*$e,k+=u*Fe,J+=u*Pe,re+=u*Ue,be+=u*Se,oe+=u*Ce,we+=u*Be,le+=u*Oe,_e+=u*ke,H+=u*We,F+=u*et,U+=u*tt,d+=u*Qe,u=R[7],ee+=u*qe,Q+=u*xe,V+=u*Ne,k+=u*$e,J+=u*Fe,re+=u*Pe,be+=u*Ue,oe+=u*Se,we+=u*Ce,le+=u*Be,_e+=u*Oe,H+=u*ke,F+=u*We,U+=u*et,d+=u*tt,T+=u*Qe,u=R[8],Q+=u*qe,V+=u*xe,k+=u*Ne,J+=u*$e,re+=u*Fe,be+=u*Pe,oe+=u*Ue,we+=u*Se,le+=u*Ce,_e+=u*Be,H+=u*Oe,F+=u*ke,U+=u*We,d+=u*et,T+=u*tt,ae+=u*Qe,u=R[9],V+=u*qe,k+=u*xe,J+=u*Ne,re+=u*$e,be+=u*Fe,oe+=u*Pe,we+=u*Ue,le+=u*Se,_e+=u*Ce,H+=u*Be,F+=u*Oe,U+=u*ke,d+=u*We,T+=u*et,ae+=u*tt,fe+=u*Qe,u=R[10],k+=u*qe,J+=u*xe,re+=u*Ne,be+=u*$e,oe+=u*Fe,we+=u*Pe,le+=u*Ue,_e+=u*Se,H+=u*Ce,F+=u*Be,U+=u*Oe,d+=u*ke,T+=u*We,ae+=u*et,fe+=u*tt,Ie+=u*Qe,u=R[11],J+=u*qe,re+=u*xe,be+=u*Ne,oe+=u*$e,we+=u*Fe,le+=u*Pe,_e+=u*Ue,H+=u*Se,F+=u*Ce,U+=u*Be,d+=u*Oe,T+=u*ke,ae+=u*We,fe+=u*et,Ie+=u*tt,He+=u*Qe,u=R[12],re+=u*qe,be+=u*xe,oe+=u*Ne,we+=u*$e,le+=u*Fe,_e+=u*Pe,H+=u*Ue,F+=u*Se,U+=u*Ce,d+=u*Be,T+=u*Oe,ae+=u*ke,fe+=u*We,Ie+=u*et,He+=u*tt,Ve+=u*Qe,u=R[13],be+=u*qe,oe+=u*xe,we+=u*Ne,le+=u*$e,_e+=u*Fe,H+=u*Pe,F+=u*Ue,U+=u*Se,d+=u*Ce,T+=u*Be,ae+=u*Oe,fe+=u*ke,Ie+=u*We,He+=u*et,Ve+=u*tt,je+=u*Qe,u=R[14],oe+=u*qe,we+=u*xe,le+=u*Ne,_e+=u*$e,H+=u*Fe,F+=u*Pe,U+=u*Ue,d+=u*Se,T+=u*Ce,ae+=u*Be,fe+=u*Oe,Ie+=u*ke,He+=u*We,Ve+=u*et,je+=u*tt,pt+=u*Qe,u=R[15],we+=u*qe,le+=u*xe,_e+=u*Ne,H+=u*$e,F+=u*Fe,U+=u*Pe,d+=u*Ue,T+=u*Se,ae+=u*Ce,fe+=u*Be,Ie+=u*Oe,He+=u*ke,Ve+=u*We,je+=u*et,pt+=u*tt,gt+=u*Qe,G+=38*le,W+=38*_e,se+=38*H,ce+=38*F,de+=38*U,w+=38*d,A+=38*T,ee+=38*ae,Q+=38*fe,V+=38*Ie,k+=38*He,J+=38*Ve,re+=38*je,be+=38*pt,oe+=38*gt,b=1,u=G+b+65535,b=Math.floor(u/65536),G=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=se+b+65535,b=Math.floor(u/65536),se=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=w+b+65535,b=Math.floor(u/65536),w=u-b*65536,u=A+b+65535,b=Math.floor(u/65536),A=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Q+b+65535,b=Math.floor(u/65536),Q=u-b*65536,u=V+b+65535,b=Math.floor(u/65536),V=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,G+=b-1+37*(b-1),b=1,u=G+b+65535,b=Math.floor(u/65536),G=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=se+b+65535,b=Math.floor(u/65536),se=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=w+b+65535,b=Math.floor(u/65536),w=u-b*65536,u=A+b+65535,b=Math.floor(u/65536),A=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Q+b+65535,b=Math.floor(u/65536),Q=u-b*65536,u=V+b+65535,b=Math.floor(u/65536),V=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,G+=b-1+37*(b-1),P[0]=G,P[1]=W,P[2]=se,P[3]=ce,P[4]=de,P[5]=w,P[6]=A,P[7]=ee,P[8]=Q,P[9]=V,P[10]=k,P[11]=J,P[12]=re,P[13]=be,P[14]=oe,P[15]=we}function x(P,R){D(P,R,R)}function O(P,R){const E=s();for(let u=0;u<16;u++)E[u]=R[u];for(let u=253;u>=0;u--)x(E,E),u!==2&&u!==4&&D(E,E,R);for(let u=0;u<16;u++)P[u]=E[u]}function z(P,R){const E=new Uint8Array(32),u=new Float64Array(80),b=s(),G=s(),W=s(),se=s(),ce=s(),de=s();for(let Q=0;Q<31;Q++)E[Q]=P[Q];E[31]=P[31]&127|64,E[0]&=248,p(u,R);for(let Q=0;Q<16;Q++)G[Q]=u[Q];b[0]=se[0]=1;for(let Q=254;Q>=0;--Q){const V=E[Q>>>3]>>>(Q&7)&1;f(b,G,V),f(W,se,V),v(ce,b,W),S(b,b,W),v(W,G,se),S(G,G,se),x(se,ce),x(de,b),D(b,W,b),D(W,G,ce),v(ce,b,W),S(b,b,W),x(G,b),S(W,se,de),D(b,W,c),v(b,b,se),D(W,W,b),D(b,se,de),D(se,G,u),x(G,ce),f(b,G,V),f(W,se,V)}for(let Q=0;Q<16;Q++)u[Q+16]=b[Q],u[Q+32]=W[Q],u[Q+48]=G[Q],u[Q+64]=se[Q];const w=u.subarray(32),A=u.subarray(16);O(w,w),D(A,A,w);const ee=new Uint8Array(32);return y(ee,A),ee}i.scalarMult=z;function B(P){return z(P,o)}i.scalarMultBase=B;function ne(P){if(P.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const R=new Uint8Array(P);return{publicKey:B(R),secretKey:R}}i.generateKeyPairFromSeed=ne;function $(P){const R=(0,e.randomBytes)(32,P),E=ne(R);return(0,t.wipe)(R),E}i.generateKeyPair=$;function L(P,R,E=!1){if(P.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(R.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=z(P,R);if(E){let b=0;for(let G=0;G<u.length;G++)b|=u[G];if(b===0)throw new Error("X25519: invalid shared key")}return u}i.sharedKey=L})(Ku);function Vu(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function ip(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Vu(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function pu(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=ip(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return Vu(t)}function Cw(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,y=i.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function S(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var z=0,B=0,ne=0,$=O.length;ne!==$&&O[ne]===0;)ne++,z++;for(var L=($-ne)*v+1>>>0,P=new Uint8Array(L);ne!==$;){for(var R=O[ne],E=0,u=L-1;(R!==0||E<B)&&u!==-1;u--,E++)R+=256*P[u]>>>0,P[u]=R%f>>>0,R=R/f>>>0;if(R!==0)throw new Error("Non-zero carry");B=E,ne++}for(var b=L-B;b!==L&&P[b]===0;)b++;for(var G=y.repeat(z);b<L;++b)G+=i.charAt(P[b]);return G}function D(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var z=0;if(O[z]!==" "){for(var B=0,ne=0;O[z]===y;)B++,z++;for(var $=(O.length-z)*p+1>>>0,L=new Uint8Array($);O[z];){var P=t[O.charCodeAt(z)];if(P===255)return;for(var R=0,E=$-1;(P!==0||R<ne)&&E!==-1;E--,R++)P+=f*L[E]>>>0,L[E]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");ne=R,z++}if(O[z]!==" "){for(var u=$-ne;u!==$&&L[u]===0;)u++;for(var b=new Uint8Array(B+($-u)),G=B;u!==$;)b[G++]=L[u++];return b}}}function x(O){var z=D(O);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:S,decodeUnsafe:D,decode:x}}var Aw=Cw,Tw=Aw;const Rw=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},Nw=i=>new TextEncoder().encode(i),$w=i=>new TextDecoder().decode(i);class Uw{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Lw{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return np(this,e)}}class jw{constructor(e){this.decoders=e}or(e){return np(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const np=(i,e)=>new jw({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class Mw{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new Uw(e,t,s),this.decoder=new Lw(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ua=({name:i,prefix:e,encode:t,decode:s})=>new Mw(i,e,t,s),As=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=Tw(t,e);return ua({prefix:i,name:e,encode:s,decode:c=>Rw(o(c))})},qw=(i,e,t,s)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,y=0,p=0;for(let v=0;v<c;++v){const S=o[i[v]];if(S===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|S,f+=t,f>=8&&(f-=8,l[p++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return l},Fw=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Yt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ua({prefix:e,name:i,encode(o){return Fw(o,s,t)},decode(o){return qw(o,s,t,i)}}),zw=ua({prefix:"\0",name:"identity",encode:i=>$w(i),decode:i=>Nw(i)}),Hw=Object.freeze(Object.defineProperty({__proto__:null,identity:zw},Symbol.toStringTag,{value:"Module"})),Bw=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Kw=Object.freeze(Object.defineProperty({__proto__:null,base2:Bw},Symbol.toStringTag,{value:"Module"})),Vw=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),kw=Object.freeze(Object.defineProperty({__proto__:null,base8:Vw},Symbol.toStringTag,{value:"Module"})),Gw=As({prefix:"9",name:"base10",alphabet:"0123456789"}),Ww=Object.freeze(Object.defineProperty({__proto__:null,base10:Gw},Symbol.toStringTag,{value:"Module"})),Yw=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Jw=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Qw=Object.freeze(Object.defineProperty({__proto__:null,base16:Yw,base16upper:Jw},Symbol.toStringTag,{value:"Module"})),Xw=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Zw=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),e1=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),t1=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),r1=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),i1=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),n1=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),s1=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),o1=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),a1=Object.freeze(Object.defineProperty({__proto__:null,base32:Xw,base32hex:r1,base32hexpad:n1,base32hexpadupper:s1,base32hexupper:i1,base32pad:e1,base32padupper:t1,base32upper:Zw,base32z:o1},Symbol.toStringTag,{value:"Module"})),c1=As({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),u1=As({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),h1=Object.freeze(Object.defineProperty({__proto__:null,base36:c1,base36upper:u1},Symbol.toStringTag,{value:"Module"})),l1=As({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),f1=As({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),d1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:l1,base58flickr:f1},Symbol.toStringTag,{value:"Module"})),p1=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),g1=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),y1=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),v1=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),_1=Object.freeze(Object.defineProperty({__proto__:null,base64:p1,base64pad:g1,base64url:y1,base64urlpad:v1},Symbol.toStringTag,{value:"Module"})),sp=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),m1=sp.reduce((i,e,t)=>(i[t]=e,i),[]),b1=sp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function w1(i){return i.reduce((e,t)=>(e+=m1[t],e),"")}function E1(i){const e=[];for(const t of i){const s=b1[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const D1=ua({prefix:"ðŸš€",name:"base256emoji",encode:w1,decode:E1}),S1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:D1},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const ff={...Hw,...Kw,...kw,...Ww,...Qw,...a1,...h1,...d1,..._1,...S1};function op(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const df=op("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),zc=op("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=ip(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),ap={utf8:df,"utf-8":df,hex:ff.base16,latin1:zc,ascii:zc,binary:zc,...ff};function br(i,e="utf8"){const t=ap[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Vu(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function hr(i,e="utf8"){const t=ap[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var pf=function(i,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,c;s<o;s++)(c||!(s in e))&&(c||(c=Array.prototype.slice.call(e,0,s)),c[s]=e[s]);return i.concat(c||Array.prototype.slice.call(e))},I1=function(){function i(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return i}(),x1=function(){function i(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return i}(),O1=function(){function i(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return i}(),P1=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),C1=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),A1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,T1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,gf=3,R1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",A1]],yf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function N1(i){return i?vf(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new C1:typeof navigator<"u"?vf(navigator.userAgent):L1()}function $1(i){return i!==""&&R1.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var c=o.exec(i);return!!c&&[s,c]},!1)}function vf(i){var e=$1(i);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new P1;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<gf&&(o=pf(pf([],o,!0),j1(gf-o.length),!0)):o=[];var c=o.join("."),l=U1(i),f=T1.exec(i);return f&&f[1]?new O1(t,c,l,f[1]):new I1(t,c,l)}function U1(i){for(var e=0,t=yf.length;e<t;e++){var s=yf[e],o=s[0],c=s[1],l=c.exec(i);if(l)return o}return null}function L1(){var i=typeof process<"u"&&process.version;return i?new x1(process.version.slice(1)):null}function j1(i){for(var e=[],t=0;t<i;t++)e.push("0");return e}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gu=function(i,e){return gu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},gu(i,e)};function M1(i,e){gu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var yu=function(){return yu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},yu.apply(this,arguments)};function q1(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function F1(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function z1(i,e){return function(t,s){e(t,s,i)}}function H1(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function B1(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(S){l(S)}}function y(v){try{p(s.throw(v))}catch(S){l(S)}}function p(v){v.done?c(v.value):o(v.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function K1(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return y([p,v])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function V1(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function k1(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function vu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function cp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function G1(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(cp(arguments[e]));return i}function W1(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ds(i){return this instanceof Ds?(this.v=i,this):new Ds(i)}function Y1(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(D){s[D]&&(o[D]=function(x){return new Promise(function(O,z){c.push([D,x,O,z])>1||f(D,x)})})}function f(D,x){try{y(s[D](x))}catch(O){S(c[0][3],O)}}function y(D){D.value instanceof Ds?Promise.resolve(D.value.v).then(p,v):S(c[0][2],D)}function p(D){f("next",D)}function v(D){f("throw",D)}function S(D,x){D(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function J1(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ds(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function Q1(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof vu=="function"?vu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function X1(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function Z1(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function eE(i){return i&&i.__esModule?i:{default:i}}function tE(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function rE(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const iE=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return yu},__asyncDelegator:J1,__asyncGenerator:Y1,__asyncValues:Q1,__await:Ds,__awaiter:B1,__classPrivateFieldGet:tE,__classPrivateFieldSet:rE,__createBinding:V1,__decorate:F1,__exportStar:k1,__extends:M1,__generator:K1,__importDefault:eE,__importStar:Z1,__makeTemplateObject:X1,__metadata:H1,__param:z1,__read:cp,__rest:q1,__spread:G1,__spreadArrays:W1,__values:vu},Symbol.toStringTag,{value:"Module"})),ha=Mn(iE);var Hc={},hs={},_f;function nE(){if(_f)return hs;_f=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return hs.delay=i,hs}var en={},Bc={},tn={},mf;function sE(){return mf||(mf=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.ONE_THOUSAND=tn.ONE_HUNDRED=void 0,tn.ONE_HUNDRED=100,tn.ONE_THOUSAND=1e3),tn}var Kc={},bf;function oE(){return bf||(bf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Kc)),Kc}var wf;function up(){return wf||(wf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(sE(),i),e.__exportStar(oE(),i)}(Bc)),Bc}var Ef;function aE(){if(Ef)return en;Ef=1,Object.defineProperty(en,"__esModule",{value:!0}),en.fromMiliseconds=en.toMiliseconds=void 0;const i=up();function e(s){return s*i.ONE_THOUSAND}en.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return en.fromMiliseconds=t,en}var Df;function cE(){return Df||(Df=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(nE(),i),e.__exportStar(aE(),i)}(Hc)),Hc}var Rn={},Sf;function uE(){if(Sf)return Rn;Sf=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Rn.Watch=i,Rn.default=i,Rn}var Vc={},ls={},If;function hE(){if(If)return ls;If=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.IWatch=void 0;class i{}return ls.IWatch=i,ls}var xf;function lE(){return xf||(xf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ha.__exportStar(hE(),i)}(Vc)),Vc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(cE(),i),e.__exportStar(uE(),i),e.__exportStar(lE(),i),e.__exportStar(up(),i)})(ve);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=hp=lt.getLocation=lt.getLocationOrThrow=Gu=lt.getNavigator=lt.getNavigatorOrThrow=ku=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function an(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}lt.getFromWindow=an;function Fn(i){const e=an(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}lt.getFromWindowOrThrow=Fn;function fE(){return Fn("document")}lt.getDocumentOrThrow=fE;function dE(){return an("document")}var ku=lt.getDocument=dE;function pE(){return Fn("navigator")}lt.getNavigatorOrThrow=pE;function gE(){return an("navigator")}var Gu=lt.getNavigator=gE;function yE(){return Fn("location")}lt.getLocationOrThrow=yE;function vE(){return an("location")}var hp=lt.getLocation=vE;function _E(){return Fn("crypto")}lt.getCryptoOrThrow=_E;function mE(){return an("crypto")}lt.getCrypto=mE;function bE(){return Fn("localStorage")}lt.getLocalStorageOrThrow=bE;function wE(){return an("localStorage")}lt.getLocalStorage=wE;var Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});var lp=Wu.getWindowMetadata=void 0;const Of=lt;function EE(){let i,e;try{i=Of.getDocumentOrThrow(),e=Of.getLocationOrThrow()}catch{return null}function t(){const S=i.getElementsByTagName("link"),D=[];for(let x=0;x<S.length;x++){const O=S[x],z=O.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const B=O.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let ne=e.protocol+"//"+e.host;if(B.indexOf("/")===0)ne+=B;else{const $=e.pathname.split("/");$.pop();const L=$.join("/");ne+=L+"/"+B}D.push(ne)}else if(B.indexOf("//")===0){const ne=e.protocol+B;D.push(ne)}else D.push(B)}}return D}function s(...S){const D=i.getElementsByTagName("meta");for(let x=0;x<D.length;x++){const O=D[x],z=["itemprop","property","name"].map(B=>O.getAttribute(B)).filter(B=>B?S.includes(B):!1);if(z.length&&z){const B=O.getAttribute("content");if(B)return B}}return""}function o(){let S=s("name","og:site_name","og:title","twitter:title");return S||(S=i.title),S}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),f=c(),y=e.origin,p=t();return{description:f,url:y,icons:p,name:l}}lp=Wu.getWindowMetadata=EE;var Ss={},DE=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),fp="%[a-f0-9]{2}",Pf=new RegExp("("+fp+")|([^%]+?)","gi"),Cf=new RegExp("("+fp+")+","gi");function _u(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],_u(t),_u(s))}function SE(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(Pf)||[],t=1;t<e.length;t++)i=_u(e,t).join(""),e=i.match(Pf)||[];return i}}function IE(i){for(var e={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"},t=Cf.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=SE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Cf.exec(i)}e["%C2"]="ï¿½";for(var o=Object.keys(e),c=0;c<o.length;c++){var l=o[c];i=i.replace(new RegExp(l,"g"),e[l])}return i}var xE=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return IE(i)}},OE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},PE=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var l=s[c],f=i[l];(o?e.indexOf(l)!==-1:e(l,f,i))&&(t[l]=f)}return t};(function(i){const e=DE,t=xE,s=OE,o=PE,c=$=>$==null,l=Symbol("encodeFragmentIdentifier");function f($){switch($.arrayFormat){case"index":return L=>(P,R)=>{const E=P.length;return R===void 0||$.skipNull&&R===null||$.skipEmptyString&&R===""?P:R===null?[...P,[v(L,$),"[",E,"]"].join("")]:[...P,[v(L,$),"[",v(E,$),"]=",v(R,$)].join("")]};case"bracket":return L=>(P,R)=>R===void 0||$.skipNull&&R===null||$.skipEmptyString&&R===""?P:R===null?[...P,[v(L,$),"[]"].join("")]:[...P,[v(L,$),"[]=",v(R,$)].join("")];case"colon-list-separator":return L=>(P,R)=>R===void 0||$.skipNull&&R===null||$.skipEmptyString&&R===""?P:R===null?[...P,[v(L,$),":list="].join("")]:[...P,[v(L,$),":list=",v(R,$)].join("")];case"comma":case"separator":case"bracket-separator":{const L=$.arrayFormat==="bracket-separator"?"[]=":"=";return P=>(R,E)=>E===void 0||$.skipNull&&E===null||$.skipEmptyString&&E===""?R:(E=E===null?"":E,R.length===0?[[v(P,$),L,v(E,$)].join("")]:[[R,v(E,$)].join($.arrayFormatSeparator)])}default:return L=>(P,R)=>R===void 0||$.skipNull&&R===null||$.skipEmptyString&&R===""?P:R===null?[...P,v(L,$)]:[...P,[v(L,$),"=",v(R,$)].join("")]}}function y($){let L;switch($.arrayFormat){case"index":return(P,R,E)=>{if(L=/\[(\d*)\]$/.exec(P),P=P.replace(/\[\d*\]$/,""),!L){E[P]=R;return}E[P]===void 0&&(E[P]={}),E[P][L[1]]=R};case"bracket":return(P,R,E)=>{if(L=/(\[\])$/.exec(P),P=P.replace(/\[\]$/,""),!L){E[P]=R;return}if(E[P]===void 0){E[P]=[R];return}E[P]=[].concat(E[P],R)};case"colon-list-separator":return(P,R,E)=>{if(L=/(:list)$/.exec(P),P=P.replace(/:list$/,""),!L){E[P]=R;return}if(E[P]===void 0){E[P]=[R];return}E[P]=[].concat(E[P],R)};case"comma":case"separator":return(P,R,E)=>{const u=typeof R=="string"&&R.includes($.arrayFormatSeparator),b=typeof R=="string"&&!u&&S(R,$).includes($.arrayFormatSeparator);R=b?S(R,$):R;const G=u||b?R.split($.arrayFormatSeparator).map(W=>S(W,$)):R===null?R:S(R,$);E[P]=G};case"bracket-separator":return(P,R,E)=>{const u=/(\[\])$/.test(P);if(P=P.replace(/\[\]$/,""),!u){E[P]=R&&S(R,$);return}const b=R===null?[]:R.split($.arrayFormatSeparator).map(G=>S(G,$));if(E[P]===void 0){E[P]=b;return}E[P]=[].concat(E[P],b)};default:return(P,R,E)=>{if(E[P]===void 0){E[P]=R;return}E[P]=[].concat(E[P],R)}}}function p($){if(typeof $!="string"||$.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function v($,L){return L.encode?L.strict?e($):encodeURIComponent($):$}function S($,L){return L.decode?t($):$}function D($){return Array.isArray($)?$.sort():typeof $=="object"?D(Object.keys($)).sort((L,P)=>Number(L)-Number(P)).map(L=>$[L]):$}function x($){const L=$.indexOf("#");return L!==-1&&($=$.slice(0,L)),$}function O($){let L="";const P=$.indexOf("#");return P!==-1&&(L=$.slice(P)),L}function z($){$=x($);const L=$.indexOf("?");return L===-1?"":$.slice(L+1)}function B($,L){return L.parseNumbers&&!Number.isNaN(Number($))&&typeof $=="string"&&$.trim()!==""?$=Number($):L.parseBooleans&&$!==null&&($.toLowerCase()==="true"||$.toLowerCase()==="false")&&($=$.toLowerCase()==="true"),$}function ne($,L){L=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},L),p(L.arrayFormatSeparator);const P=y(L),R=Object.create(null);if(typeof $!="string"||($=$.trim().replace(/^[?#&]/,""),!$))return R;for(const E of $.split("&")){if(E==="")continue;let[u,b]=s(L.decode?E.replace(/\+/g," "):E,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(L.arrayFormat)?b:S(b,L),P(S(u,L),b,R)}for(const E of Object.keys(R)){const u=R[E];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=B(u[b],L);else R[E]=B(u,L)}return L.sort===!1?R:(L.sort===!0?Object.keys(R).sort():Object.keys(R).sort(L.sort)).reduce((E,u)=>{const b=R[u];return b&&typeof b=="object"&&!Array.isArray(b)?E[u]=D(b):E[u]=b,E},Object.create(null))}i.extract=z,i.parse=ne,i.stringify=($,L)=>{if(!$)return"";L=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},L),p(L.arrayFormatSeparator);const P=b=>L.skipNull&&c($[b])||L.skipEmptyString&&$[b]==="",R=f(L),E={};for(const b of Object.keys($))P(b)||(E[b]=$[b]);const u=Object.keys(E);return L.sort!==!1&&u.sort(L.sort),u.map(b=>{const G=$[b];return G===void 0?"":G===null?v(b,L):Array.isArray(G)?G.length===0&&L.arrayFormat==="bracket-separator"?v(b,L)+"[]":G.reduce(R(b),[]).join("&"):v(b,L)+"="+v(G,L)}).filter(b=>b.length>0).join("&")},i.parseUrl=($,L)=>{L=Object.assign({decode:!0},L);const[P,R]=s($,"#");return Object.assign({url:P.split("?")[0]||"",query:ne(z($),L)},L&&L.parseFragmentIdentifier&&R?{fragmentIdentifier:S(R,L)}:{})},i.stringifyUrl=($,L)=>{L=Object.assign({encode:!0,strict:!0,[l]:!0},L);const P=x($.url).split("?")[0]||"",R=i.extract($.url),E=i.parse(R,{sort:!1}),u=Object.assign(E,$.query);let b=i.stringify(u,L);b&&(b=`?${b}`);let G=O($.url);return $.fragmentIdentifier&&(G=`#${L[l]?v($.fragmentIdentifier,L):$.fragmentIdentifier}`),`${P}${b}${G}`},i.pick=($,L,P)=>{P=Object.assign({parseFragmentIdentifier:!0,[l]:!1},P);const{url:R,query:E,fragmentIdentifier:u}=i.parseUrl($,P);return i.stringifyUrl({url:R,query:o(E,L),fragmentIdentifier:u},P)},i.exclude=($,L,P)=>{const R=Array.isArray(L)?E=>!L.includes(E):(E,u)=>!L(E,u);return i.pick($,R,P)}})(Ss);const CE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},AE=":";function TE(i){const[e,t]=i.split(AE);return{namespace:e,reference:t}}function RE(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function dp(i,e){return i.includes(":")?[i]:e.chains||[]}const pp="base10",ur="base16",mu="base64pad",Yu="utf8",gp=0,cn=1,NE=0,Af=1,bu=12,Ju=32;function $E(){const i=Ku.generateKeyPair();return{privateKey:hr(i.secretKey,ur),publicKey:hr(i.publicKey,ur)}}function wu(){const i=qn.randomBytes(Ju);return hr(i,ur)}function UE(i,e){const t=Ku.sharedKey(br(i,ur),br(e,ur),!0),s=new ww(ca.SHA256,t).expand(Ju);return hr(s,ur)}function LE(i){const e=ca.hash(br(i,ur));return hr(e,ur)}function Un(i){const e=ca.hash(br(i,Yu));return hr(e,ur)}function jE(i){return br(`${i}`,pp)}function Ts(i){return Number(hr(i,pp))}function ME(i){const e=jE(typeof i.type<"u"?i.type:gp);if(Ts(e)===cn&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?br(i.senderPublicKey,ur):void 0,s=typeof i.iv<"u"?br(i.iv,ur):qn.randomBytes(bu),o=new Hu.ChaCha20Poly1305(br(i.symKey,ur)).seal(s,br(i.message,Yu));return FE({type:e,sealed:o,iv:s,senderPublicKey:t})}function qE(i){const e=new Hu.ChaCha20Poly1305(br(i.symKey,ur)),{sealed:t,iv:s}=Zo(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return hr(o,Yu)}function FE(i){if(Ts(i.type)===cn){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return hr(pu([i.type,i.senderPublicKey,i.iv,i.sealed]),mu)}return hr(pu([i.type,i.iv,i.sealed]),mu)}function Zo(i){const e=br(i,mu),t=e.slice(NE,Af),s=Af;if(Ts(t)===cn){const f=s+Ju,y=f+bu,p=e.slice(s,f),v=e.slice(f,y),S=e.slice(y);return{type:t,sealed:S,iv:v,senderPublicKey:p}}const o=s+bu,c=e.slice(s,o),l=e.slice(o);return{type:t,sealed:l,iv:c}}function zE(i,e){const t=Zo(i);return yp({type:Ts(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?hr(t.senderPublicKey,ur):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function yp(i){const e=(i==null?void 0:i.type)||gp;if(e===cn){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Tf(i){return i.type===cn&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var HE=Object.defineProperty,Rf=Object.getOwnPropertySymbols,BE=Object.prototype.hasOwnProperty,KE=Object.prototype.propertyIsEnumerable,Nf=(i,e,t)=>e in i?HE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,$f=(i,e)=>{for(var t in e||(e={}))BE.call(e,t)&&Nf(i,t,e[t]);if(Rf)for(var t of Rf(e))KE.call(e,t)&&Nf(i,t,e[t]);return i};const VE="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},kE="js";function Qu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function zn(){return!ku()&&!!Gu()&&navigator.product===VE}function Hn(){return!Qu()&&!!Gu()&&!!ku()}function Rs(){return zn()?Or.reactNative:Qu()?Or.node:Hn()?Or.browser:Or.unknown}function GE(){var i;try{return zn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(i=global.Application)==null?void 0:i.applicationId:void 0}catch{return}}function WE(i,e){let t=Ss.parse(i);return t=$f($f({},t),e),i=Ss.stringify(t),i}function YE(){return lp()||{name:"",description:"",url:"",icons:[""]}}function JE(){if(Rs()===Or.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const i=N1();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function QE(){var i;const e=Rs();return e===Or.browser?[e,((i=hp())==null?void 0:i.host)||"unknown"].join(":"):e}function XE(i,e,t){const s=JE(),o=QE();return[[i,e].join("-"),[kE,t].join("-"),s,o].join("/")}function ZE({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:l,bundleId:f}){const y=t.split("?"),p=XE(i,e,s),v={auth:o,ua:p,projectId:c,useOnCloseEvent:l||void 0,origin:f||void 0},S=WE(y[1]||"",v);return y[0]+"?"+S}function sn(i,e){return i.filter(t=>e.includes(t)).length===i.length}function vp(i){return Object.fromEntries(i.entries())}function _p(i){return new Map(Object.entries(i))}function Nn(i=ve.FIVE_MINUTES,e){const t=ve.toMiliseconds(i||ve.FIVE_MINUTES);let s,o,c;return{resolve:l=>{c&&s&&(clearTimeout(c),s(l))},reject:l=>{c&&o&&(clearTimeout(c),o(l))},done:()=>new Promise((l,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=l,o=f})}}function Is(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const l=await i;s(l)}catch(l){o(l)}clearTimeout(c)})}function mp(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function e3(i){return mp("topic",i)}function t3(i){return mp("id",i)}function bp(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Gr(i,e){return ve.fromMiliseconds((e||Date.now())+ve.toMiliseconds(i))}function Ui(i){return Date.now()>=ve.toMiliseconds(i)}function zt(i,e){return`${i}${e?`:${e}`:""}`}function kc(i=[],e=[]){return[...new Set([...i,...e])]}async function r3({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,l=Rs();l===Or.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):l===Or.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}async function i3(i,e){try{return await i.getItem(e)||(Hn()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}const n3="irn";function Eu(i){return(i==null?void 0:i.relay)||{protocol:n3}}function Go(i){const e=CE[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var s3=Object.defineProperty,Uf=Object.getOwnPropertySymbols,o3=Object.prototype.hasOwnProperty,a3=Object.prototype.propertyIsEnumerable,Lf=(i,e,t)=>e in i?s3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,c3=(i,e)=>{for(var t in e||(e={}))o3.call(e,t)&&Lf(i,t,e[t]);if(Uf)for(var t of Uf(e))a3.call(e,t)&&Lf(i,t,e[t]);return i};function u3(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),l=i[o];t[c]=l}}),t}function jf(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",l=Ss.parse(c);return{protocol:s,topic:h3(o[0]),version:parseInt(o[1],10),symKey:l.symKey,relay:u3(l)}}function h3(i){return i.startsWith("//")?i.substring(2):i}function l3(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function f3(i){return`${i.protocol}:${i.topic}@${i.version}?`+Ss.stringify(c3({symKey:i.symKey},l3(i.relay)))}function Bn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function d3(i){const e=[];return Object.values(i).forEach(t=>{e.push(...Bn(t.accounts))}),e}function p3(i,e){const t=[];return Object.values(i).forEach(s=>{Bn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function g3(i,e){const t=[];return Object.values(i).forEach(s=>{Bn(s.accounts).includes(e)&&t.push(...s.events)}),t}function y3(i,e){const t=Wo(i,e);if(t)throw new Error(t.message);const s={};for(const[o,c]of Object.entries(i))s[o]={methods:c.methods,events:c.events,chains:c.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return s}function Xu(i){return i.includes(":")}function ms(i){return Xu(i)?i.split(":")[0]:i}const v3={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},_3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(i,e){const{message:t,code:s}=_3[i];return{message:e?`${t} ${e}`:t,code:s}}function Ct(i,e){const{message:t,code:s}=v3[i];return{message:e?`${t} ${e}`:t,code:s}}function ni(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Ln(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function cr(i){return typeof i>"u"}function Gt(i,e){return e&&cr(i)?!0:typeof i=="string"&&!!i.trim().length}function Zu(i,e){return e&&cr(i)?!0:typeof i=="number"&&!isNaN(i)}function m3(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return sn(o,s)?(s.forEach(l=>{const{accounts:f,methods:y,events:p}=i.namespaces[l],v=Bn(f),S=t[l];(!sn(dp(l,S),v)||!sn(S.methods,y)||!sn(S.events,p))&&(c=!1)}),c):!1}function ea(i){return Gt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function b3(i){if(Gt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&ea(t)}}return!1}function w3(i){if(Gt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function E3(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function D3(i){return i==null?void 0:i.topic}function S3(i,e){let t=null;return Gt(i==null?void 0:i.publicKey,!1)||(t=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Mf(i){let e=!0;return ni(i)?i.length&&(e=i.every(t=>Gt(t,!1))):e=!1,e}function I3(i,e,t){let s=null;return ni(e)&&e.length?e.forEach(o=>{s||ea(o)||(s=Ct("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):ea(i)||(s=Ct("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function x3(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const l=I3(o,dp(o,c),`${e} ${t}`);l&&(s=l)}),s}function O3(i,e){let t=null;return ni(i)?i.forEach(s=>{t||b3(s)||(t=Ct("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=Ct("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function P3(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=O3(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function C3(i,e){let t=null;return Mf(i==null?void 0:i.methods)?Mf(i==null?void 0:i.events)||(t=Ct("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ct("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function wp(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=C3(s,`${e}, namespace`);o&&(t=o)}),t}function A3(i,e,t){let s=null;if(i&&Ln(i)){const o=wp(i,e);o&&(s=o);const c=x3(i,e,t);c&&(s=c)}else s=ue("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Wo(i,e){let t=null;if(i&&Ln(i)){const s=wp(i,e);s&&(t=s);const o=P3(i,e);o&&(t=o)}else t=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Ep(i){return Gt(i.protocol,!0)}function T3(i,e){let t=!1;return e&&!i?t=!0:i&&ni(i)&&i.length&&i.forEach(s=>{t=Ep(s)}),t}function R3(i){return typeof i=="number"}function mr(i){return typeof i<"u"&&typeof i!==null}function N3(i){return!(!i||typeof i!="object"||!i.code||!Zu(i.code,!1)||!i.message||!Gt(i.message,!1))}function $3(i){return!(cr(i)||!Gt(i.method,!1))}function U3(i){return!(cr(i)||cr(i.result)&&cr(i.error)||!Zu(i.id,!1)||!Gt(i.jsonrpc,!1))}function L3(i){return!(cr(i)||!Gt(i.name,!1))}function qf(i,e){return!(!ea(e)||!d3(i).includes(e))}function j3(i,e,t){return Gt(t,!1)?p3(i,e).includes(t):!1}function M3(i,e,t){return Gt(t,!1)?g3(i,e).includes(t):!1}function Ff(i,e,t){let s=null;const o=q3(i),c=F3(e),l=Object.keys(o),f=Object.keys(c),y=zf(Object.keys(i)),p=zf(Object.keys(e)),v=y.filter(S=>!p.includes(S));return v.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${v.toString()}
      Received: ${Object.keys(e).toString()}`)),sn(l,f)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(S=>{if(!S.includes(":")||s)return;const D=Bn(e[S].accounts);D.includes(S)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${S}
        Required: ${S}
        Approved: ${D.toString()}`))}),l.forEach(S=>{s||(sn(o[S].methods,c[S].methods)?sn(o[S].events,c[S].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${S}`)):s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${S}`))}),s}function q3(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function zf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function F3(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=Bn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function z3(i,e){return Zu(i,!1)&&i<=e.max&&i>=e.min}function Hf(){const i=Rs();return new Promise(e=>{switch(i){case Or.browser:e(H3());break;case Or.reactNative:e(B3());break;case Or.node:e(K3());break;default:e(!0)}})}function H3(){return Hn()&&(navigator==null?void 0:navigator.onLine)}async function B3(){if(zn()&&typeof global<"u"&&global!=null&&global.NetInfo){const i=await(global==null?void 0:global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function K3(){return!0}function V3(i){switch(Rs()){case Or.browser:k3(i);break;case Or.reactNative:G3(i);break}}function k3(i){!zn()&&Hn()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function G3(i){zn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>i(e==null?void 0:e.isConnected)))}const Gc={};let zo=class{static get(e){return Gc[e]}static set(e,t){Gc[e]=t}static delete(e){delete Gc[e]}};const W3=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Y3=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,J3=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Q3(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){X3(i);return}return e}function X3(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function Ho(i,e={}){if(typeof i!="string")return i;const t=i.trim();if(i[0]==='"'&&i.at(-1)==='"'&&!i.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!J3.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(W3.test(i)||Y3.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,Q3)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function Z3(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function kt(i,...e){try{return Z3(i(...e))}catch(t){return Promise.reject(t)}}function eD(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function tD(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Yo(i){if(eD(i))return String(i);if(tD(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Yo(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Dp(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Du="base64:";function rD(i){if(typeof i=="string")return i;Dp();const e=Buffer.from(i).toString("base64");return Du+e}function iD(i){return typeof i!="string"||!i.startsWith(Du)?i:(Dp(),Buffer.from(i.slice(Du.length),"base64"))}function _r(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function nD(...i){return _r(i.join(":"))}function Bo(i){return i=_r(i),i?i+":":""}const sD="memory",oD=()=>{const i=new Map;return{name:sD,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,t){i.set(e,t)},setItemRaw(e,t){i.set(e,t)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function aD(i={}){const e={mounts:{"":i.driver||oD()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=p=>{for(const v of e.mountpoints)if(p.startsWith(v))return{base:v,relativeKey:p.slice(v.length),driver:e.mounts[v]};return{base:"",relativeKey:p,driver:e.mounts[""]}},s=(p,v)=>e.mountpoints.filter(S=>S.startsWith(p)||v&&p.startsWith(S)).map(S=>({relativeBase:p.length>S.length?p.slice(S.length):void 0,mountpoint:S,driver:e.mounts[S]})),o=(p,v)=>{if(e.watching){v=_r(v);for(const S of e.watchListeners)S(p,v)}},c=async()=>{if(!e.watching){e.watching=!0;for(const p in e.mounts)e.unwatch[p]=await Bf(e.mounts[p],o,p)}},l=async()=>{if(e.watching){for(const p in e.unwatch)await e.unwatch[p]();e.unwatch={},e.watching=!1}},f=(p,v,S)=>{const D=new Map,x=O=>{let z=D.get(O.base);return z||(z={driver:O.driver,base:O.base,items:[]},D.set(O.base,z)),z};for(const O of p){const z=typeof O=="string",B=_r(z?O:O.key),ne=z?void 0:O.value,$=z||!O.options?v:{...v,...O.options},L=t(B);x(L).items.push({key:B,value:ne,relativeKey:L.relativeKey,options:$})}return Promise.all([...D.values()].map(O=>S(O))).then(O=>O.flat())},y={hasItem(p,v={}){p=_r(p);const{relativeKey:S,driver:D}=t(p);return kt(D.hasItem,S,v)},getItem(p,v={}){p=_r(p);const{relativeKey:S,driver:D}=t(p);return kt(D.getItem,S,v).then(x=>Ho(x))},getItems(p,v){return f(p,v,S=>S.driver.getItems?kt(S.driver.getItems,S.items.map(D=>({key:D.relativeKey,options:D.options})),v).then(D=>D.map(x=>({key:nD(S.base,x.key),value:Ho(x.value)}))):Promise.all(S.items.map(D=>kt(S.driver.getItem,D.relativeKey,D.options).then(x=>({key:D.key,value:Ho(x)})))))},getItemRaw(p,v={}){p=_r(p);const{relativeKey:S,driver:D}=t(p);return D.getItemRaw?kt(D.getItemRaw,S,v):kt(D.getItem,S,v).then(x=>iD(x))},async setItem(p,v,S={}){if(v===void 0)return y.removeItem(p);p=_r(p);const{relativeKey:D,driver:x}=t(p);x.setItem&&(await kt(x.setItem,D,Yo(v),S),x.watch||o("update",p))},async setItems(p,v){await f(p,v,async S=>{S.driver.setItems&&await kt(S.driver.setItems,S.items.map(D=>({key:D.relativeKey,value:Yo(D.value),options:D.options})),v),S.driver.setItem&&await Promise.all(S.items.map(D=>kt(S.driver.setItem,D.relativeKey,Yo(D.value),D.options)))})},async setItemRaw(p,v,S={}){if(v===void 0)return y.removeItem(p,S);p=_r(p);const{relativeKey:D,driver:x}=t(p);if(x.setItemRaw)await kt(x.setItemRaw,D,v,S);else if(x.setItem)await kt(x.setItem,D,rD(v),S);else return;x.watch||o("update",p)},async removeItem(p,v={}){typeof v=="boolean"&&(v={removeMeta:v}),p=_r(p);const{relativeKey:S,driver:D}=t(p);D.removeItem&&(await kt(D.removeItem,S,v),(v.removeMeta||v.removeMata)&&await kt(D.removeItem,S+"$",v),D.watch||o("remove",p))},async getMeta(p,v={}){typeof v=="boolean"&&(v={nativeOnly:v}),p=_r(p);const{relativeKey:S,driver:D}=t(p),x=Object.create(null);if(D.getMeta&&Object.assign(x,await kt(D.getMeta,S,v)),!v.nativeOnly){const O=await kt(D.getItem,S+"$",v).then(z=>Ho(z));O&&typeof O=="object"&&(typeof O.atime=="string"&&(O.atime=new Date(O.atime)),typeof O.mtime=="string"&&(O.mtime=new Date(O.mtime)),Object.assign(x,O))}return x},setMeta(p,v,S={}){return this.setItem(p+"$",v,S)},removeMeta(p,v={}){return this.removeItem(p+"$",v)},async getKeys(p,v={}){p=Bo(p);const S=s(p,!0);let D=[];const x=[];for(const O of S){const B=(await kt(O.driver.getKeys,O.relativeBase,v)).map(ne=>O.mountpoint+_r(ne)).filter(ne=>!D.some($=>ne.startsWith($)));x.push(...B),D=[O.mountpoint,...D.filter(ne=>!ne.startsWith(O.mountpoint))]}return p?x.filter(O=>O.startsWith(p)&&!O.endsWith("$")):x.filter(O=>!O.endsWith("$"))},async clear(p,v={}){p=Bo(p),await Promise.all(s(p,!1).map(async S=>{if(S.driver.clear)return kt(S.driver.clear,S.relativeBase,v);if(S.driver.removeItem){const D=await S.driver.getKeys(S.relativeBase||"",v);return Promise.all(D.map(x=>S.driver.removeItem(x,v)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(p=>Kf(p)))},async watch(p){return await c(),e.watchListeners.push(p),async()=>{e.watchListeners=e.watchListeners.filter(v=>v!==p),e.watchListeners.length===0&&await l()}},async unwatch(){e.watchListeners=[],await l()},mount(p,v){if(p=Bo(p),p&&e.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(e.mountpoints.push(p),e.mountpoints.sort((S,D)=>D.length-S.length)),e.mounts[p]=v,e.watching&&Promise.resolve(Bf(v,o,p)).then(S=>{e.unwatch[p]=S}).catch(console.error),y},async unmount(p,v=!0){p=Bo(p),!(!p||!e.mounts[p])&&(e.watching&&p in e.unwatch&&(e.unwatch[p](),delete e.unwatch[p]),v&&await Kf(e.mounts[p]),e.mountpoints=e.mountpoints.filter(S=>S!==p),delete e.mounts[p])},getMount(p=""){p=_r(p)+":";const v=t(p);return{driver:v.driver,base:v.base}},getMounts(p="",v={}){return p=_r(p),s(p,v.parents).map(D=>({driver:D.driver,base:D.mountpoint}))}};return y}function Bf(i,e,t){return i.watch?i.watch((s,o)=>e(s,t+o)):()=>{}}async function Kf(i){typeof i.dispose=="function"&&await kt(i.dispose)}function un(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function Sp(i,e){const t=indexedDB.open(i);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=un(t);return(o,c)=>s.then(l=>c(l.transaction(e,o).objectStore(e)))}let Wc;function Ns(){return Wc||(Wc=Sp("keyval-store","keyval")),Wc}function Vf(i,e=Ns()){return e("readonly",t=>un(t.get(i)))}function cD(i,e,t=Ns()){return t("readwrite",s=>(s.put(e,i),un(s.transaction)))}function uD(i,e=Ns()){return e("readwrite",t=>(t.delete(i),un(t.transaction)))}function hD(i=Ns()){return i("readwrite",e=>(e.clear(),un(e.transaction)))}function lD(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},un(i.transaction)}function fD(i=Ns()){return i("readonly",e=>{if(e.getAllKeys)return un(e.getAllKeys());const t=[];return lD(e,s=>t.push(s.key)).then(()=>t)})}const dD=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),pD=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function $s(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return pD(i)}catch{return i}}function on(i){return typeof i=="string"?i:dD(i)||""}const gD="idb-keyval";var yD=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",t=o=>e+o;let s;return i.dbName&&i.storeName&&(s=Sp(i.dbName,i.storeName)),{name:gD,options:i,async hasItem(o){return!(typeof await Vf(t(o),s)>"u")},async getItem(o){return await Vf(t(o),s)??null},setItem(o,c){return cD(t(o),c,s)},removeItem(o){return uD(t(o),s)},getKeys(){return fD(s)},clear(){return hD(s)}}};const vD="WALLET_CONNECT_V2_INDEXED_DB",_D="keyvaluestorage";let mD=class{constructor(){this.indexedDb=aD({driver:yD({dbName:vD,storeName:_D})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,on(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Yc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jo={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Yc<"u"&&Yc.localStorage?Jo.exports=Yc.localStorage:typeof window<"u"&&window.localStorage?Jo.exports=window.localStorage:Jo.exports=new e})();function bD(i){var e;return[i[0],$s((e=i[1])!=null?e:"")]}class wD{constructor(){this.localStorage=Jo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(bD)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return $s(t)}async setItem(e,t){this.localStorage.setItem(e,on(t))}async removeItem(e){this.localStorage.removeItem(e)}}const ED="wc_storage_version",kf=1,DD=async(i,e,t)=>{const s=ED,o=await e.getItem(s);if(o&&o>=kf){t(e);return}const c=await i.getKeys();if(!c.length){t(e);return}const l=[];for(;c.length;){const f=c.shift();if(!f)continue;const y=f.toLowerCase();if(y.includes("wc@")||y.includes("walletconnect")||y.includes("wc_")||y.includes("wallet_connect")){const p=await i.getItem(f);await e.setItem(f,p),l.push(f)}}await e.setItem(s,kf),t(e),SD(i,l)},SD=async(i,e)=>{e.length&&e.forEach(async t=>{await i.removeItem(t)})};let ID=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new wD;this.storage=e;try{const t=new mD;DD(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Kn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Su=function(i,e){return Su=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Su(i,e)};function xD(i,e){Su(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Iu=function(){return Iu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Iu.apply(this,arguments)};function OD(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function PD(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function CD(i,e){return function(t,s){e(t,s,i)}}function AD(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function TD(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(S){l(S)}}function y(v){try{p(s.throw(v))}catch(S){l(S)}}function p(v){v.done?c(v.value):o(v.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function RD(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return y([p,v])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function ND(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function $D(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function xu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ip(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function UD(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Ip(arguments[e]));return i}function LD(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function xs(i){return this instanceof xs?(this.v=i,this):new xs(i)}function jD(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(D){s[D]&&(o[D]=function(x){return new Promise(function(O,z){c.push([D,x,O,z])>1||f(D,x)})})}function f(D,x){try{y(s[D](x))}catch(O){S(c[0][3],O)}}function y(D){D.value instanceof xs?Promise.resolve(D.value.v).then(p,v):S(c[0][2],D)}function p(D){f("next",D)}function v(D){f("throw",D)}function S(D,x){D(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function MD(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:xs(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function qD(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof xu=="function"?xu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function FD(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function zD(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function HD(i){return i&&i.__esModule?i:{default:i}}function BD(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function KD(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const VD=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Iu},__asyncDelegator:MD,__asyncGenerator:jD,__asyncValues:qD,__await:xs,__awaiter:TD,__classPrivateFieldGet:BD,__classPrivateFieldSet:KD,__createBinding:ND,__decorate:PD,__exportStar:$D,__extends:xD,__generator:RD,__importDefault:HD,__importStar:zD,__makeTemplateObject:FD,__metadata:AD,__param:CD,__read:Ip,__rest:OD,__spread:UD,__spreadArrays:LD,__values:xu},Symbol.toStringTag,{value:"Module"})),la=Mn(VD);var fs={},Jc={},ds={};let hn=class{};const kD=Object.freeze(Object.defineProperty({__proto__:null,IEvents:hn},Symbol.toStringTag,{value:"Module"})),GD=Mn(kD);var Gf;function WD(){if(Gf)return ds;Gf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.IHeartBeat=void 0;const i=GD;class e extends i.IEvents{constructor(s){super()}}return ds.IHeartBeat=e,ds}var Wf;function xp(){return Wf||(Wf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),la.__exportStar(WD(),i)}(Jc)),Jc}var Qc={},rn={},Yf;function YD(){if(Yf)return rn;Yf=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.HEARTBEAT_EVENTS=rn.HEARTBEAT_INTERVAL=void 0;const i=ve;return rn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,rn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},rn}var Jf;function Op(){return Jf||(Jf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),la.__exportStar(YD(),i)}(Qc)),Qc}var Qf;function JD(){if(Qf)return fs;Qf=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.HeartBeat=void 0;const i=la,e=qr,t=ve,s=xp(),o=Op();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const y=new c(f);return yield y.init(),y})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,y){this.events.on(f,y)}once(f,y){this.events.once(f,y)}off(f,y){this.events.off(f,y)}removeListener(f,y){this.events.removeListener(f,y)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return fs.HeartBeat=c,fs}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=la;e.__exportStar(JD(),i),e.__exportStar(xp(),i),e.__exportStar(Op(),i)})(Kn);var Je={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ou=function(i,e){return Ou=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Ou(i,e)};function QD(i,e){Ou(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Pu=function(){return Pu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Pu.apply(this,arguments)};function XD(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function ZD(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function eS(i,e){return function(t,s){e(t,s,i)}}function tS(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function rS(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(S){l(S)}}function y(v){try{p(s.throw(v))}catch(S){l(S)}}function p(v){v.done?c(v.value):o(v.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function iS(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return y([p,v])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function nS(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function sS(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Cu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function oS(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Pp(arguments[e]));return i}function aS(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Os(i){return this instanceof Os?(this.v=i,this):new Os(i)}function cS(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(D){s[D]&&(o[D]=function(x){return new Promise(function(O,z){c.push([D,x,O,z])>1||f(D,x)})})}function f(D,x){try{y(s[D](x))}catch(O){S(c[0][3],O)}}function y(D){D.value instanceof Os?Promise.resolve(D.value.v).then(p,v):S(c[0][2],D)}function p(D){f("next",D)}function v(D){f("throw",D)}function S(D,x){D(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function uS(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Os(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function hS(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Cu=="function"?Cu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function lS(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function fS(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function dS(i){return i&&i.__esModule?i:{default:i}}function pS(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function gS(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const yS=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Pu},__asyncDelegator:uS,__asyncGenerator:cS,__asyncValues:hS,__await:Os,__awaiter:rS,__classPrivateFieldGet:pS,__classPrivateFieldSet:gS,__createBinding:nS,__decorate:ZD,__exportStar:sS,__extends:QD,__generator:iS,__importDefault:dS,__importStar:fS,__makeTemplateObject:lS,__metadata:tS,__param:eS,__read:Pp,__rest:XD,__spread:oS,__spreadArrays:aS,__values:Cu},Symbol.toStringTag,{value:"Module"})),vS=Mn(yS);var Xc,Xf;function _S(){if(Xf)return Xc;Xf=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Xc=e;function e(t,s,o){var c=o&&o.stringify||i,l=1;if(typeof t=="object"&&t!==null){var f=s.length+l;if(f===1)return t;var y=new Array(f);y[0]=c(t);for(var p=1;p<f;p++)y[p]=c(s[p]);return y.join(" ")}if(typeof t!="string")return t;var v=s.length;if(v===0)return t;for(var S="",D=1-l,x=-1,O=t&&t.length||0,z=0;z<O;){if(t.charCodeAt(z)===37&&z+1<O){switch(x=x>-1?x:0,t.charCodeAt(z+1)){case 100:case 102:if(D>=v||s[D]==null)break;x<z&&(S+=t.slice(x,z)),S+=Number(s[D]),x=z+2,z++;break;case 105:if(D>=v||s[D]==null)break;x<z&&(S+=t.slice(x,z)),S+=Math.floor(Number(s[D])),x=z+2,z++;break;case 79:case 111:case 106:if(D>=v||s[D]===void 0)break;x<z&&(S+=t.slice(x,z));var B=typeof s[D];if(B==="string"){S+="'"+s[D]+"'",x=z+2,z++;break}if(B==="function"){S+=s[D].name||"<anonymous>",x=z+2,z++;break}S+=c(s[D]),x=z+2,z++;break;case 115:if(D>=v)break;x<z&&(S+=t.slice(x,z)),S+=String(s[D]),x=z+2,z++;break;case 37:x<z&&(S+=t.slice(x,z)),S+="%",x=z+2,z++,D--;break}++D}++z}return x===-1?t:(x<O&&(S+=t.slice(x)),S)}return Xc}var Zc,Zf;function mS(){if(Zf)return Zc;Zf=1;const i=_S();Zc=o;const e=R().console||{},t={mapHttpRequest:O,mapHttpResponse:O,wrapRequestSerializer:z,wrapResponseSerializer:z,wrapErrorSerializer:z,req:O,res:O,err:D};function s(E,u){return Array.isArray(E)?E.filter(function(G){return G!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function o(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const b=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const G=E.serializers||{},W=s(E.browser.serialize,G);let se=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),E.enabled===!1&&(E.level="silent");const de=E.level||"info",w=Object.create(b);w.log||(w.log=B),Object.defineProperty(w,"levelVal",{get:ee}),Object.defineProperty(w,"level",{get:Q,set:V});const A={transmit:u,serialize:W,asObject:E.browser.asObject,levels:ce,timestamp:x(E)};w.levels=o.levels,w.level=de,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=B,w.serializers=G,w._serialize=W,w._stdErrSerialize=se,w.child=k,u&&(w._logEvent=S());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Q(){return this._level}function V(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,c(A,w,"error","log"),c(A,w,"fatal","error"),c(A,w,"warn","error"),c(A,w,"info","log"),c(A,w,"debug","log"),c(A,w,"trace","log")}function k(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},W&&J.serializers&&(re.serializers=J.serializers);const be=re.serializers;if(W&&be){var oe=Object.assign({},G,be),we=E.browser.serialize===!0?Object.keys(oe):W;delete J.serializers,y([J],we,oe,this._stdErrSerialize)}function le(_e){this._childLevel=(_e._childLevel|0)+1,this.error=p(_e,J,"error"),this.fatal=p(_e,J,"fatal"),this.warn=p(_e,J,"warn"),this.info=p(_e,J,"info"),this.debug=p(_e,J,"debug"),this.trace=p(_e,J,"trace"),oe&&(this.serializers=oe,this._serialize=we),u&&(this._logEvent=S([].concat(_e._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return w}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:ne,epochTime:$,unixTime:L,isoTime:P});function c(E,u,b,G){const W=Object.getPrototypeOf(u);u[b]=u.levelVal>u.levels.values[b]?B:W[b]?W[b]:e[b]||e[G]||B,l(E,u,b)}function l(E,u,b){!E.transmit&&u[b]===B||(u[b]=function(G){return function(){const se=E.timestamp(),ce=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var w=0;w<ce.length;w++)ce[w]=arguments[w];if(E.serialize&&!E.asObject&&y(ce,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?G.call(de,f(this,b,ce,se)):G.apply(de,ce),E.transmit){const A=E.transmit.level||u.level,ee=o.levels.values[A],Q=o.levels.values[b];if(Q<ee)return;v(this,{ts:se,methodLevel:b,methodValue:Q,transmitLevel:A,transmitValue:o.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ce)}}}(u[b]))}function f(E,u,b,G){E._serialize&&y(b,E._serialize,E.serializers,E._stdErrSerialize);const W=b.slice();let se=W[0];const ce={};G&&(ce.time=G),ce.level=o.levels.values[u];let de=(E._childLevel|0)+1;if(de<1&&(de=1),se!==null&&typeof se=="object"){for(;de--&&typeof W[0]=="object";)Object.assign(ce,W.shift());se=W.length?i(W.shift(),W):void 0}else typeof se=="string"&&(se=i(W.shift(),W));return se!==void 0&&(ce.msg=se),ce}function y(E,u,b,G){for(const W in E)if(G&&E[W]instanceof Error)E[W]=o.stdSerializers.err(E[W]);else if(typeof E[W]=="object"&&!Array.isArray(E[W]))for(const se in E[W])u&&u.indexOf(se)>-1&&se in b&&(E[W][se]=b[se](E[W][se]))}function p(E,u,b){return function(){const G=new Array(1+arguments.length);G[0]=u;for(var W=1;W<G.length;W++)G[W]=arguments[W-1];return E[b].apply(this,G)}}function v(E,u,b){const G=u.send,W=u.ts,se=u.methodLevel,ce=u.methodValue,de=u.val,w=E._logEvent.bindings;y(b,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=W,E._logEvent.messages=b.filter(function(A){return w.indexOf(A)===-1}),E._logEvent.level.label=se,E._logEvent.level.value=ce,G(se,E._logEvent,de),E._logEvent=S(w)}function S(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function D(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const b in E)u[b]===void 0&&(u[b]=E[b]);return u}function x(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?ne:$}function O(){return{}}function z(E){return E}function B(){}function ne(){return!1}function $(){return Date.now()}function L(){return Math.round(Date.now()/1e3)}function P(){return new Date(Date.now()).toISOString()}function R(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return Zc}var nn={},ed;function Cp(){return ed||(ed=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.PINO_CUSTOM_CONTEXT_KEY=nn.PINO_LOGGER_DEFAULTS=void 0,nn.PINO_LOGGER_DEFAULTS={level:"info"},nn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),nn}var ar={},td;function bS(){if(td)return ar;td=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const i=Cp();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||i.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=e;function t(f,y=i.PINO_CUSTOM_CONTEXT_KEY){return f[y]||""}ar.getBrowserLoggerContext=t;function s(f,y,p=i.PINO_CUSTOM_CONTEXT_KEY){return f[p]=y,f}ar.setBrowserLoggerContext=s;function o(f,y=i.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof f.bindings>"u"?p=t(f,y):p=f.bindings().context||"",p}ar.getLoggerContext=o;function c(f,y,p=i.PINO_CUSTOM_CONTEXT_KEY){const v=o(f,p);return v.trim()?`${v}/${y}`:y}ar.formatChildLoggerContext=c;function l(f,y,p=i.PINO_CUSTOM_CONTEXT_KEY){const v=c(f,y,p),S=f.child({context:v});return s(S,v,p)}return ar.generateChildLogger=l,ar}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=vS,t=e.__importDefault(mS());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(Cp(),i),e.__exportStar(bS(),i)})(Je);class wS extends hn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let ES=class extends hn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},DS=class{constructor(e,t){this.logger=e,this.core=t}},SS=class extends hn{constructor(e,t){super(),this.relayer=e,this.logger=t}},IS=class extends hn{constructor(e){super()}},xS=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class OS extends hn{constructor(e,t){super(),this.relayer=e,this.logger=t}}let PS=class extends hn{constructor(e,t){super(),this.core=e,this.logger=t}},CS=class{constructor(e,t){this.projectId=e,this.logger=t}},AS=class{constructor(e,t){this.projectId=e,this.logger=t}},TS=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},RS=class{constructor(e){this.client=e}};var eh={},Ap={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Pr;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(y,p){if(p===void 0&&(p=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=y[v++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=y[v++],p--;return this},f.prototype.finish=function(y){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,S=p/536870912|0,D=p<<3,x=p%128<112?128:256;this._buffer[v]=128;for(var O=v+1;O<x-8;O++)this._buffer[O]=0;e.writeUint32BE(S,this._buffer,x-8),e.writeUint32BE(D,this._buffer,x-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,x),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)e.writeUint32BE(this._stateHi[O],y,O*8),e.writeUint32BE(this._stateLo[O],y,O*8+4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.stateHi),t.wipe(y.stateLo),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,y,p,v,S,D,x){for(var O=p[0],z=p[1],B=p[2],ne=p[3],$=p[4],L=p[5],P=p[6],R=p[7],E=v[0],u=v[1],b=v[2],G=v[3],W=v[4],se=v[5],ce=v[6],de=v[7],w,A,ee,Q,V,k,J,re;x>=128;){for(var be=0;be<16;be++){var oe=8*be+D;f[be]=e.readUint32BE(S,oe),y[be]=e.readUint32BE(S,oe+4)}for(var be=0;be<80;be++){var we=O,le=z,_e=B,H=ne,F=$,U=L,d=P,T=R,ae=E,fe=u,Ie=b,He=G,Ve=W,je=se,pt=ce,gt=de;if(w=R,A=de,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=($>>>14|W<<18)^($>>>18|W<<14)^(W>>>9|$<<23),A=(W>>>14|$<<18)^(W>>>18|$<<14)^($>>>9|W<<23),V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,w=$&L^~$&P,A=W&se^~W&ce,V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,w=o[be*2],A=o[be*2+1],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,w=f[be%16],A=y[be%16],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,ee=J&65535|re<<16,Q=V&65535|k<<16,w=ee,A=Q,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=(O>>>28|E<<4)^(E>>>2|O<<30)^(E>>>7|O<<25),A=(E>>>28|O<<4)^(O>>>2|E<<30)^(O>>>7|E<<25),V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,w=O&z^O&B^z&B,A=E&u^E&b^u&b,V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,T=J&65535|re<<16,gt=V&65535|k<<16,w=H,A=He,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=ee,A=Q,V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,H=J&65535|re<<16,He=V&65535|k<<16,z=we,B=le,ne=_e,$=H,L=F,P=U,R=d,O=T,u=ae,b=fe,G=Ie,W=He,se=Ve,ce=je,de=pt,E=gt,be%16===15)for(var oe=0;oe<16;oe++)w=f[oe],A=y[oe],V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=f[(oe+9)%16],A=y[(oe+9)%16],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,ee=f[(oe+1)%16],Q=y[(oe+1)%16],w=(ee>>>1|Q<<31)^(ee>>>8|Q<<24)^ee>>>7,A=(Q>>>1|ee<<31)^(Q>>>8|ee<<24)^(Q>>>7|ee<<25),V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,ee=f[(oe+14)%16],Q=y[(oe+14)%16],w=(ee>>>19|Q<<13)^(Q>>>29|ee<<3)^ee>>>6,A=(Q>>>19|ee<<13)^(ee>>>29|Q<<3)^(Q>>>6|ee<<26),V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,f[oe]=J&65535|re<<16,y[oe]=V&65535|k<<16}w=O,A=E,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[0],A=v[0],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[0]=O=J&65535|re<<16,v[0]=E=V&65535|k<<16,w=z,A=u,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[1],A=v[1],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[1]=z=J&65535|re<<16,v[1]=u=V&65535|k<<16,w=B,A=b,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[2],A=v[2],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[2]=B=J&65535|re<<16,v[2]=b=V&65535|k<<16,w=ne,A=G,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[3],A=v[3],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[3]=ne=J&65535|re<<16,v[3]=G=V&65535|k<<16,w=$,A=W,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[4],A=v[4],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[4]=$=J&65535|re<<16,v[4]=W=V&65535|k<<16,w=L,A=se,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[5],A=v[5],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[5]=L=J&65535|re<<16,v[5]=se=V&65535|k<<16,w=P,A=ce,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[6],A=v[6],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[6]=P=J&65535|re<<16,v[6]=ce=V&65535|k<<16,w=R,A=de,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[7],A=v[7],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[7]=R=J&65535|re<<16,v[7]=de=V&65535|k<<16,D+=128,x-=128}return D}function l(f){var y=new s;y.update(f);var p=y.digest();return y.clean(),p}i.hash=l})(Ap);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=qn,t=Ap,s=Pr;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(H){const F=new Float64Array(16);if(H)for(let U=0;U<H.length;U++)F[U]=H[U];return F}const c=new Uint8Array(32);c[0]=9;const l=o(),f=o([1]),y=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),v=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),S=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),D=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function x(H,F){for(let U=0;U<16;U++)H[U]=F[U]|0}function O(H){let F=1;for(let U=0;U<16;U++){let d=H[U]+F+65535;F=Math.floor(d/65536),H[U]=d-F*65536}H[0]+=F-1+37*(F-1)}function z(H,F,U){const d=~(U-1);for(let T=0;T<16;T++){const ae=d&(H[T]^F[T]);H[T]^=ae,F[T]^=ae}}function B(H,F){const U=o(),d=o();for(let T=0;T<16;T++)d[T]=F[T];O(d),O(d),O(d);for(let T=0;T<2;T++){U[0]=d[0]-65517;for(let fe=1;fe<15;fe++)U[fe]=d[fe]-65535-(U[fe-1]>>16&1),U[fe-1]&=65535;U[15]=d[15]-32767-(U[14]>>16&1);const ae=U[15]>>16&1;U[14]&=65535,z(d,U,1-ae)}for(let T=0;T<16;T++)H[2*T]=d[T]&255,H[2*T+1]=d[T]>>8}function ne(H,F){let U=0;for(let d=0;d<32;d++)U|=H[d]^F[d];return(1&U-1>>>8)-1}function $(H,F){const U=new Uint8Array(32),d=new Uint8Array(32);return B(U,H),B(d,F),ne(U,d)}function L(H){const F=new Uint8Array(32);return B(F,H),F[0]&1}function P(H,F){for(let U=0;U<16;U++)H[U]=F[2*U]+(F[2*U+1]<<8);H[15]&=32767}function R(H,F,U){for(let d=0;d<16;d++)H[d]=F[d]+U[d]}function E(H,F,U){for(let d=0;d<16;d++)H[d]=F[d]-U[d]}function u(H,F,U){let d,T,ae=0,fe=0,Ie=0,He=0,Ve=0,je=0,pt=0,gt=0,qe=0,xe=0,Ne=0,$e=0,Fe=0,Pe=0,Ue=0,Se=0,Ce=0,Be=0,Oe=0,ke=0,We=0,et=0,tt=0,Qe=0,tr=0,lr=0,Jr=0,rr=0,si=0,Si=0,Fi=0,Et=U[0],yt=U[1],Dt=U[2],St=U[3],bt=U[4],vt=U[5],$t=U[6],Ut=U[7],It=U[8],Lt=U[9],xt=U[10],At=U[11],Ot=U[12],ht=U[13],jt=U[14],Mt=U[15];d=F[0],ae+=d*Et,fe+=d*yt,Ie+=d*Dt,He+=d*St,Ve+=d*bt,je+=d*vt,pt+=d*$t,gt+=d*Ut,qe+=d*It,xe+=d*Lt,Ne+=d*xt,$e+=d*At,Fe+=d*Ot,Pe+=d*ht,Ue+=d*jt,Se+=d*Mt,d=F[1],fe+=d*Et,Ie+=d*yt,He+=d*Dt,Ve+=d*St,je+=d*bt,pt+=d*vt,gt+=d*$t,qe+=d*Ut,xe+=d*It,Ne+=d*Lt,$e+=d*xt,Fe+=d*At,Pe+=d*Ot,Ue+=d*ht,Se+=d*jt,Ce+=d*Mt,d=F[2],Ie+=d*Et,He+=d*yt,Ve+=d*Dt,je+=d*St,pt+=d*bt,gt+=d*vt,qe+=d*$t,xe+=d*Ut,Ne+=d*It,$e+=d*Lt,Fe+=d*xt,Pe+=d*At,Ue+=d*Ot,Se+=d*ht,Ce+=d*jt,Be+=d*Mt,d=F[3],He+=d*Et,Ve+=d*yt,je+=d*Dt,pt+=d*St,gt+=d*bt,qe+=d*vt,xe+=d*$t,Ne+=d*Ut,$e+=d*It,Fe+=d*Lt,Pe+=d*xt,Ue+=d*At,Se+=d*Ot,Ce+=d*ht,Be+=d*jt,Oe+=d*Mt,d=F[4],Ve+=d*Et,je+=d*yt,pt+=d*Dt,gt+=d*St,qe+=d*bt,xe+=d*vt,Ne+=d*$t,$e+=d*Ut,Fe+=d*It,Pe+=d*Lt,Ue+=d*xt,Se+=d*At,Ce+=d*Ot,Be+=d*ht,Oe+=d*jt,ke+=d*Mt,d=F[5],je+=d*Et,pt+=d*yt,gt+=d*Dt,qe+=d*St,xe+=d*bt,Ne+=d*vt,$e+=d*$t,Fe+=d*Ut,Pe+=d*It,Ue+=d*Lt,Se+=d*xt,Ce+=d*At,Be+=d*Ot,Oe+=d*ht,ke+=d*jt,We+=d*Mt,d=F[6],pt+=d*Et,gt+=d*yt,qe+=d*Dt,xe+=d*St,Ne+=d*bt,$e+=d*vt,Fe+=d*$t,Pe+=d*Ut,Ue+=d*It,Se+=d*Lt,Ce+=d*xt,Be+=d*At,Oe+=d*Ot,ke+=d*ht,We+=d*jt,et+=d*Mt,d=F[7],gt+=d*Et,qe+=d*yt,xe+=d*Dt,Ne+=d*St,$e+=d*bt,Fe+=d*vt,Pe+=d*$t,Ue+=d*Ut,Se+=d*It,Ce+=d*Lt,Be+=d*xt,Oe+=d*At,ke+=d*Ot,We+=d*ht,et+=d*jt,tt+=d*Mt,d=F[8],qe+=d*Et,xe+=d*yt,Ne+=d*Dt,$e+=d*St,Fe+=d*bt,Pe+=d*vt,Ue+=d*$t,Se+=d*Ut,Ce+=d*It,Be+=d*Lt,Oe+=d*xt,ke+=d*At,We+=d*Ot,et+=d*ht,tt+=d*jt,Qe+=d*Mt,d=F[9],xe+=d*Et,Ne+=d*yt,$e+=d*Dt,Fe+=d*St,Pe+=d*bt,Ue+=d*vt,Se+=d*$t,Ce+=d*Ut,Be+=d*It,Oe+=d*Lt,ke+=d*xt,We+=d*At,et+=d*Ot,tt+=d*ht,Qe+=d*jt,tr+=d*Mt,d=F[10],Ne+=d*Et,$e+=d*yt,Fe+=d*Dt,Pe+=d*St,Ue+=d*bt,Se+=d*vt,Ce+=d*$t,Be+=d*Ut,Oe+=d*It,ke+=d*Lt,We+=d*xt,et+=d*At,tt+=d*Ot,Qe+=d*ht,tr+=d*jt,lr+=d*Mt,d=F[11],$e+=d*Et,Fe+=d*yt,Pe+=d*Dt,Ue+=d*St,Se+=d*bt,Ce+=d*vt,Be+=d*$t,Oe+=d*Ut,ke+=d*It,We+=d*Lt,et+=d*xt,tt+=d*At,Qe+=d*Ot,tr+=d*ht,lr+=d*jt,Jr+=d*Mt,d=F[12],Fe+=d*Et,Pe+=d*yt,Ue+=d*Dt,Se+=d*St,Ce+=d*bt,Be+=d*vt,Oe+=d*$t,ke+=d*Ut,We+=d*It,et+=d*Lt,tt+=d*xt,Qe+=d*At,tr+=d*Ot,lr+=d*ht,Jr+=d*jt,rr+=d*Mt,d=F[13],Pe+=d*Et,Ue+=d*yt,Se+=d*Dt,Ce+=d*St,Be+=d*bt,Oe+=d*vt,ke+=d*$t,We+=d*Ut,et+=d*It,tt+=d*Lt,Qe+=d*xt,tr+=d*At,lr+=d*Ot,Jr+=d*ht,rr+=d*jt,si+=d*Mt,d=F[14],Ue+=d*Et,Se+=d*yt,Ce+=d*Dt,Be+=d*St,Oe+=d*bt,ke+=d*vt,We+=d*$t,et+=d*Ut,tt+=d*It,Qe+=d*Lt,tr+=d*xt,lr+=d*At,Jr+=d*Ot,rr+=d*ht,si+=d*jt,Si+=d*Mt,d=F[15],Se+=d*Et,Ce+=d*yt,Be+=d*Dt,Oe+=d*St,ke+=d*bt,We+=d*vt,et+=d*$t,tt+=d*Ut,Qe+=d*It,tr+=d*Lt,lr+=d*xt,Jr+=d*At,rr+=d*Ot,si+=d*ht,Si+=d*jt,Fi+=d*Mt,ae+=38*Ce,fe+=38*Be,Ie+=38*Oe,He+=38*ke,Ve+=38*We,je+=38*et,pt+=38*tt,gt+=38*Qe,qe+=38*tr,xe+=38*lr,Ne+=38*Jr,$e+=38*rr,Fe+=38*si,Pe+=38*Si,Ue+=38*Fi,T=1,d=ae+T+65535,T=Math.floor(d/65536),ae=d-T*65536,d=fe+T+65535,T=Math.floor(d/65536),fe=d-T*65536,d=Ie+T+65535,T=Math.floor(d/65536),Ie=d-T*65536,d=He+T+65535,T=Math.floor(d/65536),He=d-T*65536,d=Ve+T+65535,T=Math.floor(d/65536),Ve=d-T*65536,d=je+T+65535,T=Math.floor(d/65536),je=d-T*65536,d=pt+T+65535,T=Math.floor(d/65536),pt=d-T*65536,d=gt+T+65535,T=Math.floor(d/65536),gt=d-T*65536,d=qe+T+65535,T=Math.floor(d/65536),qe=d-T*65536,d=xe+T+65535,T=Math.floor(d/65536),xe=d-T*65536,d=Ne+T+65535,T=Math.floor(d/65536),Ne=d-T*65536,d=$e+T+65535,T=Math.floor(d/65536),$e=d-T*65536,d=Fe+T+65535,T=Math.floor(d/65536),Fe=d-T*65536,d=Pe+T+65535,T=Math.floor(d/65536),Pe=d-T*65536,d=Ue+T+65535,T=Math.floor(d/65536),Ue=d-T*65536,d=Se+T+65535,T=Math.floor(d/65536),Se=d-T*65536,ae+=T-1+37*(T-1),T=1,d=ae+T+65535,T=Math.floor(d/65536),ae=d-T*65536,d=fe+T+65535,T=Math.floor(d/65536),fe=d-T*65536,d=Ie+T+65535,T=Math.floor(d/65536),Ie=d-T*65536,d=He+T+65535,T=Math.floor(d/65536),He=d-T*65536,d=Ve+T+65535,T=Math.floor(d/65536),Ve=d-T*65536,d=je+T+65535,T=Math.floor(d/65536),je=d-T*65536,d=pt+T+65535,T=Math.floor(d/65536),pt=d-T*65536,d=gt+T+65535,T=Math.floor(d/65536),gt=d-T*65536,d=qe+T+65535,T=Math.floor(d/65536),qe=d-T*65536,d=xe+T+65535,T=Math.floor(d/65536),xe=d-T*65536,d=Ne+T+65535,T=Math.floor(d/65536),Ne=d-T*65536,d=$e+T+65535,T=Math.floor(d/65536),$e=d-T*65536,d=Fe+T+65535,T=Math.floor(d/65536),Fe=d-T*65536,d=Pe+T+65535,T=Math.floor(d/65536),Pe=d-T*65536,d=Ue+T+65535,T=Math.floor(d/65536),Ue=d-T*65536,d=Se+T+65535,T=Math.floor(d/65536),Se=d-T*65536,ae+=T-1+37*(T-1),H[0]=ae,H[1]=fe,H[2]=Ie,H[3]=He,H[4]=Ve,H[5]=je,H[6]=pt,H[7]=gt,H[8]=qe,H[9]=xe,H[10]=Ne,H[11]=$e,H[12]=Fe,H[13]=Pe,H[14]=Ue,H[15]=Se}function b(H,F){u(H,F,F)}function G(H,F){const U=o();let d;for(d=0;d<16;d++)U[d]=F[d];for(d=253;d>=0;d--)b(U,U),d!==2&&d!==4&&u(U,U,F);for(d=0;d<16;d++)H[d]=U[d]}function W(H,F){const U=o();let d;for(d=0;d<16;d++)U[d]=F[d];for(d=250;d>=0;d--)b(U,U),d!==1&&u(U,U,F);for(d=0;d<16;d++)H[d]=U[d]}function se(H,F){const U=o(),d=o(),T=o(),ae=o(),fe=o(),Ie=o(),He=o(),Ve=o(),je=o();E(U,H[1],H[0]),E(je,F[1],F[0]),u(U,U,je),R(d,H[0],H[1]),R(je,F[0],F[1]),u(d,d,je),u(T,H[3],F[3]),u(T,T,p),u(ae,H[2],F[2]),R(ae,ae,ae),E(fe,d,U),E(Ie,ae,T),R(He,ae,T),R(Ve,d,U),u(H[0],fe,Ie),u(H[1],Ve,He),u(H[2],He,Ie),u(H[3],fe,Ve)}function ce(H,F,U){for(let d=0;d<4;d++)z(H[d],F[d],U)}function de(H,F){const U=o(),d=o(),T=o();G(T,F[2]),u(U,F[0],T),u(d,F[1],T),B(H,d),H[31]^=L(U)<<7}function w(H,F,U){x(H[0],l),x(H[1],f),x(H[2],f),x(H[3],l);for(let d=255;d>=0;--d){const T=U[d/8|0]>>(d&7)&1;ce(H,F,T),se(F,H),se(H,H),ce(H,F,T)}}function A(H,F){const U=[o(),o(),o(),o()];x(U[0],v),x(U[1],S),x(U[2],f),u(U[3],v,S),w(H,U,F)}function ee(H){if(H.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const F=(0,t.hash)(H);F[0]&=248,F[31]&=127,F[31]|=64;const U=new Uint8Array(32),d=[o(),o(),o(),o()];A(d,F),de(U,d);const T=new Uint8Array(64);return T.set(H),T.set(U,32),{publicKey:U,secretKey:T}}i.generateKeyPairFromSeed=ee;function Q(H){const F=(0,e.randomBytes)(32,H),U=ee(F);return(0,s.wipe)(F),U}i.generateKeyPair=Q;function V(H){if(H.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(H.subarray(32))}i.extractPublicKeyFromSecretKey=V;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(H,F){let U,d,T,ae;for(d=63;d>=32;--d){for(U=0,T=d-32,ae=d-12;T<ae;++T)F[T]+=U-16*F[d]*k[T-(d-32)],U=Math.floor((F[T]+128)/256),F[T]-=U*256;F[T]+=U,F[d]=0}for(U=0,T=0;T<32;T++)F[T]+=U-(F[31]>>4)*k[T],U=F[T]>>8,F[T]&=255;for(T=0;T<32;T++)F[T]-=U*k[T];for(d=0;d<32;d++)F[d+1]+=F[d]>>8,H[d]=F[d]&255}function re(H){const F=new Float64Array(64);for(let U=0;U<64;U++)F[U]=H[U];for(let U=0;U<64;U++)H[U]=0;J(H,F)}function be(H,F){const U=new Float64Array(64),d=[o(),o(),o(),o()],T=(0,t.hash)(H.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const ae=new Uint8Array(64);ae.set(T.subarray(32),32);const fe=new t.SHA512;fe.update(ae.subarray(32)),fe.update(F);const Ie=fe.digest();fe.clean(),re(Ie),A(d,Ie),de(ae,d),fe.reset(),fe.update(ae.subarray(0,32)),fe.update(H.subarray(32)),fe.update(F);const He=fe.digest();re(He);for(let Ve=0;Ve<32;Ve++)U[Ve]=Ie[Ve];for(let Ve=0;Ve<32;Ve++)for(let je=0;je<32;je++)U[Ve+je]+=He[Ve]*T[je];return J(ae.subarray(32),U),ae}i.sign=be;function oe(H,F){const U=o(),d=o(),T=o(),ae=o(),fe=o(),Ie=o(),He=o();return x(H[2],f),P(H[1],F),b(T,H[1]),u(ae,T,y),E(T,T,H[2]),R(ae,H[2],ae),b(fe,ae),b(Ie,fe),u(He,Ie,fe),u(U,He,T),u(U,U,ae),W(U,U),u(U,U,T),u(U,U,ae),u(U,U,ae),u(H[0],U,ae),b(d,H[0]),u(d,d,ae),$(d,T)&&u(H[0],H[0],D),b(d,H[0]),u(d,d,ae),$(d,T)?-1:(L(H[0])===F[31]>>7&&E(H[0],l,H[0]),u(H[3],H[0],H[1]),0)}function we(H,F,U){const d=new Uint8Array(32),T=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(U.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(oe(ae,H))return!1;const fe=new t.SHA512;fe.update(U.subarray(0,32)),fe.update(H),fe.update(F);const Ie=fe.digest();return re(Ie),w(T,ae,Ie),A(ae,U.subarray(32)),se(T,ae),de(d,T),!ne(U,d)}i.verify=we;function le(H){let F=[o(),o(),o(),o()];if(oe(F,H))throw new Error("Ed25519: invalid public key");let U=o(),d=o(),T=F[1];R(U,f,T),E(d,f,T),G(d,d),u(U,U,d);let ae=new Uint8Array(32);return B(ae,U),ae}i.convertPublicKeyToX25519=le;function _e(H){const F=(0,t.hash)(H.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const U=new Uint8Array(F.subarray(0,32));return(0,s.wipe)(F),U}i.convertSecretKeyToX25519=_e})(eh);const NS="EdDSA",$S="JWT",Tp=".",Rp="base64url",US="utf8",LS="utf8",jS=":",MS="did",qS="key",rd="base58btc",FS="z",zS="K36",HS=32;function ta(i){return hr(br(on(i),US),Rp)}function Np(i){const e=br(zS,rd),t=FS+hr(pu([e,i]),rd);return[MS,qS,t].join(jS)}function BS(i){return hr(i,Rp)}function KS(i){return br([ta(i.header),ta(i.payload)].join(Tp),LS)}function VS(i){return[ta(i.header),ta(i.payload),BS(i.signature)].join(Tp)}function id(i=qn.randomBytes(HS)){return eh.generateKeyPairFromSeed(i)}async function kS(i,e,t,s,o=ve.fromMiliseconds(Date.now())){const c={alg:NS,typ:$S},l=Np(s.publicKey),f=o+t,y={iss:l,sub:i,aud:e,iat:o,exp:f},p=KS({header:c,payload:y}),v=eh.sign(s.secretKey,p);return VS({header:c,payload:y,signature:v})}const GS="PARSE_ERROR",WS="INVALID_REQUEST",YS="METHOD_NOT_FOUND",JS="INVALID_PARAMS",$p="INTERNAL_ERROR",th="SERVER_ERROR",QS=[-32700,-32600,-32601,-32602,-32603],Es={[GS]:{code:-32700,message:"Parse error"},[WS]:{code:-32600,message:"Invalid Request"},[YS]:{code:-32601,message:"Method not found"},[JS]:{code:-32602,message:"Invalid params"},[$p]:{code:-32603,message:"Internal error"},[th]:{code:-32e3,message:"Server error"}},Up=th;function XS(i){return QS.includes(i)}function nd(i){return Object.keys(Es).includes(i)?Es[i]:Es[Up]}function ZS(i){const e=Object.values(Es).find(t=>t.code===i);return e||Es[Up]}function Lp(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var jp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Au=function(i,e){return Au=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Au(i,e)};function e2(i,e){Au(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Tu=function(){return Tu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Tu.apply(this,arguments)};function t2(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function r2(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function i2(i,e){return function(t,s){e(t,s,i)}}function n2(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function s2(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(S){l(S)}}function y(v){try{p(s.throw(v))}catch(S){l(S)}}function p(v){v.done?c(v.value):o(v.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function o2(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return y([p,v])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function a2(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function c2(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Ru(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function u2(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Mp(arguments[e]));return i}function h2(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ps(i){return this instanceof Ps?(this.v=i,this):new Ps(i)}function l2(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(D){s[D]&&(o[D]=function(x){return new Promise(function(O,z){c.push([D,x,O,z])>1||f(D,x)})})}function f(D,x){try{y(s[D](x))}catch(O){S(c[0][3],O)}}function y(D){D.value instanceof Ps?Promise.resolve(D.value.v).then(p,v):S(c[0][2],D)}function p(D){f("next",D)}function v(D){f("throw",D)}function S(D,x){D(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function f2(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ps(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function d2(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Ru=="function"?Ru(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function p2(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function g2(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function y2(i){return i&&i.__esModule?i:{default:i}}function v2(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function _2(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const m2=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Tu},__asyncDelegator:f2,__asyncGenerator:l2,__asyncValues:d2,__await:Ps,__awaiter:s2,__classPrivateFieldGet:v2,__classPrivateFieldSet:_2,__createBinding:a2,__decorate:r2,__exportStar:c2,__extends:e2,__generator:o2,__importDefault:y2,__importStar:g2,__makeTemplateObject:p2,__metadata:n2,__param:i2,__read:Mp,__rest:t2,__spread:u2,__spreadArrays:h2,__values:Ru},Symbol.toStringTag,{value:"Module"})),b2=Mn(m2);var vi={},sd;function w2(){if(sd)return vi;sd=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.isBrowserCryptoAvailable=vi.getSubtleCrypto=vi.getBrowerCrypto=void 0;function i(){return(Yr===null||Yr===void 0?void 0:Yr.crypto)||(Yr===null||Yr===void 0?void 0:Yr.msCrypto)||{}}vi.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}vi.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return vi.isBrowserCryptoAvailable=t,vi}var _i={},od;function E2(){if(od)return _i;od=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isBrowser=_i.isNode=_i.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_i.isReactNative=i;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}_i.isNode=e;function t(){return!i()&&!e()}return _i.isBrowser=t,_i}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=b2;e.__exportStar(w2(),i),e.__exportStar(E2(),i)})(jp);function rh(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function qp(i=6){return BigInt(rh(i))}function jn(i,e,t){return{id:t||rh(),jsonrpc:"2.0",method:i,params:e}}function fa(i,e){return{id:i,jsonrpc:"2.0",result:e}}function da(i,e,t){return{id:i,jsonrpc:"2.0",error:D2(e,t)}}function D2(i,e){return typeof i>"u"?nd($p):(typeof i=="string"&&(i=Object.assign(Object.assign({},nd(th)),{message:i})),typeof e<"u"&&(i.data=e),XS(i.code)&&(i=ZS(i.code)),i)}class S2{}class I2 extends S2{constructor(){super()}}class x2 extends I2{constructor(e){super()}}const O2="^https?:",P2="^wss?:";function C2(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Fp(i,e){const t=C2(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function ad(i){return Fp(i,O2)}function cd(i){return Fp(i,P2)}function A2(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function zp(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function ih(i){return zp(i)&&"method"in i}function pa(i){return zp(i)&&(wi(i)||Wr(i))}function wi(i){return"result"in i}function Wr(i){return"error"in i}class Ei extends x2{constructor(e){super(e),this.events=new qr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(jn(e.method,e.params||[],e.id||qp().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Wr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),pa(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const T2=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),R2=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ud=i=>i.split("?")[0],hd=10,N2=T2();let $2=class{constructor(e){if(this.url=e,this.events=new qr.EventEmitter,this.registering=!1,!cd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(on(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!cd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=new URLSearchParams(e).get("origin"),c=jp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!A2(e)},l=new N2(e,[],c);R2()?l.onerror=f=>{const y=f;s(this.emitError(y.error))}:l.on("error",f=>{s(this.emitError(f))}),l.onopen=()=>{this.onOpen(l),t(l)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?$s(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=da(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Lp(e,ud(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>hd&&this.events.setMaxListeners(hd)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${ud(this.url)}`));return this.events.emit("register_error",t),t}};var ra={exports:{}};ra.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,f="[object Arguments]",y="[object Array]",p="[object AsyncFunction]",v="[object Boolean]",S="[object Date]",D="[object Error]",x="[object Function]",O="[object GeneratorFunction]",z="[object Map]",B="[object Number]",ne="[object Null]",$="[object Object]",L="[object Promise]",P="[object Proxy]",R="[object RegExp]",E="[object Set]",u="[object String]",b="[object Symbol]",G="[object Undefined]",W="[object WeakMap]",se="[object ArrayBuffer]",ce="[object DataView]",de="[object Float32Array]",w="[object Float64Array]",A="[object Int8Array]",ee="[object Int16Array]",Q="[object Int32Array]",V="[object Uint8Array]",k="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[w]=le[A]=le[ee]=le[Q]=le[V]=le[k]=le[J]=le[re]=!0,le[f]=le[y]=le[se]=le[v]=le[ce]=le[S]=le[D]=le[x]=le[z]=le[B]=le[$]=le[R]=le[E]=le[u]=le[W]=!1;var _e=typeof Yr=="object"&&Yr&&Yr.Object===Object&&Yr,H=typeof self=="object"&&self&&self.Object===Object&&self,F=_e||H||Function("return this")(),U=e&&!e.nodeType&&e,d=U&&!0&&i&&!i.nodeType&&i,T=d&&d.exports===U,ae=T&&_e.process,fe=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function He(I,j){for(var te=-1,pe=I==null?0:I.length,at=0,Te=[];++te<pe;){var ft=I[te];j(ft,te,I)&&(Te[at++]=ft)}return Te}function Ve(I,j){for(var te=-1,pe=j.length,at=I.length;++te<pe;)I[at+te]=j[te];return I}function je(I,j){for(var te=-1,pe=I==null?0:I.length;++te<pe;)if(j(I[te],te,I))return!0;return!1}function pt(I,j){for(var te=-1,pe=Array(I);++te<I;)pe[te]=j(te);return pe}function gt(I){return function(j){return I(j)}}function qe(I,j){return I.has(j)}function xe(I,j){return I==null?void 0:I[j]}function Ne(I){var j=-1,te=Array(I.size);return I.forEach(function(pe,at){te[++j]=[at,pe]}),te}function $e(I,j){return function(te){return I(j(te))}}function Fe(I){var j=-1,te=Array(I.size);return I.forEach(function(pe){te[++j]=pe}),te}var Pe=Array.prototype,Ue=Function.prototype,Se=Object.prototype,Ce=F["__core-js_shared__"],Be=Ue.toString,Oe=Se.hasOwnProperty,ke=function(){var I=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""}(),We=Se.toString,et=RegExp("^"+Be.call(Oe).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=T?F.Buffer:void 0,Qe=F.Symbol,tr=F.Uint8Array,lr=Se.propertyIsEnumerable,Jr=Pe.splice,rr=Qe?Qe.toStringTag:void 0,si=Object.getOwnPropertySymbols,Si=tt?tt.isBuffer:void 0,Fi=$e(Object.keys,Object),Et=wr(F,"DataView"),yt=wr(F,"Map"),Dt=wr(F,"Promise"),St=wr(F,"Set"),bt=wr(F,"WeakMap"),vt=wr(Object,"create"),$t=ai(Et),Ut=ai(yt),It=ai(Dt),Lt=ai(St),xt=ai(bt),At=Qe?Qe.prototype:void 0,Ot=At?At.valueOf:void 0;function ht(I){var j=-1,te=I==null?0:I.length;for(this.clear();++j<te;){var pe=I[j];this.set(pe[0],pe[1])}}function jt(){this.__data__=vt?vt(null):{},this.size=0}function Mt(I){var j=this.has(I)&&delete this.__data__[I];return this.size-=j?1:0,j}function va(I){var j=this.__data__;if(vt){var te=j[I];return te===s?void 0:te}return Oe.call(j,I)?j[I]:void 0}function _a(I){var j=this.__data__;return vt?j[I]!==void 0:Oe.call(j,I)}function ma(I,j){var te=this.__data__;return this.size+=this.has(I)?0:1,te[I]=vt&&j===void 0?s:j,this}ht.prototype.clear=jt,ht.prototype.delete=Mt,ht.prototype.get=va,ht.prototype.has=_a,ht.prototype.set=ma;function Cr(I){var j=-1,te=I==null?0:I.length;for(this.clear();++j<te;){var pe=I[j];this.set(pe[0],pe[1])}}function ba(){this.__data__=[],this.size=0}function wa(I){var j=this.__data__,te=zi(j,I);if(te<0)return!1;var pe=j.length-1;return te==pe?j.pop():Jr.call(j,te,1),--this.size,!0}function Ea(I){var j=this.__data__,te=zi(j,I);return te<0?void 0:j[te][1]}function Da(I){return zi(this.__data__,I)>-1}function Sa(I,j){var te=this.__data__,pe=zi(te,I);return pe<0?(++this.size,te.push([I,j])):te[pe][1]=j,this}Cr.prototype.clear=ba,Cr.prototype.delete=wa,Cr.prototype.get=Ea,Cr.prototype.has=Da,Cr.prototype.set=Sa;function oi(I){var j=-1,te=I==null?0:I.length;for(this.clear();++j<te;){var pe=I[j];this.set(pe[0],pe[1])}}function fn(){this.size=0,this.__data__={hash:new ht,map:new(yt||Cr),string:new ht}}function Ia(I){var j=Ii(this,I).delete(I);return this.size-=j?1:0,j}function dn(I){return Ii(this,I).get(I)}function xa(I){return Ii(this,I).has(I)}function Oa(I,j){var te=Ii(this,I),pe=te.size;return te.set(I,j),this.size+=te.size==pe?0:1,this}oi.prototype.clear=fn,oi.prototype.delete=Ia,oi.prototype.get=dn,oi.prototype.has=xa,oi.prototype.set=Oa;function pn(I){var j=-1,te=I==null?0:I.length;for(this.__data__=new oi;++j<te;)this.add(I[j])}function Ls(I){return this.__data__.set(I,s),this}function js(I){return this.__data__.has(I)}pn.prototype.add=pn.prototype.push=Ls,pn.prototype.has=js;function Fr(I){var j=this.__data__=new Cr(I);this.size=j.size}function Pa(){this.__data__=new Cr,this.size=0}function Ca(I){var j=this.__data__,te=j.delete(I);return this.size=j.size,te}function Aa(I){return this.__data__.get(I)}function Ta(I){return this.__data__.has(I)}function Ms(I,j){var te=this.__data__;if(te instanceof Cr){var pe=te.__data__;if(!yt||pe.length<t-1)return pe.push([I,j]),this.size=++te.size,this;te=this.__data__=new oi(pe)}return te.set(I,j),this.size=te.size,this}Fr.prototype.clear=Pa,Fr.prototype.delete=Ca,Fr.prototype.get=Aa,Fr.prototype.has=Ta,Fr.prototype.set=Ms;function qs(I,j){var te=vn(I),pe=!te&&Qs(I),at=!te&&!pe&&Gn(I),Te=!te&&!pe&&!at&&eo(I),ft=te||pe||at||Te,qt=ft?pt(I.length,String):[],Xe=qt.length;for(var ct in I)(j||Oe.call(I,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Te&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||ks(ct,Xe)))&&qt.push(ct);return qt}function zi(I,j){for(var te=I.length;te--;)if(Js(I[te][0],j))return te;return-1}function Vn(I,j,te){var pe=j(I);return vn(I)?pe:Ve(pe,te(I))}function Hi(I){return I==null?I===void 0?G:ne:rr&&rr in Object(I)?Ks(I):$a(I)}function kn(I){return Ki(I)&&Hi(I)==f}function Bi(I,j,te,pe,at){return I===j?!0:I==null||j==null||!Ki(I)&&!Ki(j)?I!==I&&j!==j:Fs(I,j,te,pe,Bi,at)}function Fs(I,j,te,pe,at,Te){var ft=vn(I),qt=vn(j),Xe=ft?y:Qr(I),ct=qt?y:Qr(j);Xe=Xe==f?$:Xe,ct=ct==f?$:ct;var Tt=Xe==$,fr=ct==$,Ft=Xe==ct;if(Ft&&Gn(I)){if(!Gn(j))return!1;ft=!0,Tt=!1}if(Ft&&!Tt)return Te||(Te=new Fr),ft||eo(I)?gn(I,j,te,pe,at,Te):Na(I,j,Xe,te,pe,at,Te);if(!(te&o)){var dt=Tt&&Oe.call(I,"__wrapped__"),ir=fr&&Oe.call(j,"__wrapped__");if(dt||ir){var zr=dt?I.value():I,Ar=ir?j.value():j;return Te||(Te=new Fr),at(zr,Ar,te,pe,Te)}}return Ft?(Te||(Te=new Fr),Bs(I,j,te,pe,at,Te)):!1}function Ra(I){if(!Zs(I)||Ws(I))return!1;var j=_n(I)?et:oe;return j.test(ai(I))}function zs(I){return Ki(I)&&Xs(I.length)&&!!le[Hi(I)]}function Hs(I){if(!Ys(I))return Fi(I);var j=[];for(var te in Object(I))Oe.call(I,te)&&te!="constructor"&&j.push(te);return j}function gn(I,j,te,pe,at,Te){var ft=te&o,qt=I.length,Xe=j.length;if(qt!=Xe&&!(ft&&Xe>qt))return!1;var ct=Te.get(I);if(ct&&Te.get(j))return ct==j;var Tt=-1,fr=!0,Ft=te&c?new pn:void 0;for(Te.set(I,j),Te.set(j,I);++Tt<qt;){var dt=I[Tt],ir=j[Tt];if(pe)var zr=ft?pe(ir,dt,Tt,j,I,Te):pe(dt,ir,Tt,I,j,Te);if(zr!==void 0){if(zr)continue;fr=!1;break}if(Ft){if(!je(j,function(Ar,Xr){if(!qe(Ft,Xr)&&(dt===Ar||at(dt,Ar,te,pe,Te)))return Ft.push(Xr)})){fr=!1;break}}else if(!(dt===ir||at(dt,ir,te,pe,Te))){fr=!1;break}}return Te.delete(I),Te.delete(j),fr}function Na(I,j,te,pe,at,Te,ft){switch(te){case ce:if(I.byteLength!=j.byteLength||I.byteOffset!=j.byteOffset)return!1;I=I.buffer,j=j.buffer;case se:return!(I.byteLength!=j.byteLength||!Te(new tr(I),new tr(j)));case v:case S:case B:return Js(+I,+j);case D:return I.name==j.name&&I.message==j.message;case R:case u:return I==j+"";case z:var qt=Ne;case E:var Xe=pe&o;if(qt||(qt=Fe),I.size!=j.size&&!Xe)return!1;var ct=ft.get(I);if(ct)return ct==j;pe|=c,ft.set(I,j);var Tt=gn(qt(I),qt(j),pe,at,Te,ft);return ft.delete(I),Tt;case b:if(Ot)return Ot.call(I)==Ot.call(j)}return!1}function Bs(I,j,te,pe,at,Te){var ft=te&o,qt=yn(I),Xe=qt.length,ct=yn(j),Tt=ct.length;if(Xe!=Tt&&!ft)return!1;for(var fr=Xe;fr--;){var Ft=qt[fr];if(!(ft?Ft in j:Oe.call(j,Ft)))return!1}var dt=Te.get(I);if(dt&&Te.get(j))return dt==j;var ir=!0;Te.set(I,j),Te.set(j,I);for(var zr=ft;++fr<Xe;){Ft=qt[fr];var Ar=I[Ft],Xr=j[Ft];if(pe)var Wn=ft?pe(Xr,Ar,Ft,j,I,Te):pe(Ar,Xr,Ft,I,j,Te);if(!(Wn===void 0?Ar===Xr||at(Ar,Xr,te,pe,Te):Wn)){ir=!1;break}zr||(zr=Ft=="constructor")}if(ir&&!zr){var Vi=I.constructor,Kt=j.constructor;Vi!=Kt&&"constructor"in I&&"constructor"in j&&!(typeof Vi=="function"&&Vi instanceof Vi&&typeof Kt=="function"&&Kt instanceof Kt)&&(ir=!1)}return Te.delete(I),Te.delete(j),ir}function yn(I){return Vn(I,ja,Vs)}function Ii(I,j){var te=I.__data__;return Gs(j)?te[typeof j=="string"?"string":"hash"]:te.map}function wr(I,j){var te=xe(I,j);return Ra(te)?te:void 0}function Ks(I){var j=Oe.call(I,rr),te=I[rr];try{I[rr]=void 0;var pe=!0}catch{}var at=We.call(I);return pe&&(j?I[rr]=te:delete I[rr]),at}var Vs=si?function(I){return I==null?[]:(I=Object(I),He(si(I),function(j){return lr.call(I,j)}))}:ot,Qr=Hi;(Et&&Qr(new Et(new ArrayBuffer(1)))!=ce||yt&&Qr(new yt)!=z||Dt&&Qr(Dt.resolve())!=L||St&&Qr(new St)!=E||bt&&Qr(new bt)!=W)&&(Qr=function(I){var j=Hi(I),te=j==$?I.constructor:void 0,pe=te?ai(te):"";if(pe)switch(pe){case $t:return ce;case Ut:return z;case It:return L;case Lt:return E;case xt:return W}return j});function ks(I,j){return j=j??l,!!j&&(typeof I=="number"||we.test(I))&&I>-1&&I%1==0&&I<j}function Gs(I){var j=typeof I;return j=="string"||j=="number"||j=="symbol"||j=="boolean"?I!=="__proto__":I===null}function Ws(I){return!!ke&&ke in I}function Ys(I){var j=I&&I.constructor,te=typeof j=="function"&&j.prototype||Se;return I===te}function $a(I){return We.call(I)}function ai(I){if(I!=null){try{return Be.call(I)}catch{}try{return I+""}catch{}}return""}function Js(I,j){return I===j||I!==I&&j!==j}var Qs=kn(function(){return arguments}())?kn:function(I){return Ki(I)&&Oe.call(I,"callee")&&!lr.call(I,"callee")},vn=Array.isArray;function Ua(I){return I!=null&&Xs(I.length)&&!_n(I)}var Gn=Si||st;function La(I,j){return Bi(I,j)}function _n(I){if(!Zs(I))return!1;var j=Hi(I);return j==x||j==O||j==p||j==P}function Xs(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=l}function Zs(I){var j=typeof I;return I!=null&&(j=="object"||j=="function")}function Ki(I){return I!=null&&typeof I=="object"}var eo=Ie?gt(Ie):zs;function ja(I){return Ua(I)?qs(I):Hs(I)}function ot(){return[]}function st(){return!1}i.exports=La})(ra,ra.exports);var U2=ra.exports;const L2=Fu(U2);function j2(i,e){return e=e||{},new Promise(function(t,s){var o=new XMLHttpRequest,c=[],l=[],f={},y=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:y,headers:{keys:function(){return c},entries:function(){return l},get:function(v){return f[v.toLowerCase()]},has:function(v){return v.toLowerCase()in f}}}};for(var p in o.open(e.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(v,S,D){c.push(S=S.toLowerCase()),l.push([S,D]),f[S]=f[S]?f[S]+","+D:D}),t(y())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(p,e.headers[p]);o.send(e.body||null)})}const M2=Object.freeze(Object.defineProperty({__proto__:null,default:j2},Symbol.toStringTag,{value:"Module"})),ld=Mn(M2);var q2=self.fetch||(self.fetch=ld.default||ld);const F2=Fu(q2);var z2={};function H2(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,y=i.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function S(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var z=0,B=0,ne=0,$=O.length;ne!==$&&O[ne]===0;)ne++,z++;for(var L=($-ne)*v+1>>>0,P=new Uint8Array(L);ne!==$;){for(var R=O[ne],E=0,u=L-1;(R!==0||E<B)&&u!==-1;u--,E++)R+=256*P[u]>>>0,P[u]=R%f>>>0,R=R/f>>>0;if(R!==0)throw new Error("Non-zero carry");B=E,ne++}for(var b=L-B;b!==L&&P[b]===0;)b++;for(var G=y.repeat(z);b<L;++b)G+=i.charAt(P[b]);return G}function D(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var z=0;if(O[z]!==" "){for(var B=0,ne=0;O[z]===y;)B++,z++;for(var $=(O.length-z)*p+1>>>0,L=new Uint8Array($);O[z];){var P=t[O.charCodeAt(z)];if(P===255)return;for(var R=0,E=$-1;(P!==0||R<ne)&&E!==-1;E--,R++)P+=f*L[E]>>>0,L[E]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");ne=R,z++}if(O[z]!==" "){for(var u=$-ne;u!==$&&L[u]===0;)u++;for(var b=new Uint8Array(B+($-u)),G=B;u!==$;)b[G++]=L[u++];return b}}}function x(O){var z=D(O);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:S,decodeUnsafe:D,decode:x}}var B2=H2,K2=B2;const Hp=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},V2=i=>new TextEncoder().encode(i),k2=i=>new TextDecoder().decode(i);class G2{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class W2{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Bp(this,e)}}class Y2{constructor(e){this.decoders=e}or(e){return Bp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Bp=(i,e)=>new Y2({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class J2{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new G2(e,t,s),this.decoder=new W2(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ga=({name:i,prefix:e,encode:t,decode:s})=>new J2(i,e,t,s),Us=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=K2(t,e);return ga({prefix:i,name:e,encode:s,decode:c=>Hp(o(c))})},Q2=(i,e,t,s)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,y=0,p=0;for(let v=0;v<c;++v){const S=o[i[v]];if(S===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|S,f+=t,f>=8&&(f-=8,l[p++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return l},X2=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Jt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ga({prefix:e,name:i,encode(o){return X2(o,s,t)},decode(o){return Q2(o,s,t,i)}}),Z2=ga({prefix:"\0",name:"identity",encode:i=>k2(i),decode:i=>V2(i)});var e6=Object.freeze({__proto__:null,identity:Z2});const t6=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var r6=Object.freeze({__proto__:null,base2:t6});const i6=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var n6=Object.freeze({__proto__:null,base8:i6});const s6=Us({prefix:"9",name:"base10",alphabet:"0123456789"});var o6=Object.freeze({__proto__:null,base10:s6});const a6=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),c6=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var u6=Object.freeze({__proto__:null,base16:a6,base16upper:c6});const h6=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),l6=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),f6=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),d6=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),p6=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),g6=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),y6=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),v6=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_6=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var m6=Object.freeze({__proto__:null,base32:h6,base32upper:l6,base32pad:f6,base32padupper:d6,base32hex:p6,base32hexupper:g6,base32hexpad:y6,base32hexpadupper:v6,base32z:_6});const b6=Us({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),w6=Us({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var E6=Object.freeze({__proto__:null,base36:b6,base36upper:w6});const D6=Us({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),S6=Us({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var I6=Object.freeze({__proto__:null,base58btc:D6,base58flickr:S6});const x6=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),O6=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),P6=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),C6=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var A6=Object.freeze({__proto__:null,base64:x6,base64pad:O6,base64url:P6,base64urlpad:C6});const Kp=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),T6=Kp.reduce((i,e,t)=>(i[t]=e,i),[]),R6=Kp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function N6(i){return i.reduce((e,t)=>(e+=T6[t],e),"")}function $6(i){const e=[];for(const t of i){const s=R6[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const U6=ga({prefix:"ðŸš€",name:"base256emoji",encode:N6,decode:$6});var L6=Object.freeze({__proto__:null,base256emoji:U6}),j6=Vp,fd=128,M6=127,q6=~M6,F6=Math.pow(2,31);function Vp(i,e,t){e=e||[],t=t||0;for(var s=t;i>=F6;)e[t++]=i&255|fd,i/=128;for(;i&q6;)e[t++]=i&255|fd,i>>>=7;return e[t]=i|0,Vp.bytes=t-s+1,e}var z6=Nu,H6=128,dd=127;function Nu(i,s){var t=0,s=s||0,o=0,c=s,l,f=i.length;do{if(c>=f)throw Nu.bytes=0,new RangeError("Could not decode varint");l=i[c++],t+=o<28?(l&dd)<<o:(l&dd)*Math.pow(2,o),o+=7}while(l>=H6);return Nu.bytes=c-s,t}var B6=Math.pow(2,7),K6=Math.pow(2,14),V6=Math.pow(2,21),k6=Math.pow(2,28),G6=Math.pow(2,35),W6=Math.pow(2,42),Y6=Math.pow(2,49),J6=Math.pow(2,56),Q6=Math.pow(2,63),X6=function(i){return i<B6?1:i<K6?2:i<V6?3:i<k6?4:i<G6?5:i<W6?6:i<Y6?7:i<J6?8:i<Q6?9:10},Z6={encode:j6,decode:z6,encodingLength:X6},kp=Z6;const pd=(i,e,t=0)=>(kp.encode(i,e,t),e),gd=i=>kp.encodingLength(i),$u=(i,e)=>{const t=e.byteLength,s=gd(i),o=s+gd(t),c=new Uint8Array(o+t);return pd(i,c,0),pd(t,c,s),c.set(e,o),new eI(i,t,e,c)};class eI{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Gp=({name:i,code:e,encode:t})=>new tI(i,e,t);class tI{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?$u(this.code,t):t.then(s=>$u(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Wp=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),rI=Gp({name:"sha2-256",code:18,encode:Wp("SHA-256")}),iI=Gp({name:"sha2-512",code:19,encode:Wp("SHA-512")});var nI=Object.freeze({__proto__:null,sha256:rI,sha512:iI});const Yp=0,sI="identity",Jp=Hp,oI=i=>$u(Yp,Jp(i)),aI={code:Yp,name:sI,encode:Jp,digest:oI};var cI=Object.freeze({__proto__:null,identity:aI});new TextEncoder,new TextDecoder;const yd={...e6,...r6,...n6,...o6,...u6,...m6,...E6,...I6,...A6,...L6};({...nI,...cI});function Qp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function uI(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Qp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Xp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const vd=Xp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),eu=Xp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=uI(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),hI={utf8:vd,"utf-8":vd,hex:yd.base16,latin1:eu,ascii:eu,binary:eu,...yd};function lI(i,e="utf8"){const t=hI[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Qp(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const Zp="wc",fI=2,nh="core",Li=`${Zp}@2:${nh}:`,dI={name:nh,logger:"error"},pI={database:":memory:"},gI="crypto",_d="client_ed25519_seed",yI=ve.ONE_DAY,vI="keychain",_I="0.3",mI="messages",bI="0.3",wI=ve.SIX_HOURS,EI="publisher",eg="irn",DI="error",tg="wss://relay.walletconnect.com",md="wss://relay.walletconnect.org",SI="relayer",er={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},II="_subscription",mi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},xI=ve.ONE_SECOND,OI="2.11.0",PI=1e4,CI="0.3",AI="WALLETCONNECT_CLIENT_ID",kr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},TI="subscription",RI="0.3",NI=ve.FIVE_SECONDS*1e3,$I="pairing",UI="0.3",ps={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},bs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ii={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},LI="history",jI="0.3",MI="expirer",Mr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},qI="0.3",tu="verify-api",$n="https://verify.walletconnect.com",Uu="https://verify.walletconnect.org",FI=[$n,Uu],zI="echo",HI="https://echo.walletconnect.com";class BI{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=vI,this.version=_I,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,vp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_p(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class KI{constructor(e,t,s){this.core=e,this.logger=t,this.name=gI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=id(o);return Np(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=$E();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=id(c),f=wu();return await kS(f,o,yI,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const f=this.getPrivateKey(o),y=UE(f,c);return this.setSymKey(y,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||LE(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const f=yp(l),y=on(c);if(Tf(f)){const D=f.senderPublicKey,x=f.receiverPublicKey;o=await this.generateSharedKey(D,x)}const p=this.getSymKey(o),{type:v,senderPublicKey:S}=f;return ME({type:v,symKey:p,message:y,senderPublicKey:S})},this.decode=async(o,c,l)=>{this.isInitialized();const f=zE(c,l);if(Tf(f)){const y=f.receiverPublicKey,p=f.senderPublicKey;o=await this.generateSharedKey(y,p)}try{const y=this.getSymKey(o),p=qE({symKey:y,encoded:c});return $s(p)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const c=Zo(o);return Ts(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Zo(o);return c.senderPublicKey?hr(c.senderPublicKey,ur):void 0},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.keychain=s||new BI(this.core,this.logger)}get context(){return Je.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(_d)}catch{e=wu(),await this.keychain.set(_d,e)}return lI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class VI extends DS{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=mI,this.version=bI,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Un(o);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(s,l),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),l=Un(o);return typeof c[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Je.generateChildLogger(e,this.name),this.core=t}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,vp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_p(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class kI extends SS{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new qr.EventEmitter,this.name=EI,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||wI,y=Eu(c),p=(c==null?void 0:c.prompt)||!1,v=(c==null?void 0:c.tag)||0,S=(c==null?void 0:c.id)||qp().toString(),D={topic:s,message:o,opts:{ttl:f,relay:y,prompt:p,tag:v,id:S}},x=setTimeout(()=>this.queue.set(S,D),this.publishTimeout);try{await await Is(this.rpcPublish(s,o,f,y,p,v,S),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(S),this.relayer.events.emit(er.publish,D)}catch(O){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(S),O;return}finally{clearTimeout(x)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Je.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,l,f){var y,p,v,S;const D={method:Go(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:l},id:f};return cr((y=D.params)==null?void 0:y.prompt)&&((p=D.params)==null||delete p.prompt),cr((v=D.params)==null?void 0:v.tag)&&((S=D.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:D}),this.relayer.request(D)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Kn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(er.connection_stalled);return}this.checkQueue()}),this.relayer.on(er.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class GI{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var WI=Object.defineProperty,YI=Object.defineProperties,JI=Object.getOwnPropertyDescriptors,bd=Object.getOwnPropertySymbols,QI=Object.prototype.hasOwnProperty,XI=Object.prototype.propertyIsEnumerable,wd=(i,e,t)=>e in i?WI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,gs=(i,e)=>{for(var t in e||(e={}))QI.call(e,t)&&wd(i,t,e[t]);if(bd)for(var t of bd(e))XI.call(e,t)&&wd(i,t,e[t]);return i},ru=(i,e)=>YI(i,JI(e));class ZI extends OS{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new GI,this.events=new qr.EventEmitter,this.name=TI,this.version=RI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Li,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Eu(o),l={topic:s,relay:c};this.pending.set(s,l);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const l=new ve.Watch;l.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),l.stop(this.pendingSubscriptionWatchLabel),o(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=NI&&(clearInterval(f),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.clientId=""}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=Eu(s);await this.rpcUnsubscribe(e,t,o);const c=Ct("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Go(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Is(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(er.connection_stalled)}return Un(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Go(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Is(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(er.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Go(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,ru(gs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,gs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,gs({},t)),this.topicMap.set(t.topic,e),this.events.emit(kr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(kr.deleted,ru(gs({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(kr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(kr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);ni(t)&&this.onBatchSubscribe(t.map((s,o)=>ru(gs({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Kn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(er.connect,async()=>{await this.onConnect()}),this.relayer.on(er.disconnect,()=>{this.onDisconnect()}),this.events.on(kr.created,async e=>{const t=kr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(kr.deleted,async e=>{const t=kr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var e5=Object.defineProperty,Ed=Object.getOwnPropertySymbols,t5=Object.prototype.hasOwnProperty,r5=Object.prototype.propertyIsEnumerable,Dd=(i,e,t)=>e in i?e5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,i5=(i,e)=>{for(var t in e||(e={}))t5.call(e,t)&&Dd(i,t,e[t]);if(Ed)for(var t of Ed(e))r5.call(e,t)&&Dd(i,t,e[t]);return i};class n5 extends IS{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new qr.EventEmitter,this.name=SI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(er.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(er.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(mi.payload,this.onPayloadHandler),this.provider.on(mi.connect,this.onConnectHandler),this.provider.on(mi.disconnect,this.onDisconnectHandler),this.provider.on(mi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Je.generateChildLogger(e.logger,this.name):Je.pino(Je.getDefaultLoggerOptions({level:e.logger||DI})),this.messages=new VI(this.logger,e.core),this.subscriber=new ZI(this,this.logger),this.publisher=new kI(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||tg,this.projectId=e.projectId,this.bundleId=GE(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${md}...`),await this.restartTransport(md)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},PI)}get context(){return Je.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const l=f=>{f.topic===e&&(this.subscriber.off(kr.created,l),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(kr.created,l)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Is(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(kr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await Is(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(mi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Hf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ei(new $2(ZE({sdkVersion:OI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ih(e)){if(!e.method.endsWith(II))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,l={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(i5({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}else pa(e)&&this.events.emit(er.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(er.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=fa(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(mi.payload,this.onPayloadHandler),this.provider.off(mi.connect,this.onConnectHandler),this.provider.off(mi.disconnect,this.onDisconnectHandler),this.provider.off(mi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(er.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await Hf();V3(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(er.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ve.toMiliseconds(xI)))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var s5=Object.defineProperty,Sd=Object.getOwnPropertySymbols,o5=Object.prototype.hasOwnProperty,a5=Object.prototype.propertyIsEnumerable,Id=(i,e,t)=>e in i?s5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,xd=(i,e)=>{for(var t in e||(e={}))o5.call(e,t)&&Id(i,t,e[t]);if(Sd)for(var t of Sd(e))a5.call(e,t)&&Id(i,t,e[t]);return i};class ya extends xS{constructor(e,t,s,o=Li,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=CI,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!cr(l)?this.map.set(this.getKey(l),l):E3(l)?this.map.set(l.id,l):D3(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,f)=>{this.isInitialized(),this.map.has(l)?await this.update(l,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:f}),this.map.set(l,f),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(f=>Object.keys(l).every(y=>L2(f[y],l[y]))):this.values),this.update=async(l,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:f});const y=xd(xd({},this.getData(l)),f);this.map.set(l,y),await this.persist()},this.delete=async(l,f)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:f}),this.map.delete(l),await this.persist())},this.logger=Je.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class c5{constructor(e,t){this.core=e,this.logger=t,this.name=$I,this.version=UI,this.events=new zu,this.initialized=!1,this.storagePrefix=Li,this.ignoredPayloadTypes=[cn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=wu(),o=await this.core.crypto.setSymKey(s),c=Gr(ve.FIVE_MINUTES),l={protocol:eg},f={topic:o,expiry:c,relay:l,active:!1},y=f3({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:l}=jf(s.uri);let f;if(this.pairings.keys.includes(o)&&(f=this.pairings.get(o),f.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const y=Gr(ve.FIVE_MINUTES),p={topic:o,relay:l,expiry:y,active:!1};return await this.pairings.set(o,p),this.core.expirer.set(o,y),s.activatePairing&&await this.activate({topic:o}),this.events.emit(bs.create,p),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l})),p},this.activate=async({topic:s})=>{this.isInitialized();const o=Gr(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:f,reject:y}=Nn();this.events.once(zt("pairing_ping",c),({error:p})=>{p?y(p):f()}),await l()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Ct("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const l=jn(o,c),f=await this.core.crypto.encode(s,l),y=ps[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,f,y),l.id},this.sendResult=async(s,o,c)=>{const l=fa(s,c),f=await this.core.crypto.encode(o,l),y=await this.core.history.get(o,s),p=ps[y.request.method].res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.sendError=async(s,o,c)=>{const l=da(s,c),f=await this.core.crypto.encode(o,l),y=await this.core.history.get(o,s),p=ps[y.request.method]?ps[y.request.method].res:ps.unregistered_method.res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Ct("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ui(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,l=(await this.core.history.get(o,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(bs.ping,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{wi(o)?this.events.emit(zt("pairing_ping",c),{}):Wr(o)&&this.events.emit(zt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(bs.delete,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const f=Ct("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Ct("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!mr(s)){const{message:l}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(l)}if(!w3(s.uri)){const{message:l}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(l)}const c=jf(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:l}=ue("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(c!=null&&c.symKey)){const{message:l}=ue("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}},this.isValidPing=async s=>{if(!mr(s)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!mr(s)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Gt(s,!1)){const{message:o}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ui(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.pairings=new ya(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Je.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(er.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{ih(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):pa(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Mr.expired,async e=>{const{topic:t}=bp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(bs.expire,{topic:t}))})}}class u5 extends ES{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new qr.EventEmitter,this.name=LI,this.version=jI,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Gr(ve.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(ii.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Wr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ii.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ii.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:jn(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ii.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ii.created,e=>{const t=ii.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ii.updated,e=>{const t=ii.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ii.deleted,e=>{const t=ii.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Kn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ve.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class h5 extends PS{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new qr.EventEmitter,this.name=MI,this.version=qI,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Mr.created,{target:c,expiration:l})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Mr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return e3(e);if(typeof e=="number")return t3(e);const{message:t}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Mr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Mr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Kn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Mr.created,e=>{const t=Mr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Mr.expired,e=>{const t=Mr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Mr.deleted,e=>{const t=Mr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class l5 extends CS{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=tu,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||zn()||!Hn())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Uu;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(l){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(l),c=await this.fetchAttestation(s.attestationId,Uu)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),l=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(tu))return c();window.addEventListener("message",o);const l=document.createElement("iframe");l.id=tu,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,s=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",o),l("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||$n;return FI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${$n}`),o=$n),o},this.logger=Je.generateChildLogger(t,this.name),this.verifyUrl=$n,this.abortController=new AbortController,this.isDevEnv=Qu()&&z2.IS_VITEST}get context(){return Je.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(e))}}class f5 extends AS{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=zI,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:l,enableEncrypted:f=!1}=s,y=`${HI}/${this.projectId}/clients`;await F2(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:l,token:c,always_raw:f})})},this.logger=Je.generateChildLogger(t,this.context)}}var d5=Object.defineProperty,Od=Object.getOwnPropertySymbols,p5=Object.prototype.hasOwnProperty,g5=Object.prototype.propertyIsEnumerable,Pd=(i,e,t)=>e in i?d5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Cd=(i,e)=>{for(var t in e||(e={}))p5.call(e,t)&&Pd(i,t,e[t]);if(Od)for(var t of Od(e))g5.call(e,t)&&Pd(i,t,e[t]);return i};class sh extends wS{constructor(e){super(e),this.protocol=Zp,this.version=fI,this.name=nh,this.events=new qr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||tg,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||dI.logger}));this.logger=Je.generateChildLogger(t,this.name),this.heartbeat=new Kn.HeartBeat,this.crypto=new KI(this,this.logger,e==null?void 0:e.keychain),this.history=new u5(this,this.logger),this.expirer=new h5(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new ID(Cd(Cd({},pI),e==null?void 0:e.storageOptions)),this.relayer=new n5({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new c5(this,this.logger),this.verify=new l5(this.projectId||"",this.logger),this.echoClient=new f5(this.projectId||"",this.logger)}static async init(e){const t=new sh(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(AI,s),t}get context(){return Je.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const y5=sh,rg="wc",ig=2,ng="client",oh=`${rg}@${ig}:${ng}:`,iu={name:ng,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ad="WALLETCONNECT_DEEPLINK_CHOICE",v5="proposal",sg="Proposal expired",_5="session",Ko=ve.SEVEN_DAYS,m5="engine",ys={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},nu={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},bi={idle:"IDLE",active:"ACTIVE"},b5="request",w5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var E5=Object.defineProperty,D5=Object.defineProperties,S5=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,I5=Object.prototype.hasOwnProperty,x5=Object.prototype.propertyIsEnumerable,Rd=(i,e,t)=>e in i?E5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,vr=(i,e)=>{for(var t in e||(e={}))I5.call(e,t)&&Rd(i,t,e[t]);if(Td)for(var t of Td(e))x5.call(e,t)&&Rd(i,t,e[t]);return i},vs=(i,e)=>D5(i,S5(e));class O5 extends RS{constructor(e){super(e),this.name=m5,this.events=new zu,this.initialized=!1,this.ignoredPayloadTypes=[cn],this.requestQueue={state:bi.idle,queue:[]},this.sessionRequestQueue={state:bi.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(ys)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=vs(vr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:f,relays:y}=s;let p=o,v,S=!1;if(p&&(S=this.client.core.pairing.pairings.get(p).active),!p||!S){const{topic:L,uri:P}=await this.client.core.pairing.create();p=L,v=P}const D=await this.client.core.crypto.generateKeyPair(),x=vr({requiredNamespaces:c,optionalNamespaces:l,relays:y??[{protocol:eg}],proposer:{publicKey:D,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:O,resolve:z,done:B}=Nn(ve.FIVE_MINUTES,sg);if(this.events.once(zt("session_connect"),async({error:L,session:P})=>{if(L)O(L);else if(P){P.self.publicKey=D;const R=vs(vr({},P),{requiredNamespaces:P.requiredNamespaces,optionalNamespaces:P.optionalNamespaces});await this.client.session.set(P.topic,R),await this.setExpiry(P.topic,P.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:P.peer.metadata}),z(R)}}),!p){const{message:L}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(L)}const ne=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:x}),$=Gr(ve.FIVE_MINUTES);return await this.setProposal(ne,vr({id:ne,expiry:$},x)),{uri:v,approval:B}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:l}=t,f=this.client.proposal.get(s);let{pairingTopic:y,proposer:p,requiredNamespaces:v,optionalNamespaces:S}=f;y=y||"",Ln(v)||(v=y3(c,"approve()"));const D=await this.client.core.crypto.generateKeyPair(),x=p.publicKey,O=await this.client.core.crypto.generateSharedKey(D,x);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:p.metadata}),await this.sendResult({id:s,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:D}}),await this.client.proposal.delete(s,Ct("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const z=vr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:v,optionalNamespaces:S,pairingTopic:y,controller:{publicKey:D,metadata:this.client.metadata},expiry:Gr(Ko)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(O),await this.sendRequest({topic:O,method:"wc_sessionSettle",params:z,throwOnFailedPublish:!0});const B=vs(vr({},z),{topic:O,pairingTopic:y,acknowledged:!1,self:z.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:D});return await this.client.session.set(O,B),await this.setExpiry(O,Gr(Ko)),{topic:O,acknowledged:()=>new Promise(ne=>setTimeout(()=>ne(this.client.session.get(O)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,Ct("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:f,reject:y}=Nn();return this.events.once(zt("session_update",c),({error:p})=>{p?y(p):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:f}=Nn();return this.events.once(zt("session_extend",o),({error:y})=>{y?f(y):l()}),await this.setExpiry(s,Gr(Ko)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:l}=t,f=rh(),{done:y,resolve:p,reject:v}=Nn(l,"Request expired. Please try again.");return this.events.once(zt("session_request",f),({error:S,result:D})=>{S?v(S):p(D)}),await Promise.all([new Promise(async S=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:l,throwOnFailedPublish:!0}).catch(D=>v(D)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),S()}),new Promise(async S=>{const D=await i3(this.client.core.storage,Ad);r3({id:f,topic:c,wcDeepLink:D}),S()}),y()]).then(S=>S[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;wi(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Wr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:f}=Nn();this.events.once(zt("session_ping",o),({error:y})=>{y?f(y):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Ct("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>m3(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,f;return((l=c.peerMetadata)==null?void 0:l.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,Ct("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t),this.client.core.storage.removeItem(Ad).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===t&&this.deletePendingSessionRequest(c.id,Ct("USER_DISCONNECTED"))})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,Ct("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=bi.idle)},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=ys.wc_sessionRequest.req.ttl,{id:o,topic:c,params:l,verifyContext:f}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:l,verifyContext:f}),s&&this.client.core.expirer.set(o,Gr(s))},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:l,relayRpcId:f,clientRpcId:y,throwOnFailedPublish:p}=t,v=jn(o,c,y);if(Hn()&&w5.includes(o)){const x=Un(JSON.stringify(v));this.client.core.verify.register({attestationId:x})}const S=await this.client.core.crypto.encode(s,v),D=ys[o].req;return l&&(D.ttl=l),f&&(D.id=f),this.client.core.history.set(s,v),p?(D.internal=vs(vr({},D.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,S,D)):this.client.core.relayer.publish(s,S,D).catch(x=>this.client.logger.error(x)),v.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:l}=t,f=fa(s,c),y=await this.client.core.crypto.encode(o,f),p=await this.client.core.history.get(o,s),v=ys[p.request.method].res;l?(v.internal=vs(vr({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,y,v)):this.client.core.relayer.publish(o,y,v).catch(S=>this.client.logger.error(S)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=da(t,o),l=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),y=ys[f.request.method].res;this.client.core.relayer.publish(s,l,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{Ui(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ui(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===bi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=bi.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=bi.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(vr({},s.params));const l=Gr(ve.FIVE_MINUTES),f=vr({id:c,pairingTopic:t,expiry:l},o);await this.setProposal(c,f);const y=Un(JSON.stringify(s)),p=await this.getVerifyContext(y,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:p})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(wi(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const f=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const p=await this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const v=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:v}),await this.client.core.pairing.activate({topic:t})}else Wr(s)&&(await this.client.proposal.delete(o,Ct("USER_DISCONNECTED")),this.events.emit(zt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:f,expiry:y,namespaces:p,requiredNamespaces:v,optionalNamespaces:S,sessionProperties:D,pairingTopic:x}=s.params,O=vr({topic:t,relay:l,expiry:y,namespaces:p,acknowledged:!0,pairingTopic:x,requiredNamespaces:v,optionalNamespaces:S,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},D&&{sessionProperties:D});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(zt("session_connect"),{session:O}),this.cleanupDuplicatePairings(O)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;wi(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(zt("session_approve",o),{})):Wr(s)&&(await this.client.session.delete(t,Ct("USER_DISCONNECTED")),this.events.emit(zt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const l=`${t}_session_update`,f=zo.get(l);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(vr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),zo.set(l,c)}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;wi(s)?this.events.emit(zt("session_update",o),{}):Wr(s)&&this.events.emit(zt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Gr(Ko)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;wi(s)?this.events.emit(zt("session_extend",o),{}):Wr(s)&&this.events.emit(zt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{wi(s)?this.events.emit(zt("session_ping",o),{}):Wr(s)&&this.events.emit(zt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(er.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult({id:o,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(vr({topic:t},c));const l=Un(JSON.stringify(jn("wc_sessionRequest",c,o))),f=this.client.session.get(t),y=await this.getVerifyContext(l,f.peer.metadata),p={id:o,topic:t,params:c,verifyContext:y};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;wi(s)?this.events.emit(zt("session_request",o),{result:s.result}):Wr(s)&&this.events.emit(zt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const l=`${t}_session_event_${c.event.name}`,f=zo.get(l);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(vr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),zo.set(l,o)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=bi.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===bi.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=bi.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,jn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!mr(t)){const{message:y}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:f}=t;if(cr(s)||await this.isValidPairingTopic(s),!T3(f,!0)){const{message:y}=ue("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(y)}!cr(o)&&Ln(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!cr(c)&&Ln(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),cr(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=A3(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!mr(t))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),y=Wo(o,"approve()");if(y)throw new Error(y.message);const p=Ff(f.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Gt(c,!0)){const{message:v}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(v)}cr(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!mr(t)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!N3(o)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!mr(t)){const{message:p}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:c,expiry:l}=t;if(!Ep(s)){const{message:p}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const f=S3(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const y=Wo(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(Ui(l)){const{message:p}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!mr(t)){const{message:y}=ue("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(y)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),l=Wo(o,"update()");if(l)throw new Error(l.message);const f=Ff(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!mr(t)){const{message:o}=ue("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!mr(t)){const{message:y}=ue("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(y)}const{topic:s,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!qf(f,c)){const{message:y}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!$3(o)){const{message:y}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!j3(f,c,o.method)){const{message:y}=ue("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(l&&!z3(l,nu)){const{message:y}=ue("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${nu.min} and ${nu.max}`);throw new Error(y)}},this.isValidRespond=async t=>{var s;if(!mr(t)){const{message:l}=ue("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(l)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(l){throw(s=t==null?void 0:t.response)!=null&&s.id&&this.cleanupAfterResponse(t),l}if(!U3(c)){const{message:l}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(l)}},this.isValidPing=async t=>{if(!mr(t)){const{message:o}=ue("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!mr(t)){const{message:f}=ue("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!qf(l,c)){const{message:f}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!L3(o)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!M3(l,c,o.name)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!mr(t)){const{message:o}=ue("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||$n,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Gt(o,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(er.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{ih(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):pa(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Mr.expired,async e=>{const{topic:t,id:s}=bp(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(bs.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Gt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ui(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Gt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ui(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=ue("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Gt(e,!1)){const{message:t}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!R3(e)){const{message:t}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ui(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class P5 extends ya{constructor(e,t){super(e,t,v5,oh),this.core=e,this.logger=t}}class C5 extends ya{constructor(e,t){super(e,t,_5,oh),this.core=e,this.logger=t}}class A5 extends ya{constructor(e,t){super(e,t,b5,oh,s=>s.id),this.core=e,this.logger=t}}let T5=class og extends TS{constructor(e){super(e),this.protocol=rg,this.version=ig,this.name=iu.name,this.events=new qr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||iu.name,this.metadata=(e==null?void 0:e.metadata)||YE();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||iu.logger}));this.core=(e==null?void 0:e.core)||new y5(e),this.logger=Je.generateChildLogger(t,this.name),this.session=new C5(this.core,this.logger),this.proposal=new P5(this.core,this.logger),this.pendingRequest=new A5(this.core,this.logger),this.engine=new O5(this)}static async init(e){const t=new og(e);return await t.initialize(),t}get context(){return Je.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Lu={exports:{}};(function(i,e){var t=typeof self<"u"?self:Yr,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(l){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function y(w){return w&&DataView.prototype.isPrototypeOf(w)}if(f.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(w){return w&&p.indexOf(Object.prototype.toString.call(w))>-1};function S(w){if(typeof w!="string"&&(w=String(w)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(w))throw new TypeError("Invalid character in header field name");return w.toLowerCase()}function D(w){return typeof w!="string"&&(w=String(w)),w}function x(w){var A={next:function(){var ee=w.shift();return{done:ee===void 0,value:ee}}};return f.iterable&&(A[Symbol.iterator]=function(){return A}),A}function O(w){this.map={},w instanceof O?w.forEach(function(A,ee){this.append(ee,A)},this):Array.isArray(w)?w.forEach(function(A){this.append(A[0],A[1])},this):w&&Object.getOwnPropertyNames(w).forEach(function(A){this.append(A,w[A])},this)}O.prototype.append=function(w,A){w=S(w),A=D(A);var ee=this.map[w];this.map[w]=ee?ee+", "+A:A},O.prototype.delete=function(w){delete this.map[S(w)]},O.prototype.get=function(w){return w=S(w),this.has(w)?this.map[w]:null},O.prototype.has=function(w){return this.map.hasOwnProperty(S(w))},O.prototype.set=function(w,A){this.map[S(w)]=D(A)},O.prototype.forEach=function(w,A){for(var ee in this.map)this.map.hasOwnProperty(ee)&&w.call(A,this.map[ee],ee,this)},O.prototype.keys=function(){var w=[];return this.forEach(function(A,ee){w.push(ee)}),x(w)},O.prototype.values=function(){var w=[];return this.forEach(function(A){w.push(A)}),x(w)},O.prototype.entries=function(){var w=[];return this.forEach(function(A,ee){w.push([ee,A])}),x(w)},f.iterable&&(O.prototype[Symbol.iterator]=O.prototype.entries);function z(w){if(w.bodyUsed)return Promise.reject(new TypeError("Already read"));w.bodyUsed=!0}function B(w){return new Promise(function(A,ee){w.onload=function(){A(w.result)},w.onerror=function(){ee(w.error)}})}function ne(w){var A=new FileReader,ee=B(A);return A.readAsArrayBuffer(w),ee}function $(w){var A=new FileReader,ee=B(A);return A.readAsText(w),ee}function L(w){for(var A=new Uint8Array(w),ee=new Array(A.length),Q=0;Q<A.length;Q++)ee[Q]=String.fromCharCode(A[Q]);return ee.join("")}function P(w){if(w.slice)return w.slice(0);var A=new Uint8Array(w.byteLength);return A.set(new Uint8Array(w)),A.buffer}function R(){return this.bodyUsed=!1,this._initBody=function(w){this._bodyInit=w,w?typeof w=="string"?this._bodyText=w:f.blob&&Blob.prototype.isPrototypeOf(w)?this._bodyBlob=w:f.formData&&FormData.prototype.isPrototypeOf(w)?this._bodyFormData=w:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)?this._bodyText=w.toString():f.arrayBuffer&&f.blob&&y(w)?(this._bodyArrayBuffer=P(w.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(w)||v(w))?this._bodyArrayBuffer=P(w):this._bodyText=w=Object.prototype.toString.call(w):this._bodyText="",this.headers.get("content-type")||(typeof w=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var w=z(this);if(w)return w;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?z(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ne)}),this.text=function(){var w=z(this);if(w)return w;if(this._bodyBlob)return $(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(G)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function u(w){var A=w.toUpperCase();return E.indexOf(A)>-1?A:w}function b(w,A){A=A||{};var ee=A.body;if(w instanceof b){if(w.bodyUsed)throw new TypeError("Already read");this.url=w.url,this.credentials=w.credentials,A.headers||(this.headers=new O(w.headers)),this.method=w.method,this.mode=w.mode,this.signal=w.signal,!ee&&w._bodyInit!=null&&(ee=w._bodyInit,w.bodyUsed=!0)}else this.url=String(w);if(this.credentials=A.credentials||this.credentials||"same-origin",(A.headers||!this.headers)&&(this.headers=new O(A.headers)),this.method=u(A.method||this.method||"GET"),this.mode=A.mode||this.mode||null,this.signal=A.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})};function G(w){var A=new FormData;return w.trim().split("&").forEach(function(ee){if(ee){var Q=ee.split("="),V=Q.shift().replace(/\+/g," "),k=Q.join("=").replace(/\+/g," ");A.append(decodeURIComponent(V),decodeURIComponent(k))}}),A}function W(w){var A=new O,ee=w.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(Q){var V=Q.split(":"),k=V.shift().trim();if(k){var J=V.join(":").trim();A.append(k,J)}}),A}R.call(b.prototype);function se(w,A){A||(A={}),this.type="default",this.status=A.status===void 0?200:A.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in A?A.statusText:"OK",this.headers=new O(A.headers),this.url=A.url||"",this._initBody(w)}R.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},se.error=function(){var w=new se(null,{status:0,statusText:""});return w.type="error",w};var ce=[301,302,303,307,308];se.redirect=function(w,A){if(ce.indexOf(A)===-1)throw new RangeError("Invalid status code");return new se(null,{status:A,headers:{location:w}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(A,ee){this.message=A,this.name=ee;var Q=Error(A);this.stack=Q.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function de(w,A){return new Promise(function(ee,Q){var V=new b(w,A);if(V.signal&&V.signal.aborted)return Q(new l.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function J(){k.abort()}k.onload=function(){var re={status:k.status,statusText:k.statusText,headers:W(k.getAllResponseHeaders()||"")};re.url="responseURL"in k?k.responseURL:re.headers.get("X-Request-URL");var be="response"in k?k.response:k.responseText;ee(new se(be,re))},k.onerror=function(){Q(new TypeError("Network request failed"))},k.ontimeout=function(){Q(new TypeError("Network request failed"))},k.onabort=function(){Q(new l.DOMException("Aborted","AbortError"))},k.open(V.method,V.url,!0),V.credentials==="include"?k.withCredentials=!0:V.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&f.blob&&(k.responseType="blob"),V.headers.forEach(function(re,be){k.setRequestHeader(be,re)}),V.signal&&(V.signal.addEventListener("abort",J),k.onreadystatechange=function(){k.readyState===4&&V.signal.removeEventListener("abort",J)}),k.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return de.polyfill=!0,c.fetch||(c.fetch=de,c.Headers=O,c.Request=b,c.Response=se),l.Headers=O,l.Request=b,l.Response=se,l.fetch=de,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,i.exports=e})(Lu,Lu.exports);var R5=Lu.exports;const Nd=Fu(R5),N5={Accept:"application/json","Content-Type":"application/json"},$5="POST",$d={headers:N5,method:$5},Ud=10;class qi{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new qr.EventEmitter,this.isAvailable=!1,this.registering=!1,!ad(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=on(e),c=await(await Nd(this.url,Object.assign(Object.assign({},$d),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!ad(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=on({id:1,jsonrpc:"2.0",method:"test",params:[]});await Nd(e,Object.assign(Object.assign({},$d),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?$s(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=da(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Lp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Ud&&this.events.setMaxListeners(Ud)}}const Ld="error",U5="wss://relay.walletconnect.com",L5="wc",j5="universal_provider",jd=`${L5}@2:${j5}:`,M5="https://rpc.walletconnect.com/v1/",Di={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var _s=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ju={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",p=500,v="__lodash_placeholder__",S=1,D=2,x=4,O=1,z=2,B=1,ne=2,$=4,L=8,P=16,R=32,E=64,u=128,b=256,G=512,W=30,se="...",ce=800,de=16,w=1,A=2,ee=3,Q=1/0,V=9007199254740991,k=17976931348623157e292,J=NaN,re=4294967295,be=re-1,oe=re>>>1,we=[["ary",u],["bind",B],["bindKey",ne],["curry",L],["curryRight",P],["flip",G],["partial",R],["partialRight",E],["rearg",b]],le="[object Arguments]",_e="[object Array]",H="[object AsyncFunction]",F="[object Boolean]",U="[object Date]",d="[object DOMException]",T="[object Error]",ae="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",He="[object Number]",Ve="[object Null]",je="[object Object]",pt="[object Promise]",gt="[object Proxy]",qe="[object RegExp]",xe="[object Set]",Ne="[object String]",$e="[object Symbol]",Fe="[object Undefined]",Pe="[object WeakMap]",Ue="[object WeakSet]",Se="[object ArrayBuffer]",Ce="[object DataView]",Be="[object Float32Array]",Oe="[object Float64Array]",ke="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Qe="[object Uint8ClampedArray]",tr="[object Uint16Array]",lr="[object Uint32Array]",Jr=/\b__p \+= '';/g,rr=/\b(__p \+=) '' \+/g,si=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Si=/&(?:amp|lt|gt|quot|#39);/g,Fi=/[&<>"']/g,Et=RegExp(Si.source),yt=RegExp(Fi.source),Dt=/<%-([\s\S]+?)%>/g,St=/<%([\s\S]+?)%>/g,bt=/<%=([\s\S]+?)%>/g,vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$t=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,Lt=RegExp(It.source),xt=/^\s+/,At=/\s/,Ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,jt=/,? & /,Mt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,va=/[()=,{}\[\]\/\s]/,_a=/\\(\\)?/g,ma=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Cr=/\w*$/,ba=/^[-+]0x[0-9a-f]+$/i,wa=/^0b[01]+$/i,Ea=/^\[object .+?Constructor\]$/,Da=/^0o[0-7]+$/i,Sa=/^(?:0|[1-9]\d*)$/,oi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,fn=/($^)/,Ia=/['\n\r\u2028\u2029\\]/g,dn="\\ud800-\\udfff",xa="\\u0300-\\u036f",Oa="\\ufe20-\\ufe2f",pn="\\u20d0-\\u20ff",Ls=xa+Oa+pn,js="\\u2700-\\u27bf",Fr="a-z\\xdf-\\xf6\\xf8-\\xff",Pa="\\xac\\xb1\\xd7\\xf7",Ca="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Aa="\\u2000-\\u206f",Ta=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ms="A-Z\\xc0-\\xd6\\xd8-\\xde",qs="\\ufe0e\\ufe0f",zi=Pa+Ca+Aa+Ta,Vn="['â€™]",Hi="["+dn+"]",kn="["+zi+"]",Bi="["+Ls+"]",Fs="\\d+",Ra="["+js+"]",zs="["+Fr+"]",Hs="[^"+dn+zi+Fs+js+Fr+Ms+"]",gn="\\ud83c[\\udffb-\\udfff]",Na="(?:"+Bi+"|"+gn+")",Bs="[^"+dn+"]",yn="(?:\\ud83c[\\udde6-\\uddff]){2}",Ii="[\\ud800-\\udbff][\\udc00-\\udfff]",wr="["+Ms+"]",Ks="\\u200d",Vs="(?:"+zs+"|"+Hs+")",Qr="(?:"+wr+"|"+Hs+")",ks="(?:"+Vn+"(?:d|ll|m|re|s|t|ve))?",Gs="(?:"+Vn+"(?:D|LL|M|RE|S|T|VE))?",Ws=Na+"?",Ys="["+qs+"]?",$a="(?:"+Ks+"(?:"+[Bs,yn,Ii].join("|")+")"+Ys+Ws+")*",ai="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Js="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Qs=Ys+Ws+$a,vn="(?:"+[Ra,yn,Ii].join("|")+")"+Qs,Ua="(?:"+[Bs+Bi+"?",Bi,yn,Ii,Hi].join("|")+")",Gn=RegExp(Vn,"g"),La=RegExp(Bi,"g"),_n=RegExp(gn+"(?="+gn+")|"+Ua+Qs,"g"),Xs=RegExp([wr+"?"+zs+"+"+ks+"(?="+[kn,wr,"$"].join("|")+")",Qr+"+"+Gs+"(?="+[kn,wr+Vs,"$"].join("|")+")",wr+"?"+Vs+"+"+ks,wr+"+"+Gs,Js,ai,Fs,vn].join("|"),"g"),Zs=RegExp("["+Ks+dn+Ls+qs+"]"),Ki=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ja=-1,ot={};ot[Be]=ot[Oe]=ot[ke]=ot[We]=ot[et]=ot[tt]=ot[Qe]=ot[tr]=ot[lr]=!0,ot[le]=ot[_e]=ot[Se]=ot[F]=ot[Ce]=ot[U]=ot[T]=ot[ae]=ot[Ie]=ot[He]=ot[je]=ot[qe]=ot[xe]=ot[Ne]=ot[Pe]=!1;var st={};st[le]=st[_e]=st[Se]=st[Ce]=st[F]=st[U]=st[Be]=st[Oe]=st[ke]=st[We]=st[et]=st[Ie]=st[He]=st[je]=st[qe]=st[xe]=st[Ne]=st[$e]=st[tt]=st[Qe]=st[tr]=st[lr]=!0,st[T]=st[ae]=st[Pe]=!1;var I={Ã€:"A",Ã:"A",Ã‚:"A",Ãƒ:"A",Ã„:"A",Ã…:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã‡:"C",Ã§:"c",Ã:"D",Ã°:"d",Ãˆ:"E",Ã‰:"E",ÃŠ:"E",Ã‹:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",ÃŒ:"I",Ã:"I",ÃŽ:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã‘:"N",Ã±:"n",Ã’:"O",Ã“:"O",Ã”:"O",Ã•:"O",Ã–:"O",Ã˜:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã™:"U",Ãš:"U",Ã›:"U",Ãœ:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã†:"Ae",Ã¦:"ae",Ãž:"Th",Ã¾:"th",ÃŸ:"ss",Ä€:"A",Ä‚:"A",Ä„:"A",Ä:"a",Äƒ:"a",Ä…:"a",Ä†:"C",Äˆ:"C",ÄŠ:"C",ÄŒ:"C",Ä‡:"c",Ä‰:"c",Ä‹:"c",Ä:"c",ÄŽ:"D",Ä:"D",Ä:"d",Ä‘:"d",Ä’:"E",Ä”:"E",Ä–:"E",Ä˜:"E",Äš:"E",Ä“:"e",Ä•:"e",Ä—:"e",Ä™:"e",Ä›:"e",Äœ:"G",Äž:"G",Ä :"G",Ä¢:"G",Ä:"g",ÄŸ:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å€:"l",Å‚:"l",Åƒ:"N",Å…:"N",Å‡:"N",ÅŠ:"N",Å„:"n",Å†:"n",Åˆ:"n",Å‹:"n",ÅŒ:"O",ÅŽ:"O",Å:"O",Å:"o",Å:"o",Å‘:"o",Å”:"R",Å–:"R",Å˜:"R",Å•:"r",Å—:"r",Å™:"r",Åš:"S",Åœ:"S",Åž:"S",Å :"S",Å›:"s",Å:"s",ÅŸ:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å’:"Oe",Å“:"oe",Å‰:"'n",Å¿:"s"},j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Te=parseInt,ft=typeof _s=="object"&&_s&&_s.Object===Object&&_s,qt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||qt||Function("return this")(),ct=e&&!e.nodeType&&e,Tt=ct&&!0&&i&&!i.nodeType&&i,fr=Tt&&Tt.exports===ct,Ft=fr&&ft.process,dt=function(){try{var M=Tt&&Tt.require&&Tt.require("util").types;return M||Ft&&Ft.binding&&Ft.binding("util")}catch{}}(),ir=dt&&dt.isArrayBuffer,zr=dt&&dt.isDate,Ar=dt&&dt.isMap,Xr=dt&&dt.isRegExp,Wn=dt&&dt.isSet,Vi=dt&&dt.isTypedArray;function Kt(M,Y,K){switch(K.length){case 0:return M.call(Y);case 1:return M.call(Y,K[0]);case 2:return M.call(Y,K[0],K[1]);case 3:return M.call(Y,K[0],K[1],K[2])}return M.apply(Y,K)}function ug(M,Y,K,ge){for(var Ae=-1,rt=M==null?0:M.length;++Ae<rt;){var Ht=M[Ae];Y(ge,Ht,K(Ht),M)}return ge}function Tr(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge&&Y(M[K],K,M)!==!1;);return M}function hg(M,Y){for(var K=M==null?0:M.length;K--&&Y(M[K],K,M)!==!1;);return M}function uh(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge;)if(!Y(M[K],K,M))return!1;return!0}function xi(M,Y){for(var K=-1,ge=M==null?0:M.length,Ae=0,rt=[];++K<ge;){var Ht=M[K];Y(Ht,K,M)&&(rt[Ae++]=Ht)}return rt}function to(M,Y){var K=M==null?0:M.length;return!!K&&mn(M,Y,0)>-1}function Ma(M,Y,K){for(var ge=-1,Ae=M==null?0:M.length;++ge<Ae;)if(K(Y,M[ge]))return!0;return!1}function _t(M,Y){for(var K=-1,ge=M==null?0:M.length,Ae=Array(ge);++K<ge;)Ae[K]=Y(M[K],K,M);return Ae}function Oi(M,Y){for(var K=-1,ge=Y.length,Ae=M.length;++K<ge;)M[Ae+K]=Y[K];return M}function qa(M,Y,K,ge){var Ae=-1,rt=M==null?0:M.length;for(ge&&rt&&(K=M[++Ae]);++Ae<rt;)K=Y(K,M[Ae],Ae,M);return K}function lg(M,Y,K,ge){var Ae=M==null?0:M.length;for(ge&&Ae&&(K=M[--Ae]);Ae--;)K=Y(K,M[Ae],Ae,M);return K}function Fa(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge;)if(Y(M[K],K,M))return!0;return!1}var fg=za("length");function dg(M){return M.split("")}function pg(M){return M.match(Mt)||[]}function hh(M,Y,K){var ge;return K(M,function(Ae,rt,Ht){if(Y(Ae,rt,Ht))return ge=rt,!1}),ge}function ro(M,Y,K,ge){for(var Ae=M.length,rt=K+(ge?1:-1);ge?rt--:++rt<Ae;)if(Y(M[rt],rt,M))return rt;return-1}function mn(M,Y,K){return Y===Y?xg(M,Y,K):ro(M,lh,K)}function gg(M,Y,K,ge){for(var Ae=K-1,rt=M.length;++Ae<rt;)if(ge(M[Ae],Y))return Ae;return-1}function lh(M){return M!==M}function fh(M,Y){var K=M==null?0:M.length;return K?Ba(M,Y)/K:J}function za(M){return function(Y){return Y==null?t:Y[M]}}function Ha(M){return function(Y){return M==null?t:M[Y]}}function dh(M,Y,K,ge,Ae){return Ae(M,function(rt,Ht,ut){K=ge?(ge=!1,rt):Y(K,rt,Ht,ut)}),K}function yg(M,Y){var K=M.length;for(M.sort(Y);K--;)M[K]=M[K].value;return M}function Ba(M,Y){for(var K,ge=-1,Ae=M.length;++ge<Ae;){var rt=Y(M[ge]);rt!==t&&(K=K===t?rt:K+rt)}return K}function Ka(M,Y){for(var K=-1,ge=Array(M);++K<M;)ge[K]=Y(K);return ge}function vg(M,Y){return _t(Y,function(K){return[K,M[K]]})}function ph(M){return M&&M.slice(0,_h(M)+1).replace(xt,"")}function Er(M){return function(Y){return M(Y)}}function Va(M,Y){return _t(Y,function(K){return M[K]})}function Yn(M,Y){return M.has(Y)}function gh(M,Y){for(var K=-1,ge=M.length;++K<ge&&mn(Y,M[K],0)>-1;);return K}function yh(M,Y){for(var K=M.length;K--&&mn(Y,M[K],0)>-1;);return K}function _g(M,Y){for(var K=M.length,ge=0;K--;)M[K]===Y&&++ge;return ge}var mg=Ha(I),bg=Ha(j);function wg(M){return"\\"+pe[M]}function Eg(M,Y){return M==null?t:M[Y]}function bn(M){return Zs.test(M)}function Dg(M){return Ki.test(M)}function Sg(M){for(var Y,K=[];!(Y=M.next()).done;)K.push(Y.value);return K}function ka(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge,Ae){K[++Y]=[Ae,ge]}),K}function vh(M,Y){return function(K){return M(Y(K))}}function Pi(M,Y){for(var K=-1,ge=M.length,Ae=0,rt=[];++K<ge;){var Ht=M[K];(Ht===Y||Ht===v)&&(M[K]=v,rt[Ae++]=K)}return rt}function io(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge){K[++Y]=ge}),K}function Ig(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge){K[++Y]=[ge,ge]}),K}function xg(M,Y,K){for(var ge=K-1,Ae=M.length;++ge<Ae;)if(M[ge]===Y)return ge;return-1}function Og(M,Y,K){for(var ge=K+1;ge--;)if(M[ge]===Y)return ge;return ge}function wn(M){return bn(M)?Cg(M):fg(M)}function Hr(M){return bn(M)?Ag(M):dg(M)}function _h(M){for(var Y=M.length;Y--&&At.test(M.charAt(Y)););return Y}var Pg=Ha(te);function Cg(M){for(var Y=_n.lastIndex=0;_n.test(M);)++Y;return Y}function Ag(M){return M.match(_n)||[]}function Tg(M){return M.match(Xs)||[]}var Rg=function M(Y){Y=Y==null?Xe:En.defaults(Xe.Object(),Y,En.pick(Xe,eo));var K=Y.Array,ge=Y.Date,Ae=Y.Error,rt=Y.Function,Ht=Y.Math,ut=Y.Object,Ga=Y.RegExp,Ng=Y.String,Rr=Y.TypeError,no=K.prototype,$g=rt.prototype,Dn=ut.prototype,so=Y["__core-js_shared__"],oo=$g.toString,nt=Dn.hasOwnProperty,Ug=0,mh=function(){var r=/[^.]+$/.exec(so&&so.keys&&so.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ao=Dn.toString,Lg=oo.call(ut),jg=Xe._,Mg=Ga("^"+oo.call(nt).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),co=fr?Y.Buffer:t,Ci=Y.Symbol,uo=Y.Uint8Array,bh=co?co.allocUnsafe:t,ho=vh(ut.getPrototypeOf,ut),wh=ut.create,Eh=Dn.propertyIsEnumerable,lo=no.splice,Dh=Ci?Ci.isConcatSpreadable:t,Jn=Ci?Ci.iterator:t,ki=Ci?Ci.toStringTag:t,fo=function(){try{var r=Qi(ut,"defineProperty");return r({},"",{}),r}catch{}}(),qg=Y.clearTimeout!==Xe.clearTimeout&&Y.clearTimeout,Fg=ge&&ge.now!==Xe.Date.now&&ge.now,zg=Y.setTimeout!==Xe.setTimeout&&Y.setTimeout,po=Ht.ceil,go=Ht.floor,Wa=ut.getOwnPropertySymbols,Hg=co?co.isBuffer:t,Sh=Y.isFinite,Bg=no.join,Kg=vh(ut.keys,ut),Bt=Ht.max,Qt=Ht.min,Vg=ge.now,kg=Y.parseInt,Ih=Ht.random,Gg=no.reverse,Ya=Qi(Y,"DataView"),Qn=Qi(Y,"Map"),Ja=Qi(Y,"Promise"),Sn=Qi(Y,"Set"),Xn=Qi(Y,"WeakMap"),Zn=Qi(ut,"create"),yo=Xn&&new Xn,In={},Wg=Xi(Ya),Yg=Xi(Qn),Jg=Xi(Ja),Qg=Xi(Sn),Xg=Xi(Xn),vo=Ci?Ci.prototype:t,es=vo?vo.valueOf:t,xh=vo?vo.toString:t;function _(r){if(Pt(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof Nr)return r;if(nt.call(r,"__wrapped__"))return Ol(r)}return new Nr(r)}var xn=function(){function r(){}return function(n){if(!wt(n))return{};if(wh)return wh(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function _o(){}function Nr(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}_.templateSettings={escape:Dt,evaluate:St,interpolate:bt,variable:"",imports:{_}},_.prototype=_o.prototype,_.prototype.constructor=_,Nr.prototype=xn(_o.prototype),Nr.prototype.constructor=Nr;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function Zg(){var r=new Ye(this.__wrapped__);return r.__actions__=dr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=dr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=dr(this.__views__),r}function e0(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function t0(){var r=this.__wrapped__.value(),n=this.__dir__,a=Re(r),h=n<0,g=a?r.length:0,m=dy(0,g,this.__views__),C=m.start,N=m.end,q=N-C,X=h?N:C-1,Z=this.__iteratees__,ie=Z.length,he=0,ye=Qt(q,this.__takeCount__);if(!a||!h&&g==q&&ye==q)return Jh(r,this.__actions__);var Ee=[];e:for(;q--&&he<ye;){X+=n;for(var ze=-1,De=r[X];++ze<ie;){var Ge=Z[ze],Ze=Ge.iteratee,Ir=Ge.type,or=Ze(De);if(Ir==A)De=or;else if(!or){if(Ir==w)continue e;break e}}Ee[he++]=De}return Ee}Ye.prototype=xn(_o.prototype),Ye.prototype.constructor=Ye;function Gi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function r0(){this.__data__=Zn?Zn(null):{},this.size=0}function i0(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function n0(r){var n=this.__data__;if(Zn){var a=n[r];return a===y?t:a}return nt.call(n,r)?n[r]:t}function s0(r){var n=this.__data__;return Zn?n[r]!==t:nt.call(n,r)}function o0(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=Zn&&n===t?y:n,this}Gi.prototype.clear=r0,Gi.prototype.delete=i0,Gi.prototype.get=n0,Gi.prototype.has=s0,Gi.prototype.set=o0;function ci(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function a0(){this.__data__=[],this.size=0}function c0(r){var n=this.__data__,a=mo(n,r);if(a<0)return!1;var h=n.length-1;return a==h?n.pop():lo.call(n,a,1),--this.size,!0}function u0(r){var n=this.__data__,a=mo(n,r);return a<0?t:n[a][1]}function h0(r){return mo(this.__data__,r)>-1}function l0(r,n){var a=this.__data__,h=mo(a,r);return h<0?(++this.size,a.push([r,n])):a[h][1]=n,this}ci.prototype.clear=a0,ci.prototype.delete=c0,ci.prototype.get=u0,ci.prototype.has=h0,ci.prototype.set=l0;function ui(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function f0(){this.size=0,this.__data__={hash:new Gi,map:new(Qn||ci),string:new Gi}}function d0(r){var n=To(this,r).delete(r);return this.size-=n?1:0,n}function p0(r){return To(this,r).get(r)}function g0(r){return To(this,r).has(r)}function y0(r,n){var a=To(this,r),h=a.size;return a.set(r,n),this.size+=a.size==h?0:1,this}ui.prototype.clear=f0,ui.prototype.delete=d0,ui.prototype.get=p0,ui.prototype.has=g0,ui.prototype.set=y0;function Wi(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new ui;++n<a;)this.add(r[n])}function v0(r){return this.__data__.set(r,y),this}function _0(r){return this.__data__.has(r)}Wi.prototype.add=Wi.prototype.push=v0,Wi.prototype.has=_0;function Br(r){var n=this.__data__=new ci(r);this.size=n.size}function m0(){this.__data__=new ci,this.size=0}function b0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function w0(r){return this.__data__.get(r)}function E0(r){return this.__data__.has(r)}function D0(r,n){var a=this.__data__;if(a instanceof ci){var h=a.__data__;if(!Qn||h.length<o-1)return h.push([r,n]),this.size=++a.size,this;a=this.__data__=new ui(h)}return a.set(r,n),this.size=a.size,this}Br.prototype.clear=m0,Br.prototype.delete=b0,Br.prototype.get=w0,Br.prototype.has=E0,Br.prototype.set=D0;function Oh(r,n){var a=Re(r),h=!a&&Zi(r),g=!a&&!h&&$i(r),m=!a&&!h&&!g&&An(r),C=a||h||g||m,N=C?Ka(r.length,Ng):[],q=N.length;for(var X in r)(n||nt.call(r,X))&&!(C&&(X=="length"||g&&(X=="offset"||X=="parent")||m&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||di(X,q)))&&N.push(X);return N}function Ph(r){var n=r.length;return n?r[ac(0,n-1)]:t}function S0(r,n){return Ro(dr(r),Yi(n,0,r.length))}function I0(r){return Ro(dr(r))}function Qa(r,n,a){(a!==t&&!Kr(r[n],a)||a===t&&!(n in r))&&hi(r,n,a)}function ts(r,n,a){var h=r[n];(!(nt.call(r,n)&&Kr(h,a))||a===t&&!(n in r))&&hi(r,n,a)}function mo(r,n){for(var a=r.length;a--;)if(Kr(r[a][0],n))return a;return-1}function x0(r,n,a,h){return Ai(r,function(g,m,C){n(h,g,a(g),C)}),h}function Ch(r,n){return r&&ei(n,Vt(n),r)}function O0(r,n){return r&&ei(n,gr(n),r)}function hi(r,n,a){n=="__proto__"&&fo?fo(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function Xa(r,n){for(var a=-1,h=n.length,g=K(h),m=r==null;++a<h;)g[a]=m?t:Rc(r,n[a]);return g}function Yi(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function $r(r,n,a,h,g,m){var C,N=n&S,q=n&D,X=n&x;if(a&&(C=g?a(r,h,g,m):a(r)),C!==t)return C;if(!wt(r))return r;var Z=Re(r);if(Z){if(C=gy(r),!N)return dr(r,C)}else{var ie=Xt(r),he=ie==ae||ie==fe;if($i(r))return Zh(r,N);if(ie==je||ie==le||he&&!g){if(C=q||he?{}:_l(r),!N)return q?ny(r,O0(C,r)):iy(r,Ch(C,r))}else{if(!st[ie])return g?r:{};C=yy(r,ie,N)}}m||(m=new Br);var ye=m.get(r);if(ye)return ye;m.set(r,C),Gl(r)?r.forEach(function(De){C.add($r(De,n,a,De,r,m))}):Vl(r)&&r.forEach(function(De,Ge){C.set(Ge,$r(De,n,a,Ge,r,m))});var Ee=X?q?_c:vc:q?gr:Vt,ze=Z?t:Ee(r);return Tr(ze||r,function(De,Ge){ze&&(Ge=De,De=r[Ge]),ts(C,Ge,$r(De,n,a,Ge,r,m))}),C}function P0(r){var n=Vt(r);return function(a){return Ah(a,r,n)}}function Ah(r,n,a){var h=a.length;if(r==null)return!h;for(r=ut(r);h--;){var g=a[h],m=n[g],C=r[g];if(C===t&&!(g in r)||!m(C))return!1}return!0}function Th(r,n,a){if(typeof r!="function")throw new Rr(l);return cs(function(){r.apply(t,a)},n)}function rs(r,n,a,h){var g=-1,m=to,C=!0,N=r.length,q=[],X=n.length;if(!N)return q;a&&(n=_t(n,Er(a))),h?(m=Ma,C=!1):n.length>=o&&(m=Yn,C=!1,n=new Wi(n));e:for(;++g<N;){var Z=r[g],ie=a==null?Z:a(Z);if(Z=h||Z!==0?Z:0,C&&ie===ie){for(var he=X;he--;)if(n[he]===ie)continue e;q.push(Z)}else m(n,ie,h)||q.push(Z)}return q}var Ai=nl(Zr),Rh=nl(ec,!0);function C0(r,n){var a=!0;return Ai(r,function(h,g,m){return a=!!n(h,g,m),a}),a}function bo(r,n,a){for(var h=-1,g=r.length;++h<g;){var m=r[h],C=n(m);if(C!=null&&(N===t?C===C&&!Sr(C):a(C,N)))var N=C,q=m}return q}function A0(r,n,a,h){var g=r.length;for(a=Me(a),a<0&&(a=-a>g?0:g+a),h=h===t||h>g?g:Me(h),h<0&&(h+=g),h=a>h?0:Yl(h);a<h;)r[a++]=n;return r}function Nh(r,n){var a=[];return Ai(r,function(h,g,m){n(h,g,m)&&a.push(h)}),a}function Wt(r,n,a,h,g){var m=-1,C=r.length;for(a||(a=_y),g||(g=[]);++m<C;){var N=r[m];n>0&&a(N)?n>1?Wt(N,n-1,a,h,g):Oi(g,N):h||(g[g.length]=N)}return g}var Za=sl(),$h=sl(!0);function Zr(r,n){return r&&Za(r,n,Vt)}function ec(r,n){return r&&$h(r,n,Vt)}function wo(r,n){return xi(n,function(a){return pi(r[a])})}function Ji(r,n){n=Ri(n,r);for(var a=0,h=n.length;r!=null&&a<h;)r=r[ti(n[a++])];return a&&a==h?r:t}function Uh(r,n,a){var h=n(r);return Re(r)?h:Oi(h,a(r))}function nr(r){return r==null?r===t?Fe:Ve:ki&&ki in ut(r)?fy(r):Iy(r)}function tc(r,n){return r>n}function T0(r,n){return r!=null&&nt.call(r,n)}function R0(r,n){return r!=null&&n in ut(r)}function N0(r,n,a){return r>=Qt(n,a)&&r<Bt(n,a)}function rc(r,n,a){for(var h=a?Ma:to,g=r[0].length,m=r.length,C=m,N=K(m),q=1/0,X=[];C--;){var Z=r[C];C&&n&&(Z=_t(Z,Er(n))),q=Qt(Z.length,q),N[C]=!a&&(n||g>=120&&Z.length>=120)?new Wi(C&&Z):t}Z=r[0];var ie=-1,he=N[0];e:for(;++ie<g&&X.length<q;){var ye=Z[ie],Ee=n?n(ye):ye;if(ye=a||ye!==0?ye:0,!(he?Yn(he,Ee):h(X,Ee,a))){for(C=m;--C;){var ze=N[C];if(!(ze?Yn(ze,Ee):h(r[C],Ee,a)))continue e}he&&he.push(Ee),X.push(ye)}}return X}function $0(r,n,a,h){return Zr(r,function(g,m,C){n(h,a(g),m,C)}),h}function is(r,n,a){n=Ri(n,r),r=El(r,n);var h=r==null?r:r[ti(Lr(n))];return h==null?t:Kt(h,r,a)}function Lh(r){return Pt(r)&&nr(r)==le}function U0(r){return Pt(r)&&nr(r)==Se}function L0(r){return Pt(r)&&nr(r)==U}function ns(r,n,a,h,g){return r===n?!0:r==null||n==null||!Pt(r)&&!Pt(n)?r!==r&&n!==n:j0(r,n,a,h,ns,g)}function j0(r,n,a,h,g,m){var C=Re(r),N=Re(n),q=C?_e:Xt(r),X=N?_e:Xt(n);q=q==le?je:q,X=X==le?je:X;var Z=q==je,ie=X==je,he=q==X;if(he&&$i(r)){if(!$i(n))return!1;C=!0,Z=!1}if(he&&!Z)return m||(m=new Br),C||An(r)?gl(r,n,a,h,g,m):hy(r,n,q,a,h,g,m);if(!(a&O)){var ye=Z&&nt.call(r,"__wrapped__"),Ee=ie&&nt.call(n,"__wrapped__");if(ye||Ee){var ze=ye?r.value():r,De=Ee?n.value():n;return m||(m=new Br),g(ze,De,a,h,m)}}return he?(m||(m=new Br),ly(r,n,a,h,g,m)):!1}function M0(r){return Pt(r)&&Xt(r)==Ie}function ic(r,n,a,h){var g=a.length,m=g,C=!h;if(r==null)return!m;for(r=ut(r);g--;){var N=a[g];if(C&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++g<m;){N=a[g];var q=N[0],X=r[q],Z=N[1];if(C&&N[2]){if(X===t&&!(q in r))return!1}else{var ie=new Br;if(h)var he=h(X,Z,q,r,n,ie);if(!(he===t?ns(Z,X,O|z,h,ie):he))return!1}}return!0}function jh(r){if(!wt(r)||by(r))return!1;var n=pi(r)?Mg:Ea;return n.test(Xi(r))}function q0(r){return Pt(r)&&nr(r)==qe}function F0(r){return Pt(r)&&Xt(r)==xe}function z0(r){return Pt(r)&&Mo(r.length)&&!!ot[nr(r)]}function Mh(r){return typeof r=="function"?r:r==null?yr:typeof r=="object"?Re(r)?zh(r[0],r[1]):Fh(r):af(r)}function nc(r){if(!as(r))return Kg(r);var n=[];for(var a in ut(r))nt.call(r,a)&&a!="constructor"&&n.push(a);return n}function H0(r){if(!wt(r))return Sy(r);var n=as(r),a=[];for(var h in r)h=="constructor"&&(n||!nt.call(r,h))||a.push(h);return a}function sc(r,n){return r<n}function qh(r,n){var a=-1,h=pr(r)?K(r.length):[];return Ai(r,function(g,m,C){h[++a]=n(g,m,C)}),h}function Fh(r){var n=bc(r);return n.length==1&&n[0][2]?bl(n[0][0],n[0][1]):function(a){return a===r||ic(a,r,n)}}function zh(r,n){return Ec(r)&&ml(n)?bl(ti(r),n):function(a){var h=Rc(a,r);return h===t&&h===n?Nc(a,r):ns(n,h,O|z)}}function Eo(r,n,a,h,g){r!==n&&Za(n,function(m,C){if(g||(g=new Br),wt(m))B0(r,n,C,a,Eo,h,g);else{var N=h?h(Sc(r,C),m,C+"",r,n,g):t;N===t&&(N=m),Qa(r,C,N)}},gr)}function B0(r,n,a,h,g,m,C){var N=Sc(r,a),q=Sc(n,a),X=C.get(q);if(X){Qa(r,a,X);return}var Z=m?m(N,q,a+"",r,n,C):t,ie=Z===t;if(ie){var he=Re(q),ye=!he&&$i(q),Ee=!he&&!ye&&An(q);Z=q,he||ye||Ee?Re(N)?Z=N:Rt(N)?Z=dr(N):ye?(ie=!1,Z=Zh(q,!0)):Ee?(ie=!1,Z=el(q,!0)):Z=[]:us(q)||Zi(q)?(Z=N,Zi(N)?Z=Jl(N):(!wt(N)||pi(N))&&(Z=_l(q))):ie=!1}ie&&(C.set(q,Z),g(Z,q,h,m,C),C.delete(q)),Qa(r,a,Z)}function Hh(r,n){var a=r.length;if(a)return n+=n<0?a:0,di(n,a)?r[n]:t}function Bh(r,n,a){n.length?n=_t(n,function(m){return Re(m)?function(C){return Ji(C,m.length===1?m[0]:m)}:m}):n=[yr];var h=-1;n=_t(n,Er(me()));var g=qh(r,function(m,C,N){var q=_t(n,function(X){return X(m)});return{criteria:q,index:++h,value:m}});return yg(g,function(m,C){return ry(m,C,a)})}function K0(r,n){return Kh(r,n,function(a,h){return Nc(r,h)})}function Kh(r,n,a){for(var h=-1,g=n.length,m={};++h<g;){var C=n[h],N=Ji(r,C);a(N,C)&&ss(m,Ri(C,r),N)}return m}function V0(r){return function(n){return Ji(n,r)}}function oc(r,n,a,h){var g=h?gg:mn,m=-1,C=n.length,N=r;for(r===n&&(n=dr(n)),a&&(N=_t(r,Er(a)));++m<C;)for(var q=0,X=n[m],Z=a?a(X):X;(q=g(N,Z,q,h))>-1;)N!==r&&lo.call(N,q,1),lo.call(r,q,1);return r}function Vh(r,n){for(var a=r?n.length:0,h=a-1;a--;){var g=n[a];if(a==h||g!==m){var m=g;di(g)?lo.call(r,g,1):hc(r,g)}}return r}function ac(r,n){return r+go(Ih()*(n-r+1))}function k0(r,n,a,h){for(var g=-1,m=Bt(po((n-r)/(a||1)),0),C=K(m);m--;)C[h?m:++g]=r,r+=a;return C}function cc(r,n){var a="";if(!r||n<1||n>V)return a;do n%2&&(a+=r),n=go(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return Ic(wl(r,n,yr),r+"")}function G0(r){return Ph(Tn(r))}function W0(r,n){var a=Tn(r);return Ro(a,Yi(n,0,a.length))}function ss(r,n,a,h){if(!wt(r))return r;n=Ri(n,r);for(var g=-1,m=n.length,C=m-1,N=r;N!=null&&++g<m;){var q=ti(n[g]),X=a;if(q==="__proto__"||q==="constructor"||q==="prototype")return r;if(g!=C){var Z=N[q];X=h?h(Z,q,N):t,X===t&&(X=wt(Z)?Z:di(n[g+1])?[]:{})}ts(N,q,X),N=N[q]}return r}var kh=yo?function(r,n){return yo.set(r,n),r}:yr,Y0=fo?function(r,n){return fo(r,"toString",{configurable:!0,enumerable:!1,value:Uc(n),writable:!0})}:yr;function J0(r){return Ro(Tn(r))}function Ur(r,n,a){var h=-1,g=r.length;n<0&&(n=-n>g?0:g+n),a=a>g?g:a,a<0&&(a+=g),g=n>a?0:a-n>>>0,n>>>=0;for(var m=K(g);++h<g;)m[h]=r[h+n];return m}function Q0(r,n){var a;return Ai(r,function(h,g,m){return a=n(h,g,m),!a}),!!a}function Do(r,n,a){var h=0,g=r==null?h:r.length;if(typeof n=="number"&&n===n&&g<=oe){for(;h<g;){var m=h+g>>>1,C=r[m];C!==null&&!Sr(C)&&(a?C<=n:C<n)?h=m+1:g=m}return g}return uc(r,n,yr,a)}function uc(r,n,a,h){var g=0,m=r==null?0:r.length;if(m===0)return 0;n=a(n);for(var C=n!==n,N=n===null,q=Sr(n),X=n===t;g<m;){var Z=go((g+m)/2),ie=a(r[Z]),he=ie!==t,ye=ie===null,Ee=ie===ie,ze=Sr(ie);if(C)var De=h||Ee;else X?De=Ee&&(h||he):N?De=Ee&&he&&(h||!ye):q?De=Ee&&he&&!ye&&(h||!ze):ye||ze?De=!1:De=h?ie<=n:ie<n;De?g=Z+1:m=Z}return Qt(m,be)}function Gh(r,n){for(var a=-1,h=r.length,g=0,m=[];++a<h;){var C=r[a],N=n?n(C):C;if(!a||!Kr(N,q)){var q=N;m[g++]=C===0?0:C}}return m}function Wh(r){return typeof r=="number"?r:Sr(r)?J:+r}function Dr(r){if(typeof r=="string")return r;if(Re(r))return _t(r,Dr)+"";if(Sr(r))return xh?xh.call(r):"";var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function Ti(r,n,a){var h=-1,g=to,m=r.length,C=!0,N=[],q=N;if(a)C=!1,g=Ma;else if(m>=o){var X=n?null:cy(r);if(X)return io(X);C=!1,g=Yn,q=new Wi}else q=n?[]:N;e:for(;++h<m;){var Z=r[h],ie=n?n(Z):Z;if(Z=a||Z!==0?Z:0,C&&ie===ie){for(var he=q.length;he--;)if(q[he]===ie)continue e;n&&q.push(ie),N.push(Z)}else g(q,ie,a)||(q!==N&&q.push(ie),N.push(Z))}return N}function hc(r,n){return n=Ri(n,r),r=El(r,n),r==null||delete r[ti(Lr(n))]}function Yh(r,n,a,h){return ss(r,n,a(Ji(r,n)),h)}function So(r,n,a,h){for(var g=r.length,m=h?g:-1;(h?m--:++m<g)&&n(r[m],m,r););return a?Ur(r,h?0:m,h?m+1:g):Ur(r,h?m+1:0,h?g:m)}function Jh(r,n){var a=r;return a instanceof Ye&&(a=a.value()),qa(n,function(h,g){return g.func.apply(g.thisArg,Oi([h],g.args))},a)}function lc(r,n,a){var h=r.length;if(h<2)return h?Ti(r[0]):[];for(var g=-1,m=K(h);++g<h;)for(var C=r[g],N=-1;++N<h;)N!=g&&(m[g]=rs(m[g]||C,r[N],n,a));return Ti(Wt(m,1),n,a)}function Qh(r,n,a){for(var h=-1,g=r.length,m=n.length,C={};++h<g;){var N=h<m?n[h]:t;a(C,r[h],N)}return C}function fc(r){return Rt(r)?r:[]}function dc(r){return typeof r=="function"?r:yr}function Ri(r,n){return Re(r)?r:Ec(r,n)?[r]:xl(it(r))}var X0=Ke;function Ni(r,n,a){var h=r.length;return a=a===t?h:a,!n&&a>=h?r:Ur(r,n,a)}var Xh=qg||function(r){return Xe.clearTimeout(r)};function Zh(r,n){if(n)return r.slice();var a=r.length,h=bh?bh(a):new r.constructor(a);return r.copy(h),h}function pc(r){var n=new r.constructor(r.byteLength);return new uo(n).set(new uo(r)),n}function Z0(r,n){var a=n?pc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function ey(r){var n=new r.constructor(r.source,Cr.exec(r));return n.lastIndex=r.lastIndex,n}function ty(r){return es?ut(es.call(r)):{}}function el(r,n){var a=n?pc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function tl(r,n){if(r!==n){var a=r!==t,h=r===null,g=r===r,m=Sr(r),C=n!==t,N=n===null,q=n===n,X=Sr(n);if(!N&&!X&&!m&&r>n||m&&C&&q&&!N&&!X||h&&C&&q||!a&&q||!g)return 1;if(!h&&!m&&!X&&r<n||X&&a&&g&&!h&&!m||N&&a&&g||!C&&g||!q)return-1}return 0}function ry(r,n,a){for(var h=-1,g=r.criteria,m=n.criteria,C=g.length,N=a.length;++h<C;){var q=tl(g[h],m[h]);if(q){if(h>=N)return q;var X=a[h];return q*(X=="desc"?-1:1)}}return r.index-n.index}function rl(r,n,a,h){for(var g=-1,m=r.length,C=a.length,N=-1,q=n.length,X=Bt(m-C,0),Z=K(q+X),ie=!h;++N<q;)Z[N]=n[N];for(;++g<C;)(ie||g<m)&&(Z[a[g]]=r[g]);for(;X--;)Z[N++]=r[g++];return Z}function il(r,n,a,h){for(var g=-1,m=r.length,C=-1,N=a.length,q=-1,X=n.length,Z=Bt(m-N,0),ie=K(Z+X),he=!h;++g<Z;)ie[g]=r[g];for(var ye=g;++q<X;)ie[ye+q]=n[q];for(;++C<N;)(he||g<m)&&(ie[ye+a[C]]=r[g++]);return ie}function dr(r,n){var a=-1,h=r.length;for(n||(n=K(h));++a<h;)n[a]=r[a];return n}function ei(r,n,a,h){var g=!a;a||(a={});for(var m=-1,C=n.length;++m<C;){var N=n[m],q=h?h(a[N],r[N],N,a,r):t;q===t&&(q=r[N]),g?hi(a,N,q):ts(a,N,q)}return a}function iy(r,n){return ei(r,wc(r),n)}function ny(r,n){return ei(r,yl(r),n)}function Io(r,n){return function(a,h){var g=Re(a)?ug:x0,m=n?n():{};return g(a,r,me(h,2),m)}}function On(r){return Ke(function(n,a){var h=-1,g=a.length,m=g>1?a[g-1]:t,C=g>2?a[2]:t;for(m=r.length>3&&typeof m=="function"?(g--,m):t,C&&sr(a[0],a[1],C)&&(m=g<3?t:m,g=1),n=ut(n);++h<g;){var N=a[h];N&&r(n,N,h,m)}return n})}function nl(r,n){return function(a,h){if(a==null)return a;if(!pr(a))return r(a,h);for(var g=a.length,m=n?g:-1,C=ut(a);(n?m--:++m<g)&&h(C[m],m,C)!==!1;);return a}}function sl(r){return function(n,a,h){for(var g=-1,m=ut(n),C=h(n),N=C.length;N--;){var q=C[r?N:++g];if(a(m[q],q,m)===!1)break}return n}}function sy(r,n,a){var h=n&B,g=os(r);function m(){var C=this&&this!==Xe&&this instanceof m?g:r;return C.apply(h?a:this,arguments)}return m}function ol(r){return function(n){n=it(n);var a=bn(n)?Hr(n):t,h=a?a[0]:n.charAt(0),g=a?Ni(a,1).join(""):n.slice(1);return h[r]()+g}}function Pn(r){return function(n){return qa(sf(nf(n).replace(Gn,"")),r,"")}}function os(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=xn(r.prototype),h=r.apply(a,n);return wt(h)?h:a}}function oy(r,n,a){var h=os(r);function g(){for(var m=arguments.length,C=K(m),N=m,q=Cn(g);N--;)C[N]=arguments[N];var X=m<3&&C[0]!==q&&C[m-1]!==q?[]:Pi(C,q);if(m-=X.length,m<a)return ll(r,n,xo,g.placeholder,t,C,X,t,t,a-m);var Z=this&&this!==Xe&&this instanceof g?h:r;return Kt(Z,this,C)}return g}function al(r){return function(n,a,h){var g=ut(n);if(!pr(n)){var m=me(a,3);n=Vt(n),a=function(N){return m(g[N],N,g)}}var C=r(n,a,h);return C>-1?g[m?n[C]:C]:t}}function cl(r){return fi(function(n){var a=n.length,h=a,g=Nr.prototype.thru;for(r&&n.reverse();h--;){var m=n[h];if(typeof m!="function")throw new Rr(l);if(g&&!C&&Ao(m)=="wrapper")var C=new Nr([],!0)}for(h=C?h:a;++h<a;){m=n[h];var N=Ao(m),q=N=="wrapper"?mc(m):t;q&&Dc(q[0])&&q[1]==(u|L|R|b)&&!q[4].length&&q[9]==1?C=C[Ao(q[0])].apply(C,q[3]):C=m.length==1&&Dc(m)?C[N]():C.thru(m)}return function(){var X=arguments,Z=X[0];if(C&&X.length==1&&Re(Z))return C.plant(Z).value();for(var ie=0,he=a?n[ie].apply(this,X):Z;++ie<a;)he=n[ie].call(this,he);return he}})}function xo(r,n,a,h,g,m,C,N,q,X){var Z=n&u,ie=n&B,he=n&ne,ye=n&(L|P),Ee=n&G,ze=he?t:os(r);function De(){for(var Ge=arguments.length,Ze=K(Ge),Ir=Ge;Ir--;)Ze[Ir]=arguments[Ir];if(ye)var or=Cn(De),xr=_g(Ze,or);if(h&&(Ze=rl(Ze,h,g,ye)),m&&(Ze=il(Ze,m,C,ye)),Ge-=xr,ye&&Ge<X){var Nt=Pi(Ze,or);return ll(r,n,xo,De.placeholder,a,Ze,Nt,N,q,X-Ge)}var Vr=ie?a:this,yi=he?Vr[r]:r;return Ge=Ze.length,N?Ze=xy(Ze,N):Ee&&Ge>1&&Ze.reverse(),Z&&q<Ge&&(Ze.length=q),this&&this!==Xe&&this instanceof De&&(yi=ze||os(yi)),yi.apply(Vr,Ze)}return De}function ul(r,n){return function(a,h){return $0(a,r,n(h),{})}}function Oo(r,n){return function(a,h){var g;if(a===t&&h===t)return n;if(a!==t&&(g=a),h!==t){if(g===t)return h;typeof a=="string"||typeof h=="string"?(a=Dr(a),h=Dr(h)):(a=Wh(a),h=Wh(h)),g=r(a,h)}return g}}function gc(r){return fi(function(n){return n=_t(n,Er(me())),Ke(function(a){var h=this;return r(n,function(g){return Kt(g,h,a)})})})}function Po(r,n){n=n===t?" ":Dr(n);var a=n.length;if(a<2)return a?cc(n,r):n;var h=cc(n,po(r/wn(n)));return bn(n)?Ni(Hr(h),0,r).join(""):h.slice(0,r)}function ay(r,n,a,h){var g=n&B,m=os(r);function C(){for(var N=-1,q=arguments.length,X=-1,Z=h.length,ie=K(Z+q),he=this&&this!==Xe&&this instanceof C?m:r;++X<Z;)ie[X]=h[X];for(;q--;)ie[X++]=arguments[++N];return Kt(he,g?a:this,ie)}return C}function hl(r){return function(n,a,h){return h&&typeof h!="number"&&sr(n,a,h)&&(a=h=t),n=gi(n),a===t?(a=n,n=0):a=gi(a),h=h===t?n<a?1:-1:gi(h),k0(n,a,h,r)}}function Co(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=jr(n),a=jr(a)),r(n,a)}}function ll(r,n,a,h,g,m,C,N,q,X){var Z=n&L,ie=Z?C:t,he=Z?t:C,ye=Z?m:t,Ee=Z?t:m;n|=Z?R:E,n&=~(Z?E:R),n&$||(n&=~(B|ne));var ze=[r,n,g,ye,ie,Ee,he,N,q,X],De=a.apply(t,ze);return Dc(r)&&Dl(De,ze),De.placeholder=h,Sl(De,r,n)}function yc(r){var n=Ht[r];return function(a,h){if(a=jr(a),h=h==null?0:Qt(Me(h),292),h&&Sh(a)){var g=(it(a)+"e").split("e"),m=n(g[0]+"e"+(+g[1]+h));return g=(it(m)+"e").split("e"),+(g[0]+"e"+(+g[1]-h))}return n(a)}}var cy=Sn&&1/io(new Sn([,-0]))[1]==Q?function(r){return new Sn(r)}:Mc;function fl(r){return function(n){var a=Xt(n);return a==Ie?ka(n):a==xe?Ig(n):vg(n,r(n))}}function li(r,n,a,h,g,m,C,N){var q=n&ne;if(!q&&typeof r!="function")throw new Rr(l);var X=h?h.length:0;if(X||(n&=~(R|E),h=g=t),C=C===t?C:Bt(Me(C),0),N=N===t?N:Me(N),X-=g?g.length:0,n&E){var Z=h,ie=g;h=g=t}var he=q?t:mc(r),ye=[r,n,a,h,g,Z,ie,m,C,N];if(he&&Dy(ye,he),r=ye[0],n=ye[1],a=ye[2],h=ye[3],g=ye[4],N=ye[9]=ye[9]===t?q?0:r.length:Bt(ye[9]-X,0),!N&&n&(L|P)&&(n&=~(L|P)),!n||n==B)var Ee=sy(r,n,a);else n==L||n==P?Ee=oy(r,n,N):(n==R||n==(B|R))&&!g.length?Ee=ay(r,n,a,h):Ee=xo.apply(t,ye);var ze=he?kh:Dl;return Sl(ze(Ee,ye),r,n)}function dl(r,n,a,h){return r===t||Kr(r,Dn[a])&&!nt.call(h,a)?n:r}function pl(r,n,a,h,g,m){return wt(r)&&wt(n)&&(m.set(n,r),Eo(r,n,t,pl,m),m.delete(n)),r}function uy(r){return us(r)?t:r}function gl(r,n,a,h,g,m){var C=a&O,N=r.length,q=n.length;if(N!=q&&!(C&&q>N))return!1;var X=m.get(r),Z=m.get(n);if(X&&Z)return X==n&&Z==r;var ie=-1,he=!0,ye=a&z?new Wi:t;for(m.set(r,n),m.set(n,r);++ie<N;){var Ee=r[ie],ze=n[ie];if(h)var De=C?h(ze,Ee,ie,n,r,m):h(Ee,ze,ie,r,n,m);if(De!==t){if(De)continue;he=!1;break}if(ye){if(!Fa(n,function(Ge,Ze){if(!Yn(ye,Ze)&&(Ee===Ge||g(Ee,Ge,a,h,m)))return ye.push(Ze)})){he=!1;break}}else if(!(Ee===ze||g(Ee,ze,a,h,m))){he=!1;break}}return m.delete(r),m.delete(n),he}function hy(r,n,a,h,g,m,C){switch(a){case Ce:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case Se:return!(r.byteLength!=n.byteLength||!m(new uo(r),new uo(n)));case F:case U:case He:return Kr(+r,+n);case T:return r.name==n.name&&r.message==n.message;case qe:case Ne:return r==n+"";case Ie:var N=ka;case xe:var q=h&O;if(N||(N=io),r.size!=n.size&&!q)return!1;var X=C.get(r);if(X)return X==n;h|=z,C.set(r,n);var Z=gl(N(r),N(n),h,g,m,C);return C.delete(r),Z;case $e:if(es)return es.call(r)==es.call(n)}return!1}function ly(r,n,a,h,g,m){var C=a&O,N=vc(r),q=N.length,X=vc(n),Z=X.length;if(q!=Z&&!C)return!1;for(var ie=q;ie--;){var he=N[ie];if(!(C?he in n:nt.call(n,he)))return!1}var ye=m.get(r),Ee=m.get(n);if(ye&&Ee)return ye==n&&Ee==r;var ze=!0;m.set(r,n),m.set(n,r);for(var De=C;++ie<q;){he=N[ie];var Ge=r[he],Ze=n[he];if(h)var Ir=C?h(Ze,Ge,he,n,r,m):h(Ge,Ze,he,r,n,m);if(!(Ir===t?Ge===Ze||g(Ge,Ze,a,h,m):Ir)){ze=!1;break}De||(De=he=="constructor")}if(ze&&!De){var or=r.constructor,xr=n.constructor;or!=xr&&"constructor"in r&&"constructor"in n&&!(typeof or=="function"&&or instanceof or&&typeof xr=="function"&&xr instanceof xr)&&(ze=!1)}return m.delete(r),m.delete(n),ze}function fi(r){return Ic(wl(r,t,Al),r+"")}function vc(r){return Uh(r,Vt,wc)}function _c(r){return Uh(r,gr,yl)}var mc=yo?function(r){return yo.get(r)}:Mc;function Ao(r){for(var n=r.name+"",a=In[n],h=nt.call(In,n)?a.length:0;h--;){var g=a[h],m=g.func;if(m==null||m==r)return g.name}return n}function Cn(r){var n=nt.call(_,"placeholder")?_:r;return n.placeholder}function me(){var r=_.iteratee||Lc;return r=r===Lc?Mh:r,arguments.length?r(arguments[0],arguments[1]):r}function To(r,n){var a=r.__data__;return my(n)?a[typeof n=="string"?"string":"hash"]:a.map}function bc(r){for(var n=Vt(r),a=n.length;a--;){var h=n[a],g=r[h];n[a]=[h,g,ml(g)]}return n}function Qi(r,n){var a=Eg(r,n);return jh(a)?a:t}function fy(r){var n=nt.call(r,ki),a=r[ki];try{r[ki]=t;var h=!0}catch{}var g=ao.call(r);return h&&(n?r[ki]=a:delete r[ki]),g}var wc=Wa?function(r){return r==null?[]:(r=ut(r),xi(Wa(r),function(n){return Eh.call(r,n)}))}:qc,yl=Wa?function(r){for(var n=[];r;)Oi(n,wc(r)),r=ho(r);return n}:qc,Xt=nr;(Ya&&Xt(new Ya(new ArrayBuffer(1)))!=Ce||Qn&&Xt(new Qn)!=Ie||Ja&&Xt(Ja.resolve())!=pt||Sn&&Xt(new Sn)!=xe||Xn&&Xt(new Xn)!=Pe)&&(Xt=function(r){var n=nr(r),a=n==je?r.constructor:t,h=a?Xi(a):"";if(h)switch(h){case Wg:return Ce;case Yg:return Ie;case Jg:return pt;case Qg:return xe;case Xg:return Pe}return n});function dy(r,n,a){for(var h=-1,g=a.length;++h<g;){var m=a[h],C=m.size;switch(m.type){case"drop":r+=C;break;case"dropRight":n-=C;break;case"take":n=Qt(n,r+C);break;case"takeRight":r=Bt(r,n-C);break}}return{start:r,end:n}}function py(r){var n=r.match(ht);return n?n[1].split(jt):[]}function vl(r,n,a){n=Ri(n,r);for(var h=-1,g=n.length,m=!1;++h<g;){var C=ti(n[h]);if(!(m=r!=null&&a(r,C)))break;r=r[C]}return m||++h!=g?m:(g=r==null?0:r.length,!!g&&Mo(g)&&di(C,g)&&(Re(r)||Zi(r)))}function gy(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&nt.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function _l(r){return typeof r.constructor=="function"&&!as(r)?xn(ho(r)):{}}function yy(r,n,a){var h=r.constructor;switch(n){case Se:return pc(r);case F:case U:return new h(+r);case Ce:return Z0(r,a);case Be:case Oe:case ke:case We:case et:case tt:case Qe:case tr:case lr:return el(r,a);case Ie:return new h;case He:case Ne:return new h(r);case qe:return ey(r);case xe:return new h;case $e:return ty(r)}}function vy(r,n){var a=n.length;if(!a)return r;var h=a-1;return n[h]=(a>1?"& ":"")+n[h],n=n.join(a>2?", ":" "),r.replace(Ot,`{
/* [wrapped with `+n+`] */
`)}function _y(r){return Re(r)||Zi(r)||!!(Dh&&r&&r[Dh])}function di(r,n){var a=typeof r;return n=n??V,!!n&&(a=="number"||a!="symbol"&&Sa.test(r))&&r>-1&&r%1==0&&r<n}function sr(r,n,a){if(!wt(a))return!1;var h=typeof n;return(h=="number"?pr(a)&&di(n,a.length):h=="string"&&n in a)?Kr(a[n],r):!1}function Ec(r,n){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Sr(r)?!0:$t.test(r)||!vt.test(r)||n!=null&&r in ut(n)}function my(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function Dc(r){var n=Ao(r),a=_[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(r===a)return!0;var h=mc(a);return!!h&&r===h[0]}function by(r){return!!mh&&mh in r}var wy=so?pi:Fc;function as(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||Dn;return r===a}function ml(r){return r===r&&!wt(r)}function bl(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in ut(a))}}function Ey(r){var n=Lo(r,function(h){return a.size===p&&a.clear(),h}),a=n.cache;return n}function Dy(r,n){var a=r[1],h=n[1],g=a|h,m=g<(B|ne|u),C=h==u&&a==L||h==u&&a==b&&r[7].length<=n[8]||h==(u|b)&&n[7].length<=n[8]&&a==L;if(!(m||C))return r;h&B&&(r[2]=n[2],g|=a&B?0:$);var N=n[3];if(N){var q=r[3];r[3]=q?rl(q,N,n[4]):N,r[4]=q?Pi(r[3],v):n[4]}return N=n[5],N&&(q=r[5],r[5]=q?il(q,N,n[6]):N,r[6]=q?Pi(r[5],v):n[6]),N=n[7],N&&(r[7]=N),h&u&&(r[8]=r[8]==null?n[8]:Qt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=g,r}function Sy(r){var n=[];if(r!=null)for(var a in ut(r))n.push(a);return n}function Iy(r){return ao.call(r)}function wl(r,n,a){return n=Bt(n===t?r.length-1:n,0),function(){for(var h=arguments,g=-1,m=Bt(h.length-n,0),C=K(m);++g<m;)C[g]=h[n+g];g=-1;for(var N=K(n+1);++g<n;)N[g]=h[g];return N[n]=a(C),Kt(r,this,N)}}function El(r,n){return n.length<2?r:Ji(r,Ur(n,0,-1))}function xy(r,n){for(var a=r.length,h=Qt(n.length,a),g=dr(r);h--;){var m=n[h];r[h]=di(m,a)?g[m]:t}return r}function Sc(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var Dl=Il(kh),cs=zg||function(r,n){return Xe.setTimeout(r,n)},Ic=Il(Y0);function Sl(r,n,a){var h=n+"";return Ic(r,vy(h,Oy(py(h),a)))}function Il(r){var n=0,a=0;return function(){var h=Vg(),g=de-(h-a);if(a=h,g>0){if(++n>=ce)return arguments[0]}else n=0;return r.apply(t,arguments)}}function Ro(r,n){var a=-1,h=r.length,g=h-1;for(n=n===t?h:n;++a<n;){var m=ac(a,g),C=r[m];r[m]=r[a],r[a]=C}return r.length=n,r}var xl=Ey(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Ut,function(a,h,g,m){n.push(g?m.replace(_a,"$1"):h||a)}),n});function ti(r){if(typeof r=="string"||Sr(r))return r;var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function Xi(r){if(r!=null){try{return oo.call(r)}catch{}try{return r+""}catch{}}return""}function Oy(r,n){return Tr(we,function(a){var h="_."+a[0];n&a[1]&&!to(r,h)&&r.push(h)}),r.sort()}function Ol(r){if(r instanceof Ye)return r.clone();var n=new Nr(r.__wrapped__,r.__chain__);return n.__actions__=dr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function Py(r,n,a){(a?sr(r,n,a):n===t)?n=1:n=Bt(Me(n),0);var h=r==null?0:r.length;if(!h||n<1)return[];for(var g=0,m=0,C=K(po(h/n));g<h;)C[m++]=Ur(r,g,g+=n);return C}function Cy(r){for(var n=-1,a=r==null?0:r.length,h=0,g=[];++n<a;){var m=r[n];m&&(g[h++]=m)}return g}function Ay(){var r=arguments.length;if(!r)return[];for(var n=K(r-1),a=arguments[0],h=r;h--;)n[h-1]=arguments[h];return Oi(Re(a)?dr(a):[a],Wt(n,1))}var Ty=Ke(function(r,n){return Rt(r)?rs(r,Wt(n,1,Rt,!0)):[]}),Ry=Ke(function(r,n){var a=Lr(n);return Rt(a)&&(a=t),Rt(r)?rs(r,Wt(n,1,Rt,!0),me(a,2)):[]}),Ny=Ke(function(r,n){var a=Lr(n);return Rt(a)&&(a=t),Rt(r)?rs(r,Wt(n,1,Rt,!0),t,a):[]});function $y(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Me(n),Ur(r,n<0?0:n,h)):[]}function Uy(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Me(n),n=h-n,Ur(r,0,n<0?0:n)):[]}function Ly(r,n){return r&&r.length?So(r,me(n,3),!0,!0):[]}function jy(r,n){return r&&r.length?So(r,me(n,3),!0):[]}function My(r,n,a,h){var g=r==null?0:r.length;return g?(a&&typeof a!="number"&&sr(r,n,a)&&(a=0,h=g),A0(r,n,a,h)):[]}function Pl(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var g=a==null?0:Me(a);return g<0&&(g=Bt(h+g,0)),ro(r,me(n,3),g)}function Cl(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var g=h-1;return a!==t&&(g=Me(a),g=a<0?Bt(h+g,0):Qt(g,h-1)),ro(r,me(n,3),g,!0)}function Al(r){var n=r==null?0:r.length;return n?Wt(r,1):[]}function qy(r){var n=r==null?0:r.length;return n?Wt(r,Q):[]}function Fy(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:Me(n),Wt(r,n)):[]}function zy(r){for(var n=-1,a=r==null?0:r.length,h={};++n<a;){var g=r[n];h[g[0]]=g[1]}return h}function Tl(r){return r&&r.length?r[0]:t}function Hy(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var g=a==null?0:Me(a);return g<0&&(g=Bt(h+g,0)),mn(r,n,g)}function By(r){var n=r==null?0:r.length;return n?Ur(r,0,-1):[]}var Ky=Ke(function(r){var n=_t(r,fc);return n.length&&n[0]===r[0]?rc(n):[]}),Vy=Ke(function(r){var n=Lr(r),a=_t(r,fc);return n===Lr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?rc(a,me(n,2)):[]}),ky=Ke(function(r){var n=Lr(r),a=_t(r,fc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?rc(a,t,n):[]});function Gy(r,n){return r==null?"":Bg.call(r,n)}function Lr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function Wy(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var g=h;return a!==t&&(g=Me(a),g=g<0?Bt(h+g,0):Qt(g,h-1)),n===n?Og(r,n,g):ro(r,lh,g,!0)}function Yy(r,n){return r&&r.length?Hh(r,Me(n)):t}var Jy=Ke(Rl);function Rl(r,n){return r&&r.length&&n&&n.length?oc(r,n):r}function Qy(r,n,a){return r&&r.length&&n&&n.length?oc(r,n,me(a,2)):r}function Xy(r,n,a){return r&&r.length&&n&&n.length?oc(r,n,t,a):r}var Zy=fi(function(r,n){var a=r==null?0:r.length,h=Xa(r,n);return Vh(r,_t(n,function(g){return di(g,a)?+g:g}).sort(tl)),h});function ev(r,n){var a=[];if(!(r&&r.length))return a;var h=-1,g=[],m=r.length;for(n=me(n,3);++h<m;){var C=r[h];n(C,h,r)&&(a.push(C),g.push(h))}return Vh(r,g),a}function xc(r){return r==null?r:Gg.call(r)}function tv(r,n,a){var h=r==null?0:r.length;return h?(a&&typeof a!="number"&&sr(r,n,a)?(n=0,a=h):(n=n==null?0:Me(n),a=a===t?h:Me(a)),Ur(r,n,a)):[]}function rv(r,n){return Do(r,n)}function iv(r,n,a){return uc(r,n,me(a,2))}function nv(r,n){var a=r==null?0:r.length;if(a){var h=Do(r,n);if(h<a&&Kr(r[h],n))return h}return-1}function sv(r,n){return Do(r,n,!0)}function ov(r,n,a){return uc(r,n,me(a,2),!0)}function av(r,n){var a=r==null?0:r.length;if(a){var h=Do(r,n,!0)-1;if(Kr(r[h],n))return h}return-1}function cv(r){return r&&r.length?Gh(r):[]}function uv(r,n){return r&&r.length?Gh(r,me(n,2)):[]}function hv(r){var n=r==null?0:r.length;return n?Ur(r,1,n):[]}function lv(r,n,a){return r&&r.length?(n=a||n===t?1:Me(n),Ur(r,0,n<0?0:n)):[]}function fv(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Me(n),n=h-n,Ur(r,n<0?0:n,h)):[]}function dv(r,n){return r&&r.length?So(r,me(n,3),!1,!0):[]}function pv(r,n){return r&&r.length?So(r,me(n,3)):[]}var gv=Ke(function(r){return Ti(Wt(r,1,Rt,!0))}),yv=Ke(function(r){var n=Lr(r);return Rt(n)&&(n=t),Ti(Wt(r,1,Rt,!0),me(n,2))}),vv=Ke(function(r){var n=Lr(r);return n=typeof n=="function"?n:t,Ti(Wt(r,1,Rt,!0),t,n)});function _v(r){return r&&r.length?Ti(r):[]}function mv(r,n){return r&&r.length?Ti(r,me(n,2)):[]}function bv(r,n){return n=typeof n=="function"?n:t,r&&r.length?Ti(r,t,n):[]}function Oc(r){if(!(r&&r.length))return[];var n=0;return r=xi(r,function(a){if(Rt(a))return n=Bt(a.length,n),!0}),Ka(n,function(a){return _t(r,za(a))})}function Nl(r,n){if(!(r&&r.length))return[];var a=Oc(r);return n==null?a:_t(a,function(h){return Kt(n,t,h)})}var wv=Ke(function(r,n){return Rt(r)?rs(r,n):[]}),Ev=Ke(function(r){return lc(xi(r,Rt))}),Dv=Ke(function(r){var n=Lr(r);return Rt(n)&&(n=t),lc(xi(r,Rt),me(n,2))}),Sv=Ke(function(r){var n=Lr(r);return n=typeof n=="function"?n:t,lc(xi(r,Rt),t,n)}),Iv=Ke(Oc);function xv(r,n){return Qh(r||[],n||[],ts)}function Ov(r,n){return Qh(r||[],n||[],ss)}var Pv=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Nl(r,a)});function $l(r){var n=_(r);return n.__chain__=!0,n}function Cv(r,n){return n(r),r}function No(r,n){return n(r)}var Av=fi(function(r){var n=r.length,a=n?r[0]:0,h=this.__wrapped__,g=function(m){return Xa(m,r)};return n>1||this.__actions__.length||!(h instanceof Ye)||!di(a)?this.thru(g):(h=h.slice(a,+a+(n?1:0)),h.__actions__.push({func:No,args:[g],thisArg:t}),new Nr(h,this.__chain__).thru(function(m){return n&&!m.length&&m.push(t),m}))});function Tv(){return $l(this)}function Rv(){return new Nr(this.value(),this.__chain__)}function Nv(){this.__values__===t&&(this.__values__=Wl(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function $v(){return this}function Uv(r){for(var n,a=this;a instanceof _o;){var h=Ol(a);h.__index__=0,h.__values__=t,n?g.__wrapped__=h:n=h;var g=h;a=a.__wrapped__}return g.__wrapped__=r,n}function Lv(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:No,args:[xc],thisArg:t}),new Nr(n,this.__chain__)}return this.thru(xc)}function jv(){return Jh(this.__wrapped__,this.__actions__)}var Mv=Io(function(r,n,a){nt.call(r,a)?++r[a]:hi(r,a,1)});function qv(r,n,a){var h=Re(r)?uh:C0;return a&&sr(r,n,a)&&(n=t),h(r,me(n,3))}function Fv(r,n){var a=Re(r)?xi:Nh;return a(r,me(n,3))}var zv=al(Pl),Hv=al(Cl);function Bv(r,n){return Wt($o(r,n),1)}function Kv(r,n){return Wt($o(r,n),Q)}function Vv(r,n,a){return a=a===t?1:Me(a),Wt($o(r,n),a)}function Ul(r,n){var a=Re(r)?Tr:Ai;return a(r,me(n,3))}function Ll(r,n){var a=Re(r)?hg:Rh;return a(r,me(n,3))}var kv=Io(function(r,n,a){nt.call(r,a)?r[a].push(n):hi(r,a,[n])});function Gv(r,n,a,h){r=pr(r)?r:Tn(r),a=a&&!h?Me(a):0;var g=r.length;return a<0&&(a=Bt(g+a,0)),qo(r)?a<=g&&r.indexOf(n,a)>-1:!!g&&mn(r,n,a)>-1}var Wv=Ke(function(r,n,a){var h=-1,g=typeof n=="function",m=pr(r)?K(r.length):[];return Ai(r,function(C){m[++h]=g?Kt(n,C,a):is(C,n,a)}),m}),Yv=Io(function(r,n,a){hi(r,a,n)});function $o(r,n){var a=Re(r)?_t:qh;return a(r,me(n,3))}function Jv(r,n,a,h){return r==null?[]:(Re(n)||(n=n==null?[]:[n]),a=h?t:a,Re(a)||(a=a==null?[]:[a]),Bh(r,n,a))}var Qv=Io(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function Xv(r,n,a){var h=Re(r)?qa:dh,g=arguments.length<3;return h(r,me(n,4),a,g,Ai)}function Zv(r,n,a){var h=Re(r)?lg:dh,g=arguments.length<3;return h(r,me(n,4),a,g,Rh)}function e_(r,n){var a=Re(r)?xi:Nh;return a(r,jo(me(n,3)))}function t_(r){var n=Re(r)?Ph:G0;return n(r)}function r_(r,n,a){(a?sr(r,n,a):n===t)?n=1:n=Me(n);var h=Re(r)?S0:W0;return h(r,n)}function i_(r){var n=Re(r)?I0:J0;return n(r)}function n_(r){if(r==null)return 0;if(pr(r))return qo(r)?wn(r):r.length;var n=Xt(r);return n==Ie||n==xe?r.size:nc(r).length}function s_(r,n,a){var h=Re(r)?Fa:Q0;return a&&sr(r,n,a)&&(n=t),h(r,me(n,3))}var o_=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&sr(r,n[0],n[1])?n=[]:a>2&&sr(n[0],n[1],n[2])&&(n=[n[0]]),Bh(r,Wt(n,1),[])}),Uo=Fg||function(){return Xe.Date.now()};function a_(r,n){if(typeof n!="function")throw new Rr(l);return r=Me(r),function(){if(--r<1)return n.apply(this,arguments)}}function jl(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,li(r,u,t,t,t,t,n)}function Ml(r,n){var a;if(typeof n!="function")throw new Rr(l);return r=Me(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var Pc=Ke(function(r,n,a){var h=B;if(a.length){var g=Pi(a,Cn(Pc));h|=R}return li(r,h,n,a,g)}),ql=Ke(function(r,n,a){var h=B|ne;if(a.length){var g=Pi(a,Cn(ql));h|=R}return li(n,h,r,a,g)});function Fl(r,n,a){n=a?t:n;var h=li(r,L,t,t,t,t,t,n);return h.placeholder=Fl.placeholder,h}function zl(r,n,a){n=a?t:n;var h=li(r,P,t,t,t,t,t,n);return h.placeholder=zl.placeholder,h}function Hl(r,n,a){var h,g,m,C,N,q,X=0,Z=!1,ie=!1,he=!0;if(typeof r!="function")throw new Rr(l);n=jr(n)||0,wt(a)&&(Z=!!a.leading,ie="maxWait"in a,m=ie?Bt(jr(a.maxWait)||0,n):m,he="trailing"in a?!!a.trailing:he);function ye(Nt){var Vr=h,yi=g;return h=g=t,X=Nt,C=r.apply(yi,Vr),C}function Ee(Nt){return X=Nt,N=cs(Ge,n),Z?ye(Nt):C}function ze(Nt){var Vr=Nt-q,yi=Nt-X,cf=n-Vr;return ie?Qt(cf,m-yi):cf}function De(Nt){var Vr=Nt-q,yi=Nt-X;return q===t||Vr>=n||Vr<0||ie&&yi>=m}function Ge(){var Nt=Uo();if(De(Nt))return Ze(Nt);N=cs(Ge,ze(Nt))}function Ze(Nt){return N=t,he&&h?ye(Nt):(h=g=t,C)}function Ir(){N!==t&&Xh(N),X=0,h=q=g=N=t}function or(){return N===t?C:Ze(Uo())}function xr(){var Nt=Uo(),Vr=De(Nt);if(h=arguments,g=this,q=Nt,Vr){if(N===t)return Ee(q);if(ie)return Xh(N),N=cs(Ge,n),ye(q)}return N===t&&(N=cs(Ge,n)),C}return xr.cancel=Ir,xr.flush=or,xr}var c_=Ke(function(r,n){return Th(r,1,n)}),u_=Ke(function(r,n,a){return Th(r,jr(n)||0,a)});function h_(r){return li(r,G)}function Lo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Rr(l);var a=function(){var h=arguments,g=n?n.apply(this,h):h[0],m=a.cache;if(m.has(g))return m.get(g);var C=r.apply(this,h);return a.cache=m.set(g,C)||m,C};return a.cache=new(Lo.Cache||ui),a}Lo.Cache=ui;function jo(r){if(typeof r!="function")throw new Rr(l);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function l_(r){return Ml(2,r)}var f_=X0(function(r,n){n=n.length==1&&Re(n[0])?_t(n[0],Er(me())):_t(Wt(n,1),Er(me()));var a=n.length;return Ke(function(h){for(var g=-1,m=Qt(h.length,a);++g<m;)h[g]=n[g].call(this,h[g]);return Kt(r,this,h)})}),Cc=Ke(function(r,n){var a=Pi(n,Cn(Cc));return li(r,R,t,n,a)}),Bl=Ke(function(r,n){var a=Pi(n,Cn(Bl));return li(r,E,t,n,a)}),d_=fi(function(r,n){return li(r,b,t,t,t,n)});function p_(r,n){if(typeof r!="function")throw new Rr(l);return n=n===t?n:Me(n),Ke(r,n)}function g_(r,n){if(typeof r!="function")throw new Rr(l);return n=n==null?0:Bt(Me(n),0),Ke(function(a){var h=a[n],g=Ni(a,0,n);return h&&Oi(g,h),Kt(r,this,g)})}function y_(r,n,a){var h=!0,g=!0;if(typeof r!="function")throw new Rr(l);return wt(a)&&(h="leading"in a?!!a.leading:h,g="trailing"in a?!!a.trailing:g),Hl(r,n,{leading:h,maxWait:n,trailing:g})}function v_(r){return jl(r,1)}function __(r,n){return Cc(dc(n),r)}function m_(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function b_(r){return $r(r,x)}function w_(r,n){return n=typeof n=="function"?n:t,$r(r,x,n)}function E_(r){return $r(r,S|x)}function D_(r,n){return n=typeof n=="function"?n:t,$r(r,S|x,n)}function S_(r,n){return n==null||Ah(r,n,Vt(n))}function Kr(r,n){return r===n||r!==r&&n!==n}var I_=Co(tc),x_=Co(function(r,n){return r>=n}),Zi=Lh(function(){return arguments}())?Lh:function(r){return Pt(r)&&nt.call(r,"callee")&&!Eh.call(r,"callee")},Re=K.isArray,O_=ir?Er(ir):U0;function pr(r){return r!=null&&Mo(r.length)&&!pi(r)}function Rt(r){return Pt(r)&&pr(r)}function P_(r){return r===!0||r===!1||Pt(r)&&nr(r)==F}var $i=Hg||Fc,C_=zr?Er(zr):L0;function A_(r){return Pt(r)&&r.nodeType===1&&!us(r)}function T_(r){if(r==null)return!0;if(pr(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||$i(r)||An(r)||Zi(r)))return!r.length;var n=Xt(r);if(n==Ie||n==xe)return!r.size;if(as(r))return!nc(r).length;for(var a in r)if(nt.call(r,a))return!1;return!0}function R_(r,n){return ns(r,n)}function N_(r,n,a){a=typeof a=="function"?a:t;var h=a?a(r,n):t;return h===t?ns(r,n,t,a):!!h}function Ac(r){if(!Pt(r))return!1;var n=nr(r);return n==T||n==d||typeof r.message=="string"&&typeof r.name=="string"&&!us(r)}function $_(r){return typeof r=="number"&&Sh(r)}function pi(r){if(!wt(r))return!1;var n=nr(r);return n==ae||n==fe||n==H||n==gt}function Kl(r){return typeof r=="number"&&r==Me(r)}function Mo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=V}function wt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function Pt(r){return r!=null&&typeof r=="object"}var Vl=Ar?Er(Ar):M0;function U_(r,n){return r===n||ic(r,n,bc(n))}function L_(r,n,a){return a=typeof a=="function"?a:t,ic(r,n,bc(n),a)}function j_(r){return kl(r)&&r!=+r}function M_(r){if(wy(r))throw new Ae(c);return jh(r)}function q_(r){return r===null}function F_(r){return r==null}function kl(r){return typeof r=="number"||Pt(r)&&nr(r)==He}function us(r){if(!Pt(r)||nr(r)!=je)return!1;var n=ho(r);if(n===null)return!0;var a=nt.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&oo.call(a)==Lg}var Tc=Xr?Er(Xr):q0;function z_(r){return Kl(r)&&r>=-V&&r<=V}var Gl=Wn?Er(Wn):F0;function qo(r){return typeof r=="string"||!Re(r)&&Pt(r)&&nr(r)==Ne}function Sr(r){return typeof r=="symbol"||Pt(r)&&nr(r)==$e}var An=Vi?Er(Vi):z0;function H_(r){return r===t}function B_(r){return Pt(r)&&Xt(r)==Pe}function K_(r){return Pt(r)&&nr(r)==Ue}var V_=Co(sc),k_=Co(function(r,n){return r<=n});function Wl(r){if(!r)return[];if(pr(r))return qo(r)?Hr(r):dr(r);if(Jn&&r[Jn])return Sg(r[Jn]());var n=Xt(r),a=n==Ie?ka:n==xe?io:Tn;return a(r)}function gi(r){if(!r)return r===0?r:0;if(r=jr(r),r===Q||r===-Q){var n=r<0?-1:1;return n*k}return r===r?r:0}function Me(r){var n=gi(r),a=n%1;return n===n?a?n-a:n:0}function Yl(r){return r?Yi(Me(r),0,re):0}function jr(r){if(typeof r=="number")return r;if(Sr(r))return J;if(wt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=wt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=ph(r);var a=wa.test(r);return a||Da.test(r)?Te(r.slice(2),a?2:8):ba.test(r)?J:+r}function Jl(r){return ei(r,gr(r))}function G_(r){return r?Yi(Me(r),-V,V):r===0?r:0}function it(r){return r==null?"":Dr(r)}var W_=On(function(r,n){if(as(n)||pr(n)){ei(n,Vt(n),r);return}for(var a in n)nt.call(n,a)&&ts(r,a,n[a])}),Ql=On(function(r,n){ei(n,gr(n),r)}),Fo=On(function(r,n,a,h){ei(n,gr(n),r,h)}),Y_=On(function(r,n,a,h){ei(n,Vt(n),r,h)}),J_=fi(Xa);function Q_(r,n){var a=xn(r);return n==null?a:Ch(a,n)}var X_=Ke(function(r,n){r=ut(r);var a=-1,h=n.length,g=h>2?n[2]:t;for(g&&sr(n[0],n[1],g)&&(h=1);++a<h;)for(var m=n[a],C=gr(m),N=-1,q=C.length;++N<q;){var X=C[N],Z=r[X];(Z===t||Kr(Z,Dn[X])&&!nt.call(r,X))&&(r[X]=m[X])}return r}),Z_=Ke(function(r){return r.push(t,pl),Kt(Xl,t,r)});function em(r,n){return hh(r,me(n,3),Zr)}function tm(r,n){return hh(r,me(n,3),ec)}function rm(r,n){return r==null?r:Za(r,me(n,3),gr)}function im(r,n){return r==null?r:$h(r,me(n,3),gr)}function nm(r,n){return r&&Zr(r,me(n,3))}function sm(r,n){return r&&ec(r,me(n,3))}function om(r){return r==null?[]:wo(r,Vt(r))}function am(r){return r==null?[]:wo(r,gr(r))}function Rc(r,n,a){var h=r==null?t:Ji(r,n);return h===t?a:h}function cm(r,n){return r!=null&&vl(r,n,T0)}function Nc(r,n){return r!=null&&vl(r,n,R0)}var um=ul(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ao.call(n)),r[n]=a},Uc(yr)),hm=ul(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ao.call(n)),nt.call(r,n)?r[n].push(a):r[n]=[a]},me),lm=Ke(is);function Vt(r){return pr(r)?Oh(r):nc(r)}function gr(r){return pr(r)?Oh(r,!0):H0(r)}function fm(r,n){var a={};return n=me(n,3),Zr(r,function(h,g,m){hi(a,n(h,g,m),h)}),a}function dm(r,n){var a={};return n=me(n,3),Zr(r,function(h,g,m){hi(a,g,n(h,g,m))}),a}var pm=On(function(r,n,a){Eo(r,n,a)}),Xl=On(function(r,n,a,h){Eo(r,n,a,h)}),gm=fi(function(r,n){var a={};if(r==null)return a;var h=!1;n=_t(n,function(m){return m=Ri(m,r),h||(h=m.length>1),m}),ei(r,_c(r),a),h&&(a=$r(a,S|D|x,uy));for(var g=n.length;g--;)hc(a,n[g]);return a});function ym(r,n){return Zl(r,jo(me(n)))}var vm=fi(function(r,n){return r==null?{}:K0(r,n)});function Zl(r,n){if(r==null)return{};var a=_t(_c(r),function(h){return[h]});return n=me(n),Kh(r,a,function(h,g){return n(h,g[0])})}function _m(r,n,a){n=Ri(n,r);var h=-1,g=n.length;for(g||(g=1,r=t);++h<g;){var m=r==null?t:r[ti(n[h])];m===t&&(h=g,m=a),r=pi(m)?m.call(r):m}return r}function mm(r,n,a){return r==null?r:ss(r,n,a)}function bm(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:ss(r,n,a,h)}var ef=fl(Vt),tf=fl(gr);function wm(r,n,a){var h=Re(r),g=h||$i(r)||An(r);if(n=me(n,4),a==null){var m=r&&r.constructor;g?a=h?new m:[]:wt(r)?a=pi(m)?xn(ho(r)):{}:a={}}return(g?Tr:Zr)(r,function(C,N,q){return n(a,C,N,q)}),a}function Em(r,n){return r==null?!0:hc(r,n)}function Dm(r,n,a){return r==null?r:Yh(r,n,dc(a))}function Sm(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:Yh(r,n,dc(a),h)}function Tn(r){return r==null?[]:Va(r,Vt(r))}function Im(r){return r==null?[]:Va(r,gr(r))}function xm(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=jr(a),a=a===a?a:0),n!==t&&(n=jr(n),n=n===n?n:0),Yi(jr(r),n,a)}function Om(r,n,a){return n=gi(n),a===t?(a=n,n=0):a=gi(a),r=jr(r),N0(r,n,a)}function Pm(r,n,a){if(a&&typeof a!="boolean"&&sr(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=gi(r),n===t?(n=r,r=0):n=gi(n)),r>n){var h=r;r=n,n=h}if(a||r%1||n%1){var g=Ih();return Qt(r+g*(n-r+at("1e-"+((g+"").length-1))),n)}return ac(r,n)}var Cm=Pn(function(r,n,a){return n=n.toLowerCase(),r+(a?rf(n):n)});function rf(r){return $c(it(r).toLowerCase())}function nf(r){return r=it(r),r&&r.replace(oi,mg).replace(La,"")}function Am(r,n,a){r=it(r),n=Dr(n);var h=r.length;a=a===t?h:Yi(Me(a),0,h);var g=a;return a-=n.length,a>=0&&r.slice(a,g)==n}function Tm(r){return r=it(r),r&&yt.test(r)?r.replace(Fi,bg):r}function Rm(r){return r=it(r),r&&Lt.test(r)?r.replace(It,"\\$&"):r}var Nm=Pn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),$m=Pn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),Um=ol("toLowerCase");function Lm(r,n,a){r=it(r),n=Me(n);var h=n?wn(r):0;if(!n||h>=n)return r;var g=(n-h)/2;return Po(go(g),a)+r+Po(po(g),a)}function jm(r,n,a){r=it(r),n=Me(n);var h=n?wn(r):0;return n&&h<n?r+Po(n-h,a):r}function Mm(r,n,a){r=it(r),n=Me(n);var h=n?wn(r):0;return n&&h<n?Po(n-h,a)+r:r}function qm(r,n,a){return a||n==null?n=0:n&&(n=+n),kg(it(r).replace(xt,""),n||0)}function Fm(r,n,a){return(a?sr(r,n,a):n===t)?n=1:n=Me(n),cc(it(r),n)}function zm(){var r=arguments,n=it(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var Hm=Pn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function Bm(r,n,a){return a&&typeof a!="number"&&sr(r,n,a)&&(n=a=t),a=a===t?re:a>>>0,a?(r=it(r),r&&(typeof n=="string"||n!=null&&!Tc(n))&&(n=Dr(n),!n&&bn(r))?Ni(Hr(r),0,a):r.split(n,a)):[]}var Km=Pn(function(r,n,a){return r+(a?" ":"")+$c(n)});function Vm(r,n,a){return r=it(r),a=a==null?0:Yi(Me(a),0,r.length),n=Dr(n),r.slice(a,a+n.length)==n}function km(r,n,a){var h=_.templateSettings;a&&sr(r,n,a)&&(n=t),r=it(r),n=Fo({},n,h,dl);var g=Fo({},n.imports,h.imports,dl),m=Vt(g),C=Va(g,m),N,q,X=0,Z=n.interpolate||fn,ie="__p += '",he=Ga((n.escape||fn).source+"|"+Z.source+"|"+(Z===bt?ma:fn).source+"|"+(n.evaluate||fn).source+"|$","g"),ye="//# sourceURL="+(nt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ja+"]")+`
`;r.replace(he,function(De,Ge,Ze,Ir,or,xr){return Ze||(Ze=Ir),ie+=r.slice(X,xr).replace(Ia,wg),Ge&&(N=!0,ie+=`' +
__e(`+Ge+`) +
'`),or&&(q=!0,ie+=`';
`+or+`;
__p += '`),Ze&&(ie+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),X=xr+De.length,De}),ie+=`';
`;var Ee=nt.call(n,"variable")&&n.variable;if(!Ee)ie=`with (obj) {
`+ie+`
}
`;else if(va.test(Ee))throw new Ae(f);ie=(q?ie.replace(Jr,""):ie).replace(rr,"$1").replace(si,"$1;"),ie="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ie+`return __p
}`;var ze=of(function(){return rt(m,ye+"return "+ie).apply(t,C)});if(ze.source=ie,Ac(ze))throw ze;return ze}function Gm(r){return it(r).toLowerCase()}function Wm(r){return it(r).toUpperCase()}function Ym(r,n,a){if(r=it(r),r&&(a||n===t))return ph(r);if(!r||!(n=Dr(n)))return r;var h=Hr(r),g=Hr(n),m=gh(h,g),C=yh(h,g)+1;return Ni(h,m,C).join("")}function Jm(r,n,a){if(r=it(r),r&&(a||n===t))return r.slice(0,_h(r)+1);if(!r||!(n=Dr(n)))return r;var h=Hr(r),g=yh(h,Hr(n))+1;return Ni(h,0,g).join("")}function Qm(r,n,a){if(r=it(r),r&&(a||n===t))return r.replace(xt,"");if(!r||!(n=Dr(n)))return r;var h=Hr(r),g=gh(h,Hr(n));return Ni(h,g).join("")}function Xm(r,n){var a=W,h=se;if(wt(n)){var g="separator"in n?n.separator:g;a="length"in n?Me(n.length):a,h="omission"in n?Dr(n.omission):h}r=it(r);var m=r.length;if(bn(r)){var C=Hr(r);m=C.length}if(a>=m)return r;var N=a-wn(h);if(N<1)return h;var q=C?Ni(C,0,N).join(""):r.slice(0,N);if(g===t)return q+h;if(C&&(N+=q.length-N),Tc(g)){if(r.slice(N).search(g)){var X,Z=q;for(g.global||(g=Ga(g.source,it(Cr.exec(g))+"g")),g.lastIndex=0;X=g.exec(Z);)var ie=X.index;q=q.slice(0,ie===t?N:ie)}}else if(r.indexOf(Dr(g),N)!=N){var he=q.lastIndexOf(g);he>-1&&(q=q.slice(0,he))}return q+h}function Zm(r){return r=it(r),r&&Et.test(r)?r.replace(Si,Pg):r}var eb=Pn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),$c=ol("toUpperCase");function sf(r,n,a){return r=it(r),n=a?t:n,n===t?Dg(r)?Tg(r):pg(r):r.match(n)||[]}var of=Ke(function(r,n){try{return Kt(r,t,n)}catch(a){return Ac(a)?a:new Ae(a)}}),tb=fi(function(r,n){return Tr(n,function(a){a=ti(a),hi(r,a,Pc(r[a],r))}),r});function rb(r){var n=r==null?0:r.length,a=me();return r=n?_t(r,function(h){if(typeof h[1]!="function")throw new Rr(l);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var g=-1;++g<n;){var m=r[g];if(Kt(m[0],this,h))return Kt(m[1],this,h)}})}function ib(r){return P0($r(r,S))}function Uc(r){return function(){return r}}function nb(r,n){return r==null||r!==r?n:r}var sb=cl(),ob=cl(!0);function yr(r){return r}function Lc(r){return Mh(typeof r=="function"?r:$r(r,S))}function ab(r){return Fh($r(r,S))}function cb(r,n){return zh(r,$r(n,S))}var ub=Ke(function(r,n){return function(a){return is(a,r,n)}}),hb=Ke(function(r,n){return function(a){return is(r,a,n)}});function jc(r,n,a){var h=Vt(n),g=wo(n,h);a==null&&!(wt(n)&&(g.length||!h.length))&&(a=n,n=r,r=this,g=wo(n,Vt(n)));var m=!(wt(a)&&"chain"in a)||!!a.chain,C=pi(r);return Tr(g,function(N){var q=n[N];r[N]=q,C&&(r.prototype[N]=function(){var X=this.__chain__;if(m||X){var Z=r(this.__wrapped__),ie=Z.__actions__=dr(this.__actions__);return ie.push({func:q,args:arguments,thisArg:r}),Z.__chain__=X,Z}return q.apply(r,Oi([this.value()],arguments))})}),r}function lb(){return Xe._===this&&(Xe._=jg),this}function Mc(){}function fb(r){return r=Me(r),Ke(function(n){return Hh(n,r)})}var db=gc(_t),pb=gc(uh),gb=gc(Fa);function af(r){return Ec(r)?za(ti(r)):V0(r)}function yb(r){return function(n){return r==null?t:Ji(r,n)}}var vb=hl(),_b=hl(!0);function qc(){return[]}function Fc(){return!1}function mb(){return{}}function bb(){return""}function wb(){return!0}function Eb(r,n){if(r=Me(r),r<1||r>V)return[];var a=re,h=Qt(r,re);n=me(n),r-=re;for(var g=Ka(h,n);++a<r;)n(a);return g}function Db(r){return Re(r)?_t(r,ti):Sr(r)?[r]:dr(xl(it(r)))}function Sb(r){var n=++Ug;return it(r)+n}var Ib=Oo(function(r,n){return r+n},0),xb=yc("ceil"),Ob=Oo(function(r,n){return r/n},1),Pb=yc("floor");function Cb(r){return r&&r.length?bo(r,yr,tc):t}function Ab(r,n){return r&&r.length?bo(r,me(n,2),tc):t}function Tb(r){return fh(r,yr)}function Rb(r,n){return fh(r,me(n,2))}function Nb(r){return r&&r.length?bo(r,yr,sc):t}function $b(r,n){return r&&r.length?bo(r,me(n,2),sc):t}var Ub=Oo(function(r,n){return r*n},1),Lb=yc("round"),jb=Oo(function(r,n){return r-n},0);function Mb(r){return r&&r.length?Ba(r,yr):0}function qb(r,n){return r&&r.length?Ba(r,me(n,2)):0}return _.after=a_,_.ary=jl,_.assign=W_,_.assignIn=Ql,_.assignInWith=Fo,_.assignWith=Y_,_.at=J_,_.before=Ml,_.bind=Pc,_.bindAll=tb,_.bindKey=ql,_.castArray=m_,_.chain=$l,_.chunk=Py,_.compact=Cy,_.concat=Ay,_.cond=rb,_.conforms=ib,_.constant=Uc,_.countBy=Mv,_.create=Q_,_.curry=Fl,_.curryRight=zl,_.debounce=Hl,_.defaults=X_,_.defaultsDeep=Z_,_.defer=c_,_.delay=u_,_.difference=Ty,_.differenceBy=Ry,_.differenceWith=Ny,_.drop=$y,_.dropRight=Uy,_.dropRightWhile=Ly,_.dropWhile=jy,_.fill=My,_.filter=Fv,_.flatMap=Bv,_.flatMapDeep=Kv,_.flatMapDepth=Vv,_.flatten=Al,_.flattenDeep=qy,_.flattenDepth=Fy,_.flip=h_,_.flow=sb,_.flowRight=ob,_.fromPairs=zy,_.functions=om,_.functionsIn=am,_.groupBy=kv,_.initial=By,_.intersection=Ky,_.intersectionBy=Vy,_.intersectionWith=ky,_.invert=um,_.invertBy=hm,_.invokeMap=Wv,_.iteratee=Lc,_.keyBy=Yv,_.keys=Vt,_.keysIn=gr,_.map=$o,_.mapKeys=fm,_.mapValues=dm,_.matches=ab,_.matchesProperty=cb,_.memoize=Lo,_.merge=pm,_.mergeWith=Xl,_.method=ub,_.methodOf=hb,_.mixin=jc,_.negate=jo,_.nthArg=fb,_.omit=gm,_.omitBy=ym,_.once=l_,_.orderBy=Jv,_.over=db,_.overArgs=f_,_.overEvery=pb,_.overSome=gb,_.partial=Cc,_.partialRight=Bl,_.partition=Qv,_.pick=vm,_.pickBy=Zl,_.property=af,_.propertyOf=yb,_.pull=Jy,_.pullAll=Rl,_.pullAllBy=Qy,_.pullAllWith=Xy,_.pullAt=Zy,_.range=vb,_.rangeRight=_b,_.rearg=d_,_.reject=e_,_.remove=ev,_.rest=p_,_.reverse=xc,_.sampleSize=r_,_.set=mm,_.setWith=bm,_.shuffle=i_,_.slice=tv,_.sortBy=o_,_.sortedUniq=cv,_.sortedUniqBy=uv,_.split=Bm,_.spread=g_,_.tail=hv,_.take=lv,_.takeRight=fv,_.takeRightWhile=dv,_.takeWhile=pv,_.tap=Cv,_.throttle=y_,_.thru=No,_.toArray=Wl,_.toPairs=ef,_.toPairsIn=tf,_.toPath=Db,_.toPlainObject=Jl,_.transform=wm,_.unary=v_,_.union=gv,_.unionBy=yv,_.unionWith=vv,_.uniq=_v,_.uniqBy=mv,_.uniqWith=bv,_.unset=Em,_.unzip=Oc,_.unzipWith=Nl,_.update=Dm,_.updateWith=Sm,_.values=Tn,_.valuesIn=Im,_.without=wv,_.words=sf,_.wrap=__,_.xor=Ev,_.xorBy=Dv,_.xorWith=Sv,_.zip=Iv,_.zipObject=xv,_.zipObjectDeep=Ov,_.zipWith=Pv,_.entries=ef,_.entriesIn=tf,_.extend=Ql,_.extendWith=Fo,jc(_,_),_.add=Ib,_.attempt=of,_.camelCase=Cm,_.capitalize=rf,_.ceil=xb,_.clamp=xm,_.clone=b_,_.cloneDeep=E_,_.cloneDeepWith=D_,_.cloneWith=w_,_.conformsTo=S_,_.deburr=nf,_.defaultTo=nb,_.divide=Ob,_.endsWith=Am,_.eq=Kr,_.escape=Tm,_.escapeRegExp=Rm,_.every=qv,_.find=zv,_.findIndex=Pl,_.findKey=em,_.findLast=Hv,_.findLastIndex=Cl,_.findLastKey=tm,_.floor=Pb,_.forEach=Ul,_.forEachRight=Ll,_.forIn=rm,_.forInRight=im,_.forOwn=nm,_.forOwnRight=sm,_.get=Rc,_.gt=I_,_.gte=x_,_.has=cm,_.hasIn=Nc,_.head=Tl,_.identity=yr,_.includes=Gv,_.indexOf=Hy,_.inRange=Om,_.invoke=lm,_.isArguments=Zi,_.isArray=Re,_.isArrayBuffer=O_,_.isArrayLike=pr,_.isArrayLikeObject=Rt,_.isBoolean=P_,_.isBuffer=$i,_.isDate=C_,_.isElement=A_,_.isEmpty=T_,_.isEqual=R_,_.isEqualWith=N_,_.isError=Ac,_.isFinite=$_,_.isFunction=pi,_.isInteger=Kl,_.isLength=Mo,_.isMap=Vl,_.isMatch=U_,_.isMatchWith=L_,_.isNaN=j_,_.isNative=M_,_.isNil=F_,_.isNull=q_,_.isNumber=kl,_.isObject=wt,_.isObjectLike=Pt,_.isPlainObject=us,_.isRegExp=Tc,_.isSafeInteger=z_,_.isSet=Gl,_.isString=qo,_.isSymbol=Sr,_.isTypedArray=An,_.isUndefined=H_,_.isWeakMap=B_,_.isWeakSet=K_,_.join=Gy,_.kebabCase=Nm,_.last=Lr,_.lastIndexOf=Wy,_.lowerCase=$m,_.lowerFirst=Um,_.lt=V_,_.lte=k_,_.max=Cb,_.maxBy=Ab,_.mean=Tb,_.meanBy=Rb,_.min=Nb,_.minBy=$b,_.stubArray=qc,_.stubFalse=Fc,_.stubObject=mb,_.stubString=bb,_.stubTrue=wb,_.multiply=Ub,_.nth=Yy,_.noConflict=lb,_.noop=Mc,_.now=Uo,_.pad=Lm,_.padEnd=jm,_.padStart=Mm,_.parseInt=qm,_.random=Pm,_.reduce=Xv,_.reduceRight=Zv,_.repeat=Fm,_.replace=zm,_.result=_m,_.round=Lb,_.runInContext=M,_.sample=t_,_.size=n_,_.snakeCase=Hm,_.some=s_,_.sortedIndex=rv,_.sortedIndexBy=iv,_.sortedIndexOf=nv,_.sortedLastIndex=sv,_.sortedLastIndexBy=ov,_.sortedLastIndexOf=av,_.startCase=Km,_.startsWith=Vm,_.subtract=jb,_.sum=Mb,_.sumBy=qb,_.template=km,_.times=Eb,_.toFinite=gi,_.toInteger=Me,_.toLength=Yl,_.toLower=Gm,_.toNumber=jr,_.toSafeInteger=G_,_.toString=it,_.toUpper=Wm,_.trim=Ym,_.trimEnd=Jm,_.trimStart=Qm,_.truncate=Xm,_.unescape=Zm,_.uniqueId=Sb,_.upperCase=eb,_.upperFirst=$c,_.each=Ul,_.eachRight=Ll,_.first=Tl,jc(_,function(){var r={};return Zr(_,function(n,a){nt.call(_.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),_.VERSION=s,Tr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){_[r].placeholder=_}),Tr(["drop","take"],function(r,n){Ye.prototype[r]=function(a){a=a===t?1:Bt(Me(a),0);var h=this.__filtered__&&!n?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Qt(a,h.__takeCount__):h.__views__.push({size:Qt(a,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Tr(["filter","map","takeWhile"],function(r,n){var a=n+1,h=a==w||a==ee;Ye.prototype[r]=function(g){var m=this.clone();return m.__iteratees__.push({iteratee:me(g,3),type:a}),m.__filtered__=m.__filtered__||h,m}}),Tr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Tr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(yr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(a){return is(a,r,n)})}),Ye.prototype.reject=function(r){return this.filter(jo(me(r)))},Ye.prototype.slice=function(r,n){r=Me(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=Me(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Zr(Ye.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),g=_[h?"take"+(n=="last"?"Right":""):n],m=h||/^find/.test(n);g&&(_.prototype[n]=function(){var C=this.__wrapped__,N=h?[1]:arguments,q=C instanceof Ye,X=N[0],Z=q||Re(C),ie=function(Ge){var Ze=g.apply(_,Oi([Ge],N));return h&&he?Ze[0]:Ze};Z&&a&&typeof X=="function"&&X.length!=1&&(q=Z=!1);var he=this.__chain__,ye=!!this.__actions__.length,Ee=m&&!he,ze=q&&!ye;if(!m&&Z){C=ze?C:new Ye(this);var De=r.apply(C,N);return De.__actions__.push({func:No,args:[ie],thisArg:t}),new Nr(De,he)}return Ee&&ze?r.apply(this,N):(De=this.thru(ie),Ee?h?De.value()[0]:De.value():De)})}),Tr(["pop","push","shift","sort","splice","unshift"],function(r){var n=no[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);_.prototype[r]=function(){var g=arguments;if(h&&!this.__chain__){var m=this.value();return n.apply(Re(m)?m:[],g)}return this[a](function(C){return n.apply(Re(C)?C:[],g)})}}),Zr(Ye.prototype,function(r,n){var a=_[n];if(a){var h=a.name+"";nt.call(In,h)||(In[h]=[]),In[h].push({name:n,func:a})}}),In[xo(t,ne).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=Zg,Ye.prototype.reverse=e0,Ye.prototype.value=t0,_.prototype.at=Av,_.prototype.chain=Tv,_.prototype.commit=Rv,_.prototype.next=Nv,_.prototype.plant=Uv,_.prototype.reverse=Lv,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=jv,_.prototype.first=_.prototype.head,Jn&&(_.prototype[Jn]=$v),_},En=Rg();Tt?((Tt.exports=En)._=En,ct._=En):Xe._=En}).call(_s)})(ju,ju.exports);var q5=Object.defineProperty,F5=Object.defineProperties,z5=Object.getOwnPropertyDescriptors,Md=Object.getOwnPropertySymbols,H5=Object.prototype.hasOwnProperty,B5=Object.prototype.propertyIsEnumerable,qd=(i,e,t)=>e in i?q5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Vo=(i,e)=>{for(var t in e||(e={}))H5.call(e,t)&&qd(i,t,e[t]);if(Md)for(var t of Md(e))B5.call(e,t)&&qd(i,t,e[t]);return i},K5=(i,e)=>F5(i,z5(e));function ji(i,e,t){var s;const o=TE(i);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${M5}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function ln(i){return i.includes(":")?i.split(":")[1]:i}function ag(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function V5(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function k5(i={},e={}){const t=Fd(i),s=Fd(e);return ju.exports.merge(t,s)}function Fd(i){var e,t,s,o;const c={};if(!Ln(i))return c;for(const[l,f]of Object.entries(i)){const y=Xu(l)?[l]:f.chains,p=f.methods||[],v=f.events||[],S=f.rpcMap||{},D=ms(l);c[D]=K5(Vo(Vo({},c[D]),f),{chains:kc(y,(e=c[D])==null?void 0:e.chains),methods:kc(p,(t=c[D])==null?void 0:t.methods),events:kc(v,(s=c[D])==null?void 0:s.events),rpcMap:Vo(Vo({},S),(o=c[D])==null?void 0:o.rpcMap)})}return c}function G5(i){return i.includes(":")?i.split(":")[2]:i}function W5(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],l=s.accounts||[],f=Xu(t)?[t]:s.chains?s.chains:ag(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:l}}return e}function su(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):i.includes(":")?Number(i.split(":")[1]):Number(i)}const cg={},mt=i=>cg[i],ou=(i,e)=>{cg[i]=e};class Y5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ln(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ei(new qi(s,mt("disableProviderPing")))}}class J5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||ji(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ei(new qi(s,mt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(ln(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class Q5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ln(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ei(new qi(s,mt("disableProviderPing")))}}class X5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ln(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ei(new qi(s,mt("disableProviderPing")))}}class Z5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=ln(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ei(new qi(s,mt("disableProviderPing")))}}class ex{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ln(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ei(new qi(s,mt("disableProviderPing")))}}class tx{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ln(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ei(new qi(s,mt("disableProviderPing")))}}class rx{constructor(e){this.name="near",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||ji(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||ji(e,this.namespace);return typeof s>"u"?void 0:new Ei(new qi(s,mt("disableProviderPing")))}}var ix=Object.defineProperty,nx=Object.defineProperties,sx=Object.getOwnPropertyDescriptors,zd=Object.getOwnPropertySymbols,ox=Object.prototype.hasOwnProperty,ax=Object.prototype.propertyIsEnumerable,Hd=(i,e,t)=>e in i?ix(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ko=(i,e)=>{for(var t in e||(e={}))ox.call(e,t)&&Hd(i,t,e[t]);if(zd)for(var t of zd(e))ax.call(e,t)&&Hd(i,t,e[t]);return i},au=(i,e)=>nx(i,sx(e));class ah{constructor(e){this.events=new zu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Ld})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new ah(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ko({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){const o=new Date().getTime();this.request(e,s).then(c=>t(null,fa(o,c))).catch(c=>t(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ct("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=W5(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==sg)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ni(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await T5.init({logger:this.providerOpts.logger||Ld,relayUrl:this.providerOpts.relayUrl||U5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>ms(t)))];ou("client",this.client),ou("events",this.events),ou("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=V5(t,this.session),o=ag(s),c=k5(this.namespaces,this.optionalNamespaces),l=au(ko({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new J5({namespace:l});break;case"solana":this.rpcProviders[t]=new Q5({namespace:l});break;case"cosmos":this.rpcProviders[t]=new X5({namespace:l});break;case"polkadot":this.rpcProviders[t]=new Y5({namespace:l});break;case"cip34":this.rpcProviders[t]=new Z5({namespace:l});break;case"elrond":this.rpcProviders[t]=new ex({namespace:l});break;case"multiversx":this.rpcProviders[t]=new tx({namespace:l});break;case"near":this.rpcProviders[t]=new rx({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&ni(o)&&this.events.emit("accountsChanged",o.map(G5))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,l=ms(o),f=su(o)!==su(c)?`${l}:${su(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=au(ko({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",au(ko({},Ct("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Di.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(l=>ms(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=ms(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${jd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${jd}/${e}`)}}const cx=ah,ux="wc",hx="ethereum_provider",lx=`${ux}@2:${hx}:`,fx="https://rpc.walletconnect.com/v1/",Mu=["eth_sendTransaction","personal_sign"],dx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],qu=["chainChanged","accountsChanged"],px=["chainChanged","accountsChanged","message","disconnect","connect"];var gx=Object.defineProperty,yx=Object.defineProperties,vx=Object.getOwnPropertyDescriptors,Bd=Object.getOwnPropertySymbols,_x=Object.prototype.hasOwnProperty,mx=Object.prototype.propertyIsEnumerable,Kd=(i,e,t)=>e in i?gx(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ws=(i,e)=>{for(var t in e||(e={}))_x.call(e,t)&&Kd(i,t,e[t]);if(Bd)for(var t of Bd(e))mx.call(e,t)&&Kd(i,t,e[t]);return i},Vd=(i,e)=>yx(i,vx(e));function ia(i){return Number(i[0].split(":")[1])}function cu(i){return`0x${i.toString(16)}`}function bx(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:l,rpcMap:f}=i;if(!ni(e))throw new Error("Invalid chains");const y={chains:e,methods:s||Mu,events:c||qu,rpcMap:ws({},e.length?{[ia(e)]:f[ia(e)]}:{})},p=c==null?void 0:c.filter(x=>!qu.includes(x)),v=s==null?void 0:s.filter(x=>!Mu.includes(x));if(!t&&!l&&!o&&!(p!=null&&p.length)&&!(v!=null&&v.length))return{required:e.length?y:void 0};const S=(p==null?void 0:p.length)&&(v==null?void 0:v.length)||!t,D={chains:[...new Set(S?y.chains.concat(t||[]):t)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:dx))],events:[...new Set(y.events.concat(l!=null&&l.length?l:px))],rpcMap:f};return{required:e.length?y:void 0,optional:t.length?D:void 0}}class ch{constructor(){this.events=new qr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=lx,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new ch;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=bx(this.rpc);try{const o=await new Promise(async(l,f)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Vd(ws({namespaces:ws({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{l(p)}).catch(p=>{f(new Error(p.message))})});if(!o)return;const c=RE(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:cu(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",cu(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Vd(ws({},Ct("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",cu(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Mu:[],y=o.length?(e==null?void 0:e.events)||qu:[],p=(e==null?void 0:e.optionalMethods)||[],v=(e==null?void 0:e.optionalEvents)||[],S=(e==null?void 0:e.rpcMap)||this.buildRpcMap(l,e.projectId),D=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(x=>this.formatChainId(x)),optionalChains:c.map(x=>this.formatChainId(x)),methods:f,events:y,optionalMethods:p,optionalEvents:v,rpcMap:S,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:D,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ia(this.rpc.chains):ia(this.rpc.optionalChains),this.signer=await cx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await zb(()=>import("./index-AAgkM403.js").then(o=>o.i),__vite__mapDeps([0,1,2]));t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(ws({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&ni(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&ni(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${fx}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const Mx=ch;export{Mx as EthereumProvider,px as OPTIONAL_EVENTS,dx as OPTIONAL_METHODS,qu as REQUIRED_EVENTS,Mu as REQUIRED_METHODS,ch as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-AAgkM403.js","assets/index-UlzrWozH.js","assets/index-FoI3ykbO.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}