import{b4 as aa,b5 as tw,b6 as Fi,b7 as Jr,b8 as rw}from"./index-07IEkagI.js";var Vu={exports:{}},Ui=typeof Reflect=="object"?Reflect:null,pf=Ui&&typeof Ui.apply=="function"?Ui.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},Yo;Ui&&typeof Ui.ownKeys=="function"?Yo=Ui.ownKeys:Object.getOwnPropertySymbols?Yo=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Yo=function(e){return Object.getOwnPropertyNames(e)};function nw(n){console&&console.warn&&console.warn(n)}var Zd=Number.isNaN||function(e){return e!==e};function ot(){ot.init.call(this)}Vu.exports=ot;Vu.exports.once=aw;ot.EventEmitter=ot;ot.prototype._events=void 0;ot.prototype._eventsCount=0;ot.prototype._maxListeners=void 0;var gf=10;function ca(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(ot,"defaultMaxListeners",{enumerable:!0,get:function(){return gf},set:function(n){if(typeof n!="number"||n<0||Zd(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");gf=n}});ot.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ot.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Zd(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ep(n){return n._maxListeners===void 0?ot.defaultMaxListeners:n._maxListeners}ot.prototype.getMaxListeners=function(){return ep(this)};ot.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var o=e==="error",c=this._events;if(c!==void 0)o=o&&c.error===void 0;else if(!o)return!1;if(o){var h;if(t.length>0&&(h=t[0]),h instanceof Error)throw h;var f=new Error("Unhandled error."+(h?" ("+h.message+")":""));throw f.context=h,f}var g=c[e];if(g===void 0)return!1;if(typeof g=="function")pf(g,this,t);else for(var p=g.length,v=sp(g,p),i=0;i<p;++i)pf(v[i],this,t);return!0};function tp(n,e,t,i){var o,c,h;if(ca(t),c=n._events,c===void 0?(c=n._events=Object.create(null),n._eventsCount=0):(c.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),c=n._events),h=c[e]),h===void 0)h=c[e]=t,++n._eventsCount;else if(typeof h=="function"?h=c[e]=i?[t,h]:[h,t]:i?h.unshift(t):h.push(t),o=ep(n),o>0&&h.length>o&&!h.warned){h.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=n,f.type=e,f.count=h.length,nw(f)}return n}ot.prototype.addListener=function(e,t){return tp(this,e,t,!1)};ot.prototype.on=ot.prototype.addListener;ot.prototype.prependListener=function(e,t){return tp(this,e,t,!0)};function iw(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function rp(n,e,t){var i={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},o=iw.bind(i);return o.listener=t,i.wrapFn=o,o}ot.prototype.once=function(e,t){return ca(t),this.on(e,rp(this,e,t)),this};ot.prototype.prependOnceListener=function(e,t){return ca(t),this.prependListener(e,rp(this,e,t)),this};ot.prototype.removeListener=function(e,t){var i,o,c,h,f;if(ca(t),o=this._events,o===void 0)return this;if(i=o[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(c=-1,h=i.length-1;h>=0;h--)if(i[h]===t||i[h].listener===t){f=i[h].listener,c=h;break}if(c<0)return this;c===0?i.shift():sw(i,c),i.length===1&&(o[e]=i[0]),o.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this};ot.prototype.off=ot.prototype.removeListener;ot.prototype.removeAllListeners=function(e){var t,i,o;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var c=Object.keys(i),h;for(o=0;o<c.length;++o)h=c[o],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this};function np(n,e,t){var i=n._events;if(i===void 0)return[];var o=i[e];return o===void 0?[]:typeof o=="function"?t?[o.listener||o]:[o]:t?ow(o):sp(o,o.length)}ot.prototype.listeners=function(e){return np(this,e,!0)};ot.prototype.rawListeners=function(e){return np(this,e,!1)};ot.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):ip.call(n,e)};ot.prototype.listenerCount=ip;function ip(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}ot.prototype.eventNames=function(){return this._eventsCount>0?Yo(this._events):[]};function sp(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n[i];return t}function sw(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function ow(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function aw(n,e){return new Promise(function(t,i){function o(h){n.removeListener(e,c),i(h)}function c(){typeof n.removeListener=="function"&&n.removeListener("error",o),t([].slice.call(arguments))}op(n,e,c,{once:!0}),e!=="error"&&cw(n,o,{once:!0})})}function cw(n,e,t){typeof n.on=="function"&&op(n,"error",e,t)}function op(n,e,t,i){if(typeof n.on=="function")i.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function o(c){i.once&&n.removeEventListener(e,o),t(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var Cr=Vu.exports;const ku=aa(Cr);var Gu={},ua={},Ue={},ap={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(f,g){var p=f>>>16&65535,v=f&65535,S=g>>>16&65535,D=g&65535;return v*D+(p*D+v*S<<16>>>0)|0}n.mul=Math.imul||e;function t(f,g){return f+g|0}n.add=t;function i(f,g){return f-g|0}n.sub=i;function o(f,g){return f<<g|f>>>32-g}n.rotl=o;function c(f,g){return f<<32-g|f>>>g}n.rotr=c;function h(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||h,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(ap);Object.defineProperty(Ue,"__esModule",{value:!0});var cp=ap;function uw(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}Ue.readInt16BE=uw;function hw(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}Ue.readUint16BE=hw;function lw(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}Ue.readInt16LE=lw;function fw(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}Ue.readUint16LE=fw;function up(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>8,e[t+1]=n>>>0,e}Ue.writeUint16BE=up;Ue.writeInt16BE=up;function hp(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e}Ue.writeUint16LE=hp;Ue.writeInt16LE=hp;function pu(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}Ue.readInt32BE=pu;function gu(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}Ue.readUint32BE=gu;function yu(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}Ue.readInt32LE=yu;function vu(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}Ue.readUint32LE=vu;function ea(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>24,e[t+1]=n>>>16,e[t+2]=n>>>8,e[t+3]=n>>>0,e}Ue.writeUint32BE=ea;Ue.writeInt32BE=ea;function ta(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e[t+2]=n>>>16,e[t+3]=n>>>24,e}Ue.writeUint32LE=ta;Ue.writeInt32LE=ta;function dw(n,e){e===void 0&&(e=0);var t=pu(n,e),i=pu(n,e+4);return t*4294967296+i-(i>>31)*4294967296}Ue.readInt64BE=dw;function pw(n,e){e===void 0&&(e=0);var t=gu(n,e),i=gu(n,e+4);return t*4294967296+i}Ue.readUint64BE=pw;function gw(n,e){e===void 0&&(e=0);var t=yu(n,e),i=yu(n,e+4);return i*4294967296+t-(t>>31)*4294967296}Ue.readInt64LE=gw;function yw(n,e){e===void 0&&(e=0);var t=vu(n,e),i=vu(n,e+4);return i*4294967296+t}Ue.readUint64LE=yw;function lp(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ea(n/4294967296>>>0,e,t),ea(n>>>0,e,t+4),e}Ue.writeUint64BE=lp;Ue.writeInt64BE=lp;function fp(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ta(n>>>0,e,t),ta(n/4294967296>>>0,e,t+4),e}Ue.writeUint64LE=fp;Ue.writeInt64LE=fp;function vw(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,o=1,c=n/8+t-1;c>=t;c--)i+=e[c]*o,o*=256;return i}Ue.readUintBE=vw;function _w(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,o=1,c=t;c<t+n/8;c++)i+=e[c]*o,o*=256;return i}Ue.readUintLE=_w;function mw(n,e,t,i){if(t===void 0&&(t=new Uint8Array(n/8)),i===void 0&&(i=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!cp.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=n/8+i-1;c>=i;c--)t[c]=e/o&255,o*=256;return t}Ue.writeUintBE=mw;function bw(n,e,t,i){if(t===void 0&&(t=new Uint8Array(n/8)),i===void 0&&(i=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!cp.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=i;c<i+n/8;c++)t[c]=e/o&255,o*=256;return t}Ue.writeUintLE=bw;function ww(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e)}Ue.readFloat32BE=ww;function Ew(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e,!0)}Ue.readFloat32LE=Ew;function Dw(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e)}Ue.readFloat64BE=Dw;function Sw(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e,!0)}Ue.readFloat64LE=Sw;function Iw(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,n),e}Ue.writeFloat32BE=Iw;function xw(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,n,!0),e}Ue.writeFloat32LE=xw;function Ow(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,n),e}Ue.writeFloat64BE=Ow;function Pw(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,n,!0),e}Ue.writeFloat64LE=Pw;var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});function Cw(n){for(var e=0;e<n.length;e++)n[e]=0;return n}Ar.wipe=Cw;Object.defineProperty(ua,"__esModule",{value:!0});var er=Ue,_u=Ar,Aw=20;function Tw(n,e,t){for(var i=1634760805,o=857760878,c=2036477234,h=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],g=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],v=t[15]<<24|t[14]<<16|t[13]<<8|t[12],S=t[19]<<24|t[18]<<16|t[17]<<8|t[16],D=t[23]<<24|t[22]<<16|t[21]<<8|t[20],x=t[27]<<24|t[26]<<16|t[25]<<8|t[24],O=t[31]<<24|t[30]<<16|t[29]<<8|t[28],z=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ie=e[11]<<24|e[10]<<16|e[9]<<8|e[8],$=e[15]<<24|e[14]<<16|e[13]<<8|e[12],U=i,P=o,R=c,E=h,u=f,b=g,G=p,W=v,se=S,ce=D,de=x,w=O,A=z,ee=B,Q=ie,V=$,k=0;k<Aw;k+=2)U=U+u|0,A^=U,A=A>>>16|A<<16,se=se+A|0,u^=se,u=u>>>20|u<<12,P=P+b|0,ee^=P,ee=ee>>>16|ee<<16,ce=ce+ee|0,b^=ce,b=b>>>20|b<<12,R=R+G|0,Q^=R,Q=Q>>>16|Q<<16,de=de+Q|0,G^=de,G=G>>>20|G<<12,E=E+W|0,V^=E,V=V>>>16|V<<16,w=w+V|0,W^=w,W=W>>>20|W<<12,R=R+G|0,Q^=R,Q=Q>>>24|Q<<8,de=de+Q|0,G^=de,G=G>>>25|G<<7,E=E+W|0,V^=E,V=V>>>24|V<<8,w=w+V|0,W^=w,W=W>>>25|W<<7,P=P+b|0,ee^=P,ee=ee>>>24|ee<<8,ce=ce+ee|0,b^=ce,b=b>>>25|b<<7,U=U+u|0,A^=U,A=A>>>24|A<<8,se=se+A|0,u^=se,u=u>>>25|u<<7,U=U+b|0,V^=U,V=V>>>16|V<<16,de=de+V|0,b^=de,b=b>>>20|b<<12,P=P+G|0,A^=P,A=A>>>16|A<<16,w=w+A|0,G^=w,G=G>>>20|G<<12,R=R+W|0,ee^=R,ee=ee>>>16|ee<<16,se=se+ee|0,W^=se,W=W>>>20|W<<12,E=E+u|0,Q^=E,Q=Q>>>16|Q<<16,ce=ce+Q|0,u^=ce,u=u>>>20|u<<12,R=R+W|0,ee^=R,ee=ee>>>24|ee<<8,se=se+ee|0,W^=se,W=W>>>25|W<<7,E=E+u|0,Q^=E,Q=Q>>>24|Q<<8,ce=ce+Q|0,u^=ce,u=u>>>25|u<<7,P=P+G|0,A^=P,A=A>>>24|A<<8,w=w+A|0,G^=w,G=G>>>25|G<<7,U=U+b|0,V^=U,V=V>>>24|V<<8,de=de+V|0,b^=de,b=b>>>25|b<<7;er.writeUint32LE(U+i|0,n,0),er.writeUint32LE(P+o|0,n,4),er.writeUint32LE(R+c|0,n,8),er.writeUint32LE(E+h|0,n,12),er.writeUint32LE(u+f|0,n,16),er.writeUint32LE(b+g|0,n,20),er.writeUint32LE(G+p|0,n,24),er.writeUint32LE(W+v|0,n,28),er.writeUint32LE(se+S|0,n,32),er.writeUint32LE(ce+D|0,n,36),er.writeUint32LE(de+x|0,n,40),er.writeUint32LE(w+O|0,n,44),er.writeUint32LE(A+z|0,n,48),er.writeUint32LE(ee+B|0,n,52),er.writeUint32LE(Q+ie|0,n,56),er.writeUint32LE(V+$|0,n,60)}function dp(n,e,t,i,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,h;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),h=c.length-e.length,c.set(e,h)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,h=o}for(var f=new Uint8Array(64),g=0;g<t.length;g+=64){Tw(f,c,n);for(var p=g;p<g+64&&p<t.length;p++)i[p]=t[p]^f[p-g];Nw(c,0,h)}return _u.wipe(f),o===0&&_u.wipe(c),i}ua.streamXOR=dp;function Rw(n,e,t,i){return i===void 0&&(i=0),_u.wipe(t),dp(n,e,t,t,i)}ua.stream=Rw;function Nw(n,e,t){for(var i=1;t--;)i=i+(n[e]&255)|0,n[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var pp={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});function $w(n,e,t){return~(n-1)&e|n-1&t}Fn.select=$w;function Lw(n,e){return(n|0)-(e|0)-1>>>31&1}Fn.lessOrEqual=Lw;function gp(n,e){if(n.length!==e.length)return 0;for(var t=0,i=0;i<n.length;i++)t|=n[i]^e[i];return 1&t-1>>>8}Fn.compare=gp;function Uw(n,e){return n.length===0||e.length===0?!1:gp(n,e)!==0}Fn.equal=Uw;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Fn,t=Ar;n.DIGEST_LENGTH=16;var i=function(){function h(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=f[0]|f[1]<<8;this._r[0]=g&8191;var p=f[2]|f[3]<<8;this._r[1]=(g>>>13|p<<3)&8191;var v=f[4]|f[5]<<8;this._r[2]=(p>>>10|v<<6)&7939;var S=f[6]|f[7]<<8;this._r[3]=(v>>>7|S<<9)&8191;var D=f[8]|f[9]<<8;this._r[4]=(S>>>4|D<<12)&255,this._r[5]=D>>>1&8190;var x=f[10]|f[11]<<8;this._r[6]=(D>>>14|x<<2)&8191;var O=f[12]|f[13]<<8;this._r[7]=(x>>>11|O<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(O>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return h.prototype._blocks=function(f,g,p){for(var v=this._fin?0:2048,S=this._h[0],D=this._h[1],x=this._h[2],O=this._h[3],z=this._h[4],B=this._h[5],ie=this._h[6],$=this._h[7],U=this._h[8],P=this._h[9],R=this._r[0],E=this._r[1],u=this._r[2],b=this._r[3],G=this._r[4],W=this._r[5],se=this._r[6],ce=this._r[7],de=this._r[8],w=this._r[9];p>=16;){var A=f[g+0]|f[g+1]<<8;S+=A&8191;var ee=f[g+2]|f[g+3]<<8;D+=(A>>>13|ee<<3)&8191;var Q=f[g+4]|f[g+5]<<8;x+=(ee>>>10|Q<<6)&8191;var V=f[g+6]|f[g+7]<<8;O+=(Q>>>7|V<<9)&8191;var k=f[g+8]|f[g+9]<<8;z+=(V>>>4|k<<12)&8191,B+=k>>>1&8191;var J=f[g+10]|f[g+11]<<8;ie+=(k>>>14|J<<2)&8191;var re=f[g+12]|f[g+13]<<8;$+=(J>>>11|re<<5)&8191;var be=f[g+14]|f[g+15]<<8;U+=(re>>>8|be<<8)&8191,P+=be>>>5|v;var oe=0,we=oe;we+=S*R,we+=D*(5*w),we+=x*(5*de),we+=O*(5*ce),we+=z*(5*se),oe=we>>>13,we&=8191,we+=B*(5*W),we+=ie*(5*G),we+=$*(5*b),we+=U*(5*u),we+=P*(5*E),oe+=we>>>13,we&=8191;var le=oe;le+=S*E,le+=D*R,le+=x*(5*w),le+=O*(5*de),le+=z*(5*ce),oe=le>>>13,le&=8191,le+=B*(5*se),le+=ie*(5*W),le+=$*(5*G),le+=U*(5*b),le+=P*(5*u),oe+=le>>>13,le&=8191;var _e=oe;_e+=S*u,_e+=D*E,_e+=x*R,_e+=O*(5*w),_e+=z*(5*de),oe=_e>>>13,_e&=8191,_e+=B*(5*ce),_e+=ie*(5*se),_e+=$*(5*W),_e+=U*(5*G),_e+=P*(5*b),oe+=_e>>>13,_e&=8191;var H=oe;H+=S*b,H+=D*u,H+=x*E,H+=O*R,H+=z*(5*w),oe=H>>>13,H&=8191,H+=B*(5*de),H+=ie*(5*ce),H+=$*(5*se),H+=U*(5*W),H+=P*(5*G),oe+=H>>>13,H&=8191;var F=oe;F+=S*G,F+=D*b,F+=x*u,F+=O*E,F+=z*R,oe=F>>>13,F&=8191,F+=B*(5*w),F+=ie*(5*de),F+=$*(5*ce),F+=U*(5*se),F+=P*(5*W),oe+=F>>>13,F&=8191;var L=oe;L+=S*W,L+=D*G,L+=x*b,L+=O*u,L+=z*E,oe=L>>>13,L&=8191,L+=B*R,L+=ie*(5*w),L+=$*(5*de),L+=U*(5*ce),L+=P*(5*se),oe+=L>>>13,L&=8191;var d=oe;d+=S*se,d+=D*W,d+=x*G,d+=O*b,d+=z*u,oe=d>>>13,d&=8191,d+=B*E,d+=ie*R,d+=$*(5*w),d+=U*(5*de),d+=P*(5*ce),oe+=d>>>13,d&=8191;var T=oe;T+=S*ce,T+=D*se,T+=x*W,T+=O*G,T+=z*b,oe=T>>>13,T&=8191,T+=B*u,T+=ie*E,T+=$*R,T+=U*(5*w),T+=P*(5*de),oe+=T>>>13,T&=8191;var ae=oe;ae+=S*de,ae+=D*ce,ae+=x*se,ae+=O*W,ae+=z*G,oe=ae>>>13,ae&=8191,ae+=B*b,ae+=ie*u,ae+=$*E,ae+=U*R,ae+=P*(5*w),oe+=ae>>>13,ae&=8191;var fe=oe;fe+=S*w,fe+=D*de,fe+=x*ce,fe+=O*se,fe+=z*W,oe=fe>>>13,fe&=8191,fe+=B*G,fe+=ie*b,fe+=$*u,fe+=U*E,fe+=P*R,oe+=fe>>>13,fe&=8191,oe=(oe<<2)+oe|0,oe=oe+we|0,we=oe&8191,oe=oe>>>13,le+=oe,S=we,D=le,x=_e,O=H,z=F,B=L,ie=d,$=T,U=ae,P=fe,g+=16,p-=16}this._h[0]=S,this._h[1]=D,this._h[2]=x,this._h[3]=O,this._h[4]=z,this._h[5]=B,this._h[6]=ie,this._h[7]=$,this._h[8]=U,this._h[9]=P},h.prototype.finish=function(f,g){g===void 0&&(g=0);var p=new Uint16Array(10),v,S,D,x;if(this._leftover){for(x=this._leftover,this._buffer[x++]=1;x<16;x++)this._buffer[x]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(v=this._h[1]>>>13,this._h[1]&=8191,x=2;x<10;x++)this._h[x]+=v,v=this._h[x]>>>13,this._h[x]&=8191;for(this._h[0]+=v*5,v=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=v,v=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=v,p[0]=this._h[0]+5,v=p[0]>>>13,p[0]&=8191,x=1;x<10;x++)p[x]=this._h[x]+v,v=p[x]>>>13,p[x]&=8191;for(p[9]-=8192,S=(v^1)-1,x=0;x<10;x++)p[x]&=S;for(S=~S,x=0;x<10;x++)this._h[x]=this._h[x]&S|p[x];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,D=this._h[0]+this._pad[0],this._h[0]=D&65535,x=1;x<8;x++)D=(this._h[x]+this._pad[x]|0)+(D>>>16)|0,this._h[x]=D&65535;return f[g+0]=this._h[0]>>>0,f[g+1]=this._h[0]>>>8,f[g+2]=this._h[1]>>>0,f[g+3]=this._h[1]>>>8,f[g+4]=this._h[2]>>>0,f[g+5]=this._h[2]>>>8,f[g+6]=this._h[3]>>>0,f[g+7]=this._h[3]>>>8,f[g+8]=this._h[4]>>>0,f[g+9]=this._h[4]>>>8,f[g+10]=this._h[5]>>>0,f[g+11]=this._h[5]>>>8,f[g+12]=this._h[6]>>>0,f[g+13]=this._h[6]>>>8,f[g+14]=this._h[7]>>>0,f[g+15]=this._h[7]>>>8,this._finished=!0,this},h.prototype.update=function(f){var g=0,p=f.length,v;if(this._leftover){v=16-this._leftover,v>p&&(v=p);for(var S=0;S<v;S++)this._buffer[this._leftover+S]=f[g+S];if(p-=v,g+=v,this._leftover+=v,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(v=p-p%16,this._blocks(f,g,v),g+=v,p-=v),p){for(var S=0;S<p;S++)this._buffer[this._leftover+S]=f[g+S];this._leftover+=p}return this},h.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},h.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},h}();n.Poly1305=i;function o(h,f){var g=new i(h);g.update(f);var p=g.digest();return g.clean(),p}n.oneTimeAuth=o;function c(h,f){return h.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:e.equal(h,f)}n.equal=c})(pp);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=ua,t=pp,i=Ar,o=Ue,c=Fn;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var h=new Uint8Array(16),f=function(){function g(p){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,p.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return g.prototype.seal=function(p,v,S,D){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var x=new Uint8Array(16);x.set(p,x.length-p.length);var O=new Uint8Array(32);e.stream(this._key,x,O,4);var z=v.length+this.tagLength,B;if(D){if(D.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");B=D}else B=new Uint8Array(z);return e.streamXOR(this._key,x,v,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),O,B.subarray(0,B.length-this.tagLength),S),i.wipe(x),B},g.prototype.open=function(p,v,S,D){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(v.length<this.tagLength)return null;var x=new Uint8Array(16);x.set(p,x.length-p.length);var O=new Uint8Array(32);e.stream(this._key,x,O,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,O,v.subarray(0,v.length-this.tagLength),S),!c.equal(z,v.subarray(v.length-this.tagLength,v.length)))return null;var B=v.length-this.tagLength,ie;if(D){if(D.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=D}else ie=new Uint8Array(B);return e.streamXOR(this._key,x,v.subarray(0,v.length-this.tagLength),ie,4),i.wipe(x),ie},g.prototype.clean=function(){return i.wipe(this._key),this},g.prototype._authenticate=function(p,v,S,D){var x=new t.Poly1305(v);D&&(x.update(D),D.length%16>0&&x.update(h.subarray(D.length%16))),x.update(S),S.length%16>0&&x.update(h.subarray(S.length%16));var O=new Uint8Array(8);D&&o.writeUint64LE(D.length,O),x.update(O),o.writeUint64LE(S.length,O),x.update(O);for(var z=x.digest(),B=0;B<z.length;B++)p[B]=z[B];x.clean(),i.wipe(z),i.wipe(O)},g}();n.ChaCha20Poly1305=f})(Gu);var yp={},Ts={},Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});function jw(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}Wu.isSerializableHash=jw;Object.defineProperty(Ts,"__esModule",{value:!0});var nn=Wu,Mw=Fn,qw=Ar,vp=function(){function n(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var o=0;o<i.length;o++)i[o]^=54;this._inner.update(i);for(var o=0;o<i.length;o++)i[o]^=106;this._outer.update(i),nn.isSerializableHash(this._inner)&&nn.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),qw.wipe(i)}return n.prototype.reset=function(){if(!nn.isSerializableHash(this._inner)||!nn.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){nn.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),nn.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!nn.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!nn.isSerializableHash(this._inner)||!nn.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!nn.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();Ts.HMAC=vp;function Fw(n,e,t){var i=new vp(n,e);i.update(t);var o=i.digest();return i.clean(),o}Ts.hmac=Fw;Ts.equal=Mw.equal;Object.defineProperty(yp,"__esModule",{value:!0});var yf=Ts,vf=Ar,zw=function(){function n(e,t,i,o){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=yf.hmac(this._hash,i,t);this._hmac=new yf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},n.prototype.clean=function(){this._hmac.clean(),vf.wipe(this._buffer),vf.wipe(this._counter),this._bufpos=0},n}(),Hw=yp.HKDF=zw,zi={},ha={},la={};Object.defineProperty(la,"__esModule",{value:!0});la.BrowserRandomSource=void 0;const _f=65536;class Bw{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let i=0;i<t.length;i+=_f)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,_f)));return t}}la.BrowserRandomSource=Bw;function Kw(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fa={};Object.defineProperty(fa,"__esModule",{value:!0});fa.NodeRandomSource=void 0;const Vw=Ar;class kw{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Kw<"u"){const e=tw;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let o=0;o<i.length;o++)i[o]=t[o];return(0,Vw.wipe)(t),i}}fa.NodeRandomSource=kw;Object.defineProperty(ha,"__esModule",{value:!0});ha.SystemRandomSource=void 0;const Gw=la,Ww=fa;class Yw{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Gw.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Ww.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ha.SystemRandomSource=Yw;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=ha,t=Ue,i=Ar;n.defaultRandomSource=new e.SystemRandomSource;function o(p,v=n.defaultRandomSource){return v.randomBytes(p)}n.randomBytes=o;function c(p=n.defaultRandomSource){const v=o(4,p),S=(0,t.readUint32LE)(v);return(0,i.wipe)(v),S}n.randomUint32=c;const h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(p,v=h,S=n.defaultRandomSource){if(v.length<2)throw new Error("randomString charset is too short");if(v.length>256)throw new Error("randomString charset is too long");let D="";const x=v.length,O=256-256%x;for(;p>0;){const z=o(Math.ceil(p*256/O),S);for(let B=0;B<z.length&&p>0;B++){const ie=z[B];ie<O&&(D+=v.charAt(ie%x),p--)}(0,i.wipe)(z)}return D}n.randomString=f;function g(p,v=h,S=n.defaultRandomSource){const D=Math.ceil(p/(Math.log(v.length)/Math.LN2));return f(D,v,S)}n.randomStringForEntropy=g})(zi);var da={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ue,t=Ar;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var i=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(g,p){if(p===void 0&&(p=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=g[v++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._temp,this._state,g,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=g[v++],p--;return this},f.prototype.finish=function(g){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,S=p/536870912|0,D=p<<3,x=p%64<56?64:128;this._buffer[v]=128;for(var O=v+1;O<x-8;O++)this._buffer[O]=0;e.writeUint32BE(S,this._buffer,x-8),e.writeUint32BE(D,this._buffer,x-4),c(this._temp,this._state,this._buffer,0,x),this._finished=!0}for(var O=0;O<this.digestLength/4;O++)e.writeUint32BE(this._state[O],g,O*4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.state),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();n.SHA256=i;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,g,p,v,S){for(;S>=64;){for(var D=g[0],x=g[1],O=g[2],z=g[3],B=g[4],ie=g[5],$=g[6],U=g[7],P=0;P<16;P++){var R=v+P*4;f[P]=e.readUint32BE(p,R)}for(var P=16;P<64;P++){var E=f[P-2],u=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=f[P-15];var b=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;f[P]=(u+f[P-7]|0)+(b+f[P-16]|0)}for(var P=0;P<64;P++){var u=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&ie^~B&$)|0)+(U+(o[P]+f[P]|0)|0)|0,b=((D>>>2|D<<30)^(D>>>13|D<<19)^(D>>>22|D<<10))+(D&x^D&O^x&O)|0;U=$,$=ie,ie=B,B=z+u|0,z=O,O=x,x=D,D=u+b|0}g[0]+=D,g[1]+=x,g[2]+=O,g[3]+=z,g[4]+=B,g[5]+=ie,g[6]+=$,g[7]+=U,v+=64,S-=64}return v}function h(f){var g=new i;g.update(f);var p=g.digest();return g.clean(),p}n.hash=h})(da);var Yu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=zi,t=Ar;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function i(P){const R=new Float64Array(16);if(P)for(let E=0;E<P.length;E++)R[E]=P[E];return R}const o=new Uint8Array(32);o[0]=9;const c=i([56129,1]);function h(P){let R=1;for(let E=0;E<16;E++){let u=P[E]+R+65535;R=Math.floor(u/65536),P[E]=u-R*65536}P[0]+=R-1+37*(R-1)}function f(P,R,E){const u=~(E-1);for(let b=0;b<16;b++){const G=u&(P[b]^R[b]);P[b]^=G,R[b]^=G}}function g(P,R){const E=i(),u=i();for(let b=0;b<16;b++)u[b]=R[b];h(u),h(u),h(u);for(let b=0;b<2;b++){E[0]=u[0]-65517;for(let W=1;W<15;W++)E[W]=u[W]-65535-(E[W-1]>>16&1),E[W-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const G=E[15]>>16&1;E[14]&=65535,f(u,E,1-G)}for(let b=0;b<16;b++)P[2*b]=u[b]&255,P[2*b+1]=u[b]>>8}function p(P,R){for(let E=0;E<16;E++)P[E]=R[2*E]+(R[2*E+1]<<8);P[15]&=32767}function v(P,R,E){for(let u=0;u<16;u++)P[u]=R[u]+E[u]}function S(P,R,E){for(let u=0;u<16;u++)P[u]=R[u]-E[u]}function D(P,R,E){let u,b,G=0,W=0,se=0,ce=0,de=0,w=0,A=0,ee=0,Q=0,V=0,k=0,J=0,re=0,be=0,oe=0,we=0,le=0,_e=0,H=0,F=0,L=0,d=0,T=0,ae=0,fe=0,Ie=0,He=0,Ve=0,je=0,gt=0,yt=0,qe=E[0],xe=E[1],Ne=E[2],$e=E[3],Fe=E[4],Pe=E[5],Le=E[6],Se=E[7],Ce=E[8],Be=E[9],Oe=E[10],ke=E[11],We=E[12],et=E[13],tt=E[14],Qe=E[15];u=R[0],G+=u*qe,W+=u*xe,se+=u*Ne,ce+=u*$e,de+=u*Fe,w+=u*Pe,A+=u*Le,ee+=u*Se,Q+=u*Ce,V+=u*Be,k+=u*Oe,J+=u*ke,re+=u*We,be+=u*et,oe+=u*tt,we+=u*Qe,u=R[1],W+=u*qe,se+=u*xe,ce+=u*Ne,de+=u*$e,w+=u*Fe,A+=u*Pe,ee+=u*Le,Q+=u*Se,V+=u*Ce,k+=u*Be,J+=u*Oe,re+=u*ke,be+=u*We,oe+=u*et,we+=u*tt,le+=u*Qe,u=R[2],se+=u*qe,ce+=u*xe,de+=u*Ne,w+=u*$e,A+=u*Fe,ee+=u*Pe,Q+=u*Le,V+=u*Se,k+=u*Ce,J+=u*Be,re+=u*Oe,be+=u*ke,oe+=u*We,we+=u*et,le+=u*tt,_e+=u*Qe,u=R[3],ce+=u*qe,de+=u*xe,w+=u*Ne,A+=u*$e,ee+=u*Fe,Q+=u*Pe,V+=u*Le,k+=u*Se,J+=u*Ce,re+=u*Be,be+=u*Oe,oe+=u*ke,we+=u*We,le+=u*et,_e+=u*tt,H+=u*Qe,u=R[4],de+=u*qe,w+=u*xe,A+=u*Ne,ee+=u*$e,Q+=u*Fe,V+=u*Pe,k+=u*Le,J+=u*Se,re+=u*Ce,be+=u*Be,oe+=u*Oe,we+=u*ke,le+=u*We,_e+=u*et,H+=u*tt,F+=u*Qe,u=R[5],w+=u*qe,A+=u*xe,ee+=u*Ne,Q+=u*$e,V+=u*Fe,k+=u*Pe,J+=u*Le,re+=u*Se,be+=u*Ce,oe+=u*Be,we+=u*Oe,le+=u*ke,_e+=u*We,H+=u*et,F+=u*tt,L+=u*Qe,u=R[6],A+=u*qe,ee+=u*xe,Q+=u*Ne,V+=u*$e,k+=u*Fe,J+=u*Pe,re+=u*Le,be+=u*Se,oe+=u*Ce,we+=u*Be,le+=u*Oe,_e+=u*ke,H+=u*We,F+=u*et,L+=u*tt,d+=u*Qe,u=R[7],ee+=u*qe,Q+=u*xe,V+=u*Ne,k+=u*$e,J+=u*Fe,re+=u*Pe,be+=u*Le,oe+=u*Se,we+=u*Ce,le+=u*Be,_e+=u*Oe,H+=u*ke,F+=u*We,L+=u*et,d+=u*tt,T+=u*Qe,u=R[8],Q+=u*qe,V+=u*xe,k+=u*Ne,J+=u*$e,re+=u*Fe,be+=u*Pe,oe+=u*Le,we+=u*Se,le+=u*Ce,_e+=u*Be,H+=u*Oe,F+=u*ke,L+=u*We,d+=u*et,T+=u*tt,ae+=u*Qe,u=R[9],V+=u*qe,k+=u*xe,J+=u*Ne,re+=u*$e,be+=u*Fe,oe+=u*Pe,we+=u*Le,le+=u*Se,_e+=u*Ce,H+=u*Be,F+=u*Oe,L+=u*ke,d+=u*We,T+=u*et,ae+=u*tt,fe+=u*Qe,u=R[10],k+=u*qe,J+=u*xe,re+=u*Ne,be+=u*$e,oe+=u*Fe,we+=u*Pe,le+=u*Le,_e+=u*Se,H+=u*Ce,F+=u*Be,L+=u*Oe,d+=u*ke,T+=u*We,ae+=u*et,fe+=u*tt,Ie+=u*Qe,u=R[11],J+=u*qe,re+=u*xe,be+=u*Ne,oe+=u*$e,we+=u*Fe,le+=u*Pe,_e+=u*Le,H+=u*Se,F+=u*Ce,L+=u*Be,d+=u*Oe,T+=u*ke,ae+=u*We,fe+=u*et,Ie+=u*tt,He+=u*Qe,u=R[12],re+=u*qe,be+=u*xe,oe+=u*Ne,we+=u*$e,le+=u*Fe,_e+=u*Pe,H+=u*Le,F+=u*Se,L+=u*Ce,d+=u*Be,T+=u*Oe,ae+=u*ke,fe+=u*We,Ie+=u*et,He+=u*tt,Ve+=u*Qe,u=R[13],be+=u*qe,oe+=u*xe,we+=u*Ne,le+=u*$e,_e+=u*Fe,H+=u*Pe,F+=u*Le,L+=u*Se,d+=u*Ce,T+=u*Be,ae+=u*Oe,fe+=u*ke,Ie+=u*We,He+=u*et,Ve+=u*tt,je+=u*Qe,u=R[14],oe+=u*qe,we+=u*xe,le+=u*Ne,_e+=u*$e,H+=u*Fe,F+=u*Pe,L+=u*Le,d+=u*Se,T+=u*Ce,ae+=u*Be,fe+=u*Oe,Ie+=u*ke,He+=u*We,Ve+=u*et,je+=u*tt,gt+=u*Qe,u=R[15],we+=u*qe,le+=u*xe,_e+=u*Ne,H+=u*$e,F+=u*Fe,L+=u*Pe,d+=u*Le,T+=u*Se,ae+=u*Ce,fe+=u*Be,Ie+=u*Oe,He+=u*ke,Ve+=u*We,je+=u*et,gt+=u*tt,yt+=u*Qe,G+=38*le,W+=38*_e,se+=38*H,ce+=38*F,de+=38*L,w+=38*d,A+=38*T,ee+=38*ae,Q+=38*fe,V+=38*Ie,k+=38*He,J+=38*Ve,re+=38*je,be+=38*gt,oe+=38*yt,b=1,u=G+b+65535,b=Math.floor(u/65536),G=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=se+b+65535,b=Math.floor(u/65536),se=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=w+b+65535,b=Math.floor(u/65536),w=u-b*65536,u=A+b+65535,b=Math.floor(u/65536),A=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Q+b+65535,b=Math.floor(u/65536),Q=u-b*65536,u=V+b+65535,b=Math.floor(u/65536),V=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,G+=b-1+37*(b-1),b=1,u=G+b+65535,b=Math.floor(u/65536),G=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=se+b+65535,b=Math.floor(u/65536),se=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=w+b+65535,b=Math.floor(u/65536),w=u-b*65536,u=A+b+65535,b=Math.floor(u/65536),A=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Q+b+65535,b=Math.floor(u/65536),Q=u-b*65536,u=V+b+65535,b=Math.floor(u/65536),V=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,G+=b-1+37*(b-1),P[0]=G,P[1]=W,P[2]=se,P[3]=ce,P[4]=de,P[5]=w,P[6]=A,P[7]=ee,P[8]=Q,P[9]=V,P[10]=k,P[11]=J,P[12]=re,P[13]=be,P[14]=oe,P[15]=we}function x(P,R){D(P,R,R)}function O(P,R){const E=i();for(let u=0;u<16;u++)E[u]=R[u];for(let u=253;u>=0;u--)x(E,E),u!==2&&u!==4&&D(E,E,R);for(let u=0;u<16;u++)P[u]=E[u]}function z(P,R){const E=new Uint8Array(32),u=new Float64Array(80),b=i(),G=i(),W=i(),se=i(),ce=i(),de=i();for(let Q=0;Q<31;Q++)E[Q]=P[Q];E[31]=P[31]&127|64,E[0]&=248,p(u,R);for(let Q=0;Q<16;Q++)G[Q]=u[Q];b[0]=se[0]=1;for(let Q=254;Q>=0;--Q){const V=E[Q>>>3]>>>(Q&7)&1;f(b,G,V),f(W,se,V),v(ce,b,W),S(b,b,W),v(W,G,se),S(G,G,se),x(se,ce),x(de,b),D(b,W,b),D(W,G,ce),v(ce,b,W),S(b,b,W),x(G,b),S(W,se,de),D(b,W,c),v(b,b,se),D(W,W,b),D(b,se,de),D(se,G,u),x(G,ce),f(b,G,V),f(W,se,V)}for(let Q=0;Q<16;Q++)u[Q+16]=b[Q],u[Q+32]=W[Q],u[Q+48]=G[Q],u[Q+64]=se[Q];const w=u.subarray(32),A=u.subarray(16);O(w,w),D(A,A,w);const ee=new Uint8Array(32);return g(ee,A),ee}n.scalarMult=z;function B(P){return z(P,o)}n.scalarMultBase=B;function ie(P){if(P.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const R=new Uint8Array(P);return{publicKey:B(R),secretKey:R}}n.generateKeyPairFromSeed=ie;function $(P){const R=(0,e.randomBytes)(32,P),E=ie(R);return(0,t.wipe)(R),E}n.generateKeyPair=$;function U(P,R,E=!1){if(P.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(R.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=z(P,R);if(E){let b=0;for(let G=0;G<u.length;G++)b|=u[G];if(b===0)throw new Error("X25519: invalid shared key")}return u}n.sharedKey=U})(Yu);function Ju(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function _p(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ju(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function mu(n,e){e||(e=n.reduce((o,c)=>o+c.length,0));const t=_p(e);let i=0;for(const o of n)t.set(o,i),i+=o.length;return Ju(t)}function Jw(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var o=0;o<n.length;o++){var c=n.charAt(o),h=c.charCodeAt(0);if(t[h]!==255)throw new TypeError(c+" is ambiguous");t[h]=o}var f=n.length,g=n.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function S(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var z=0,B=0,ie=0,$=O.length;ie!==$&&O[ie]===0;)ie++,z++;for(var U=($-ie)*v+1>>>0,P=new Uint8Array(U);ie!==$;){for(var R=O[ie],E=0,u=U-1;(R!==0||E<B)&&u!==-1;u--,E++)R+=256*P[u]>>>0,P[u]=R%f>>>0,R=R/f>>>0;if(R!==0)throw new Error("Non-zero carry");B=E,ie++}for(var b=U-B;b!==U&&P[b]===0;)b++;for(var G=g.repeat(z);b<U;++b)G+=n.charAt(P[b]);return G}function D(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var z=0;if(O[z]!==" "){for(var B=0,ie=0;O[z]===g;)B++,z++;for(var $=(O.length-z)*p+1>>>0,U=new Uint8Array($);O[z];){var P=t[O.charCodeAt(z)];if(P===255)return;for(var R=0,E=$-1;(P!==0||R<ie)&&E!==-1;E--,R++)P+=f*U[E]>>>0,U[E]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");ie=R,z++}if(O[z]!==" "){for(var u=$-ie;u!==$&&U[u]===0;)u++;for(var b=new Uint8Array(B+($-u)),G=B;u!==$;)b[G++]=U[u++];return b}}}function x(O){var z=D(O);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:S,decodeUnsafe:D,decode:x}}var Qw=Jw,Xw=Qw;const Zw=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},e1=n=>new TextEncoder().encode(n),t1=n=>new TextDecoder().decode(n);class r1{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class n1{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return mp(this,e)}}class i1{constructor(e){this.decoders=e}or(e){return mp(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const mp=(n,e)=>new i1({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class s1{constructor(e,t,i,o){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=o,this.encoder=new r1(e,t,i),this.decoder=new n1(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pa=({name:n,prefix:e,encode:t,decode:i})=>new s1(n,e,t,i),Rs=({prefix:n,name:e,alphabet:t})=>{const{encode:i,decode:o}=Xw(t,e);return pa({prefix:n,name:e,encode:i,decode:c=>Zw(o(c))})},o1=(n,e,t,i)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=n.length;for(;n[c-1]==="=";)--c;const h=new Uint8Array(c*t/8|0);let f=0,g=0,p=0;for(let v=0;v<c;++v){const S=o[n[v]];if(S===void 0)throw new SyntaxError(`Non-${i} character`);g=g<<t|S,f+=t,f>=8&&(f-=8,h[p++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return h},a1=(n,e,t)=>{const i=e[e.length-1]==="=",o=(1<<t)-1;let c="",h=0,f=0;for(let g=0;g<n.length;++g)for(f=f<<8|n[g],h+=8;h>t;)h-=t,c+=e[o&f>>h];if(h&&(c+=e[o&f<<t-h]),i)for(;c.length*t&7;)c+="=";return c},Jt=({name:n,prefix:e,bitsPerChar:t,alphabet:i})=>pa({prefix:e,name:n,encode(o){return a1(o,i,t)},decode(o){return o1(o,i,t,n)}}),c1=pa({prefix:"\0",name:"identity",encode:n=>t1(n),decode:n=>e1(n)}),u1=Object.freeze(Object.defineProperty({__proto__:null,identity:c1},Symbol.toStringTag,{value:"Module"})),h1=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),l1=Object.freeze(Object.defineProperty({__proto__:null,base2:h1},Symbol.toStringTag,{value:"Module"})),f1=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),d1=Object.freeze(Object.defineProperty({__proto__:null,base8:f1},Symbol.toStringTag,{value:"Module"})),p1=Rs({prefix:"9",name:"base10",alphabet:"0123456789"}),g1=Object.freeze(Object.defineProperty({__proto__:null,base10:p1},Symbol.toStringTag,{value:"Module"})),y1=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),v1=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),_1=Object.freeze(Object.defineProperty({__proto__:null,base16:y1,base16upper:v1},Symbol.toStringTag,{value:"Module"})),m1=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),b1=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),w1=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),E1=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),D1=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),S1=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),I1=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),x1=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),O1=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),P1=Object.freeze(Object.defineProperty({__proto__:null,base32:m1,base32hex:D1,base32hexpad:I1,base32hexpadupper:x1,base32hexupper:S1,base32pad:w1,base32padupper:E1,base32upper:b1,base32z:O1},Symbol.toStringTag,{value:"Module"})),C1=Rs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),A1=Rs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),T1=Object.freeze(Object.defineProperty({__proto__:null,base36:C1,base36upper:A1},Symbol.toStringTag,{value:"Module"})),R1=Rs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),N1=Rs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:R1,base58flickr:N1},Symbol.toStringTag,{value:"Module"})),L1=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),U1=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),j1=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),M1=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),q1=Object.freeze(Object.defineProperty({__proto__:null,base64:L1,base64pad:U1,base64url:j1,base64urlpad:M1},Symbol.toStringTag,{value:"Module"})),bp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),F1=bp.reduce((n,e,t)=>(n[t]=e,n),[]),z1=bp.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function H1(n){return n.reduce((e,t)=>(e+=F1[t],e),"")}function B1(n){const e=[];for(const t of n){const i=z1[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const K1=pa({prefix:"🚀",name:"base256emoji",encode:H1,decode:B1}),V1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:K1},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const mf={...u1,...l1,...d1,...g1,..._1,...P1,...T1,...$1,...q1,...V1};function wp(n,e,t,i){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:i}}}const bf=wp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),kc=wp("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=_p(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),Ep={utf8:bf,"utf-8":bf,hex:mf.base16,latin1:kc,ascii:kc,binary:kc,...mf};function wr(n,e="utf8"){const t=Ep[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ju(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function lr(n,e="utf8"){const t=Ep[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}var wf=function(n,e,t){if(t||arguments.length===2)for(var i=0,o=e.length,c;i<o;i++)(c||!(i in e))&&(c||(c=Array.prototype.slice.call(e,0,i)),c[i]=e[i]);return n.concat(c||Array.prototype.slice.call(e))},k1=function(){function n(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}return n}(),G1=function(){function n(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return n}(),W1=function(){function n(e,t,i,o){this.name=e,this.version=t,this.os=i,this.bot=o,this.type="bot-device"}return n}(),Y1=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),J1=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),Q1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,X1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ef=3,Z1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Q1]],Df=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function eE(n){return n?Sf(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new J1:typeof navigator<"u"?Sf(navigator.userAgent):nE()}function tE(n){return n!==""&&Z1.reduce(function(e,t){var i=t[0],o=t[1];if(e)return e;var c=o.exec(n);return!!c&&[i,c]},!1)}function Sf(n){var e=tE(n);if(!e)return null;var t=e[0],i=e[1];if(t==="searchbot")return new Y1;var o=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);o?o.length<Ef&&(o=wf(wf([],o,!0),iE(Ef-o.length),!0)):o=[];var c=o.join("."),h=rE(n),f=X1.exec(n);return f&&f[1]?new W1(t,c,h,f[1]):new k1(t,c,h)}function rE(n){for(var e=0,t=Df.length;e<t;e++){var i=Df[e],o=i[0],c=i[1],h=c.exec(n);if(h)return o}return null}function nE(){var n=typeof process<"u"&&process.version;return n?new G1(process.version.slice(1)):null}function iE(n){for(var e=[],t=0;t<n;t++)e.push("0");return e}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bu=function(n,e){return bu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])},bu(n,e)};function sE(n,e){bu(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var wu=function(){return wu=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},wu.apply(this,arguments)};function oE(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function aE(n,e,t,i){var o=arguments.length,c=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,i);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function cE(n,e){return function(t,i){e(t,i,n)}}function uE(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function hE(n,e,t,i){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(v){try{p(i.next(v))}catch(S){h(S)}}function g(v){try{p(i.throw(v))}catch(S){h(S)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((i=i.apply(n,e||[])).next())})}function lE(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(p){return function(v){return g([p,v])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(v){p=[6,v],o=0}finally{i=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function fE(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}function dE(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Eu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return c}function pE(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Dp(arguments[e]));return n}function gE(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Is(n){return this instanceof Is?(this.v=n,this):new Is(n)}function yE(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){i[D]&&(o[D]=function(x){return new Promise(function(O,z){c.push([D,x,O,z])>1||f(D,x)})})}function f(D,x){try{g(i[D](x))}catch(O){S(c[0][3],O)}}function g(D){D.value instanceof Is?Promise.resolve(D.value.v).then(p,v):S(c[0][2],D)}function p(D){f("next",D)}function v(D){f("throw",D)}function S(D,x){D(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function vE(n){var e,t;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,c){e[o]=n[o]?function(h){return(t=!t)?{value:Is(n[o](h)),done:o==="return"}:c?c(h):h}:c}}function _E(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Eu=="function"?Eu(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=n[c]&&function(h){return new Promise(function(f,g){h=n[c](h),o(f,g,h.done,h.value)})}}function o(c,h,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},h)}}function mE(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function bE(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function wE(n){return n&&n.__esModule?n:{default:n}}function EE(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function DE(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const SE=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return wu},__asyncDelegator:vE,__asyncGenerator:yE,__asyncValues:_E,__await:Is,__awaiter:hE,__classPrivateFieldGet:EE,__classPrivateFieldSet:DE,__createBinding:fE,__decorate:aE,__exportStar:dE,__extends:sE,__generator:lE,__importDefault:wE,__importStar:bE,__makeTemplateObject:mE,__metadata:uE,__param:cE,__read:Dp,__rest:oE,__spread:pE,__spreadArrays:gE,__values:Eu},Symbol.toStringTag,{value:"Module"})),ga=Fi(SE);var Gc={},fs={},If;function IE(){if(If)return fs;If=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.delay=void 0;function n(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return fs.delay=n,fs}var ri={},Wc={},ni={},xf;function xE(){return xf||(xf=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.ONE_THOUSAND=ni.ONE_HUNDRED=void 0,ni.ONE_HUNDRED=100,ni.ONE_THOUSAND=1e3),ni}var Yc={},Of;function OE(){return Of||(Of=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Yc)),Yc}var Pf;function Sp(){return Pf||(Pf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ga;e.__exportStar(xE(),n),e.__exportStar(OE(),n)}(Wc)),Wc}var Cf;function PE(){if(Cf)return ri;Cf=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.fromMiliseconds=ri.toMiliseconds=void 0;const n=Sp();function e(i){return i*n.ONE_THOUSAND}ri.toMiliseconds=e;function t(i){return Math.floor(i/n.ONE_THOUSAND)}return ri.fromMiliseconds=t,ri}var Af;function CE(){return Af||(Af=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ga;e.__exportStar(IE(),n),e.__exportStar(PE(),n)}(Gc)),Gc}var Ni={},Tf;function AE(){if(Tf)return Ni;Tf=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const i=this.get(t);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-i.started;this.timestamps.set(t,{started:i.started,elapsed:o})}get(t){const i=this.timestamps.get(t);if(typeof i>"u")throw new Error(`No timestamp found for label: ${t}`);return i}elapsed(t){const i=this.get(t);return i.elapsed||Date.now()-i.started}}return Ni.Watch=n,Ni.default=n,Ni}var Jc={},ds={},Rf;function TE(){if(Rf)return ds;Rf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.IWatch=void 0;class n{}return ds.IWatch=n,ds}var Nf;function RE(){return Nf||(Nf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ga.__exportStar(TE(),n)}(Jc)),Jc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ga;e.__exportStar(CE(),n),e.__exportStar(AE(),n),e.__exportStar(RE(),n),e.__exportStar(Sp(),n)})(ve);var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getLocalStorage=ft.getLocalStorageOrThrow=ft.getCrypto=ft.getCryptoOrThrow=Ip=ft.getLocation=ft.getLocationOrThrow=Xu=ft.getNavigator=ft.getNavigatorOrThrow=Qu=ft.getDocument=ft.getDocumentOrThrow=ft.getFromWindowOrThrow=ft.getFromWindow=void 0;function ci(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}ft.getFromWindow=ci;function Hi(n){const e=ci(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}ft.getFromWindowOrThrow=Hi;function NE(){return Hi("document")}ft.getDocumentOrThrow=NE;function $E(){return ci("document")}var Qu=ft.getDocument=$E;function LE(){return Hi("navigator")}ft.getNavigatorOrThrow=LE;function UE(){return ci("navigator")}var Xu=ft.getNavigator=UE;function jE(){return Hi("location")}ft.getLocationOrThrow=jE;function ME(){return ci("location")}var Ip=ft.getLocation=ME;function qE(){return Hi("crypto")}ft.getCryptoOrThrow=qE;function FE(){return ci("crypto")}ft.getCrypto=FE;function zE(){return Hi("localStorage")}ft.getLocalStorageOrThrow=zE;function HE(){return ci("localStorage")}ft.getLocalStorage=HE;var Zu={};Object.defineProperty(Zu,"__esModule",{value:!0});var xp=Zu.getWindowMetadata=void 0;const $f=ft;function BE(){let n,e;try{n=$f.getDocumentOrThrow(),e=$f.getLocationOrThrow()}catch{return null}function t(){const S=n.getElementsByTagName("link"),D=[];for(let x=0;x<S.length;x++){const O=S[x],z=O.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const B=O.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let ie=e.protocol+"//"+e.host;if(B.indexOf("/")===0)ie+=B;else{const $=e.pathname.split("/");$.pop();const U=$.join("/");ie+=U+"/"+B}D.push(ie)}else if(B.indexOf("//")===0){const ie=e.protocol+B;D.push(ie)}else D.push(B)}}return D}function i(...S){const D=n.getElementsByTagName("meta");for(let x=0;x<D.length;x++){const O=D[x],z=["itemprop","property","name"].map(B=>O.getAttribute(B)).filter(B=>B?S.includes(B):!1);if(z.length&&z){const B=O.getAttribute("content");if(B)return B}}return""}function o(){let S=i("name","og:site_name","og:title","twitter:title");return S||(S=n.title),S}function c(){return i("description","og:description","twitter:description","keywords")}const h=o(),f=c(),g=e.origin,p=t();return{description:f,url:g,icons:p,name:h}}xp=Zu.getWindowMetadata=BE;var xs={},KE=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Op="%[a-f0-9]{2}",Lf=new RegExp("("+Op+")|([^%]+?)","gi"),Uf=new RegExp("("+Op+")+","gi");function Du(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;var t=n.slice(0,e),i=n.slice(e);return Array.prototype.concat.call([],Du(t),Du(i))}function VE(n){try{return decodeURIComponent(n)}catch{for(var e=n.match(Lf)||[],t=1;t<e.length;t++)n=Du(e,t).join(""),e=n.match(Lf)||[];return n}}function kE(n){for(var e={"%FE%FF":"��","%FF%FE":"��"},t=Uf.exec(n);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var i=VE(t[0]);i!==t[0]&&(e[t[0]]=i)}t=Uf.exec(n)}e["%C2"]="�";for(var o=Object.keys(e),c=0;c<o.length;c++){var h=o[c];n=n.replace(new RegExp(h,"g"),e[h])}return n}var GE=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return kE(n)}},WE=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const t=n.indexOf(e);return t===-1?[n]:[n.slice(0,t),n.slice(t+e.length)]},YE=function(n,e){for(var t={},i=Object.keys(n),o=Array.isArray(e),c=0;c<i.length;c++){var h=i[c],f=n[h];(o?e.indexOf(h)!==-1:e(h,f,n))&&(t[h]=f)}return t};(function(n){const e=KE,t=GE,i=WE,o=YE,c=$=>$==null,h=Symbol("encodeFragmentIdentifier");function f($){switch($.arrayFormat){case"index":return U=>(P,R)=>{const E=P.length;return R===void 0||$.skipNull&&R===null||$.skipEmptyString&&R===""?P:R===null?[...P,[v(U,$),"[",E,"]"].join("")]:[...P,[v(U,$),"[",v(E,$),"]=",v(R,$)].join("")]};case"bracket":return U=>(P,R)=>R===void 0||$.skipNull&&R===null||$.skipEmptyString&&R===""?P:R===null?[...P,[v(U,$),"[]"].join("")]:[...P,[v(U,$),"[]=",v(R,$)].join("")];case"colon-list-separator":return U=>(P,R)=>R===void 0||$.skipNull&&R===null||$.skipEmptyString&&R===""?P:R===null?[...P,[v(U,$),":list="].join("")]:[...P,[v(U,$),":list=",v(R,$)].join("")];case"comma":case"separator":case"bracket-separator":{const U=$.arrayFormat==="bracket-separator"?"[]=":"=";return P=>(R,E)=>E===void 0||$.skipNull&&E===null||$.skipEmptyString&&E===""?R:(E=E===null?"":E,R.length===0?[[v(P,$),U,v(E,$)].join("")]:[[R,v(E,$)].join($.arrayFormatSeparator)])}default:return U=>(P,R)=>R===void 0||$.skipNull&&R===null||$.skipEmptyString&&R===""?P:R===null?[...P,v(U,$)]:[...P,[v(U,$),"=",v(R,$)].join("")]}}function g($){let U;switch($.arrayFormat){case"index":return(P,R,E)=>{if(U=/\[(\d*)\]$/.exec(P),P=P.replace(/\[\d*\]$/,""),!U){E[P]=R;return}E[P]===void 0&&(E[P]={}),E[P][U[1]]=R};case"bracket":return(P,R,E)=>{if(U=/(\[\])$/.exec(P),P=P.replace(/\[\]$/,""),!U){E[P]=R;return}if(E[P]===void 0){E[P]=[R];return}E[P]=[].concat(E[P],R)};case"colon-list-separator":return(P,R,E)=>{if(U=/(:list)$/.exec(P),P=P.replace(/:list$/,""),!U){E[P]=R;return}if(E[P]===void 0){E[P]=[R];return}E[P]=[].concat(E[P],R)};case"comma":case"separator":return(P,R,E)=>{const u=typeof R=="string"&&R.includes($.arrayFormatSeparator),b=typeof R=="string"&&!u&&S(R,$).includes($.arrayFormatSeparator);R=b?S(R,$):R;const G=u||b?R.split($.arrayFormatSeparator).map(W=>S(W,$)):R===null?R:S(R,$);E[P]=G};case"bracket-separator":return(P,R,E)=>{const u=/(\[\])$/.test(P);if(P=P.replace(/\[\]$/,""),!u){E[P]=R&&S(R,$);return}const b=R===null?[]:R.split($.arrayFormatSeparator).map(G=>S(G,$));if(E[P]===void 0){E[P]=b;return}E[P]=[].concat(E[P],b)};default:return(P,R,E)=>{if(E[P]===void 0){E[P]=R;return}E[P]=[].concat(E[P],R)}}}function p($){if(typeof $!="string"||$.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function v($,U){return U.encode?U.strict?e($):encodeURIComponent($):$}function S($,U){return U.decode?t($):$}function D($){return Array.isArray($)?$.sort():typeof $=="object"?D(Object.keys($)).sort((U,P)=>Number(U)-Number(P)).map(U=>$[U]):$}function x($){const U=$.indexOf("#");return U!==-1&&($=$.slice(0,U)),$}function O($){let U="";const P=$.indexOf("#");return P!==-1&&(U=$.slice(P)),U}function z($){$=x($);const U=$.indexOf("?");return U===-1?"":$.slice(U+1)}function B($,U){return U.parseNumbers&&!Number.isNaN(Number($))&&typeof $=="string"&&$.trim()!==""?$=Number($):U.parseBooleans&&$!==null&&($.toLowerCase()==="true"||$.toLowerCase()==="false")&&($=$.toLowerCase()==="true"),$}function ie($,U){U=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},U),p(U.arrayFormatSeparator);const P=g(U),R=Object.create(null);if(typeof $!="string"||($=$.trim().replace(/^[?#&]/,""),!$))return R;for(const E of $.split("&")){if(E==="")continue;let[u,b]=i(U.decode?E.replace(/\+/g," "):E,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(U.arrayFormat)?b:S(b,U),P(S(u,U),b,R)}for(const E of Object.keys(R)){const u=R[E];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=B(u[b],U);else R[E]=B(u,U)}return U.sort===!1?R:(U.sort===!0?Object.keys(R).sort():Object.keys(R).sort(U.sort)).reduce((E,u)=>{const b=R[u];return b&&typeof b=="object"&&!Array.isArray(b)?E[u]=D(b):E[u]=b,E},Object.create(null))}n.extract=z,n.parse=ie,n.stringify=($,U)=>{if(!$)return"";U=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},U),p(U.arrayFormatSeparator);const P=b=>U.skipNull&&c($[b])||U.skipEmptyString&&$[b]==="",R=f(U),E={};for(const b of Object.keys($))P(b)||(E[b]=$[b]);const u=Object.keys(E);return U.sort!==!1&&u.sort(U.sort),u.map(b=>{const G=$[b];return G===void 0?"":G===null?v(b,U):Array.isArray(G)?G.length===0&&U.arrayFormat==="bracket-separator"?v(b,U)+"[]":G.reduce(R(b),[]).join("&"):v(b,U)+"="+v(G,U)}).filter(b=>b.length>0).join("&")},n.parseUrl=($,U)=>{U=Object.assign({decode:!0},U);const[P,R]=i($,"#");return Object.assign({url:P.split("?")[0]||"",query:ie(z($),U)},U&&U.parseFragmentIdentifier&&R?{fragmentIdentifier:S(R,U)}:{})},n.stringifyUrl=($,U)=>{U=Object.assign({encode:!0,strict:!0,[h]:!0},U);const P=x($.url).split("?")[0]||"",R=n.extract($.url),E=n.parse(R,{sort:!1}),u=Object.assign(E,$.query);let b=n.stringify(u,U);b&&(b=`?${b}`);let G=O($.url);return $.fragmentIdentifier&&(G=`#${U[h]?v($.fragmentIdentifier,U):$.fragmentIdentifier}`),`${P}${b}${G}`},n.pick=($,U,P)=>{P=Object.assign({parseFragmentIdentifier:!0,[h]:!1},P);const{url:R,query:E,fragmentIdentifier:u}=n.parseUrl($,P);return n.stringifyUrl({url:R,query:o(E,U),fragmentIdentifier:u},P)},n.exclude=($,U,P)=>{const R=Array.isArray(U)?E=>!U.includes(E):(E,u)=>!U(E,u);return n.pick($,R,P)}})(xs);const JE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},QE=":";function XE(n){const[e,t]=n.split(QE);return{namespace:e,reference:t}}function ZE(n,e=[]){const t=[];return Object.keys(n).forEach(i=>{if(e.length&&!e.includes(i))return;const o=n[i];t.push(...o.accounts)}),t}function Pp(n,e){return n.includes(":")?[n]:e.chains||[]}const Cp="base10",hr="base16",Su="base64pad",eh="utf8",Ap=0,ui=1,e3=0,jf=1,Iu=12,th=32;function t3(){const n=Yu.generateKeyPair();return{privateKey:lr(n.secretKey,hr),publicKey:lr(n.publicKey,hr)}}function xu(){const n=zi.randomBytes(th);return lr(n,hr)}function r3(n,e){const t=Yu.sharedKey(wr(n,hr),wr(e,hr),!0),i=new Hw(da.SHA256,t).expand(th);return lr(i,hr)}function n3(n){const e=da.hash(wr(n,hr));return lr(e,hr)}function ji(n){const e=da.hash(wr(n,eh));return lr(e,hr)}function i3(n){return wr(`${n}`,Cp)}function Ns(n){return Number(lr(n,Cp))}function s3(n){const e=i3(typeof n.type<"u"?n.type:Ap);if(Ns(e)===ui&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof n.senderPublicKey<"u"?wr(n.senderPublicKey,hr):void 0,i=typeof n.iv<"u"?wr(n.iv,hr):zi.randomBytes(Iu),o=new Gu.ChaCha20Poly1305(wr(n.symKey,hr)).seal(i,wr(n.message,eh));return a3({type:e,sealed:o,iv:i,senderPublicKey:t})}function o3(n){const e=new Gu.ChaCha20Poly1305(wr(n.symKey,hr)),{sealed:t,iv:i}=ra(n.encoded),o=e.open(i,t);if(o===null)throw new Error("Failed to decrypt");return lr(o,eh)}function a3(n){if(Ns(n.type)===ui){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return lr(mu([n.type,n.senderPublicKey,n.iv,n.sealed]),Su)}return lr(mu([n.type,n.iv,n.sealed]),Su)}function ra(n){const e=wr(n,Su),t=e.slice(e3,jf),i=jf;if(Ns(t)===ui){const f=i+th,g=f+Iu,p=e.slice(i,f),v=e.slice(f,g),S=e.slice(g);return{type:t,sealed:S,iv:v,senderPublicKey:p}}const o=i+Iu,c=e.slice(i,o),h=e.slice(o);return{type:t,sealed:h,iv:c}}function c3(n,e){const t=ra(n);return Tp({type:Ns(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?lr(t.senderPublicKey,hr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Tp(n){const e=(n==null?void 0:n.type)||Ap;if(e===ui){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function Mf(n){return n.type===ui&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var u3=Object.defineProperty,qf=Object.getOwnPropertySymbols,h3=Object.prototype.hasOwnProperty,l3=Object.prototype.propertyIsEnumerable,Ff=(n,e,t)=>e in n?u3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zf=(n,e)=>{for(var t in e||(e={}))h3.call(e,t)&&Ff(n,t,e[t]);if(qf)for(var t of qf(e))l3.call(e,t)&&Ff(n,t,e[t]);return n};const f3="ReactNative",Pr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},d3="js";function rh(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Bi(){return!Qu()&&!!Xu()&&navigator.product===f3}function Ki(){return!rh()&&!!Xu()&&!!Qu()}function $s(){return Bi()?Pr.reactNative:rh()?Pr.node:Ki()?Pr.browser:Pr.unknown}function p3(){var n;try{return Bi()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function g3(n,e){let t=xs.parse(n);return t=zf(zf({},t),e),n=xs.stringify(t),n}function y3(){return xp()||{name:"",description:"",url:"",icons:[""]}}function v3(){if($s()===Pr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:i}=global.Platform;return[t,i].join("-")}const n=eE();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function _3(){var n;const e=$s();return e===Pr.browser?[e,((n=Ip())==null?void 0:n.host)||"unknown"].join(":"):e}function m3(n,e,t){const i=v3(),o=_3();return[[n,e].join("-"),[d3,t].join("-"),i,o].join("/")}function b3({protocol:n,version:e,relayUrl:t,sdkVersion:i,auth:o,projectId:c,useOnCloseEvent:h,bundleId:f}){const g=t.split("?"),p=m3(n,e,i),v={auth:o,ua:p,projectId:c,useOnCloseEvent:h||void 0,origin:f||void 0},S=g3(g[1]||"",v);return g[0]+"?"+S}function oi(n,e){return n.filter(t=>e.includes(t)).length===n.length}function Rp(n){return Object.fromEntries(n.entries())}function Np(n){return new Map(Object.entries(n))}function $i(n=ve.FIVE_MINUTES,e){const t=ve.toMiliseconds(n||ve.FIVE_MINUTES);let i,o,c;return{resolve:h=>{c&&i&&(clearTimeout(c),i(h))},reject:h=>{c&&o&&(clearTimeout(c),o(h))},done:()=>new Promise((h,f)=>{c=setTimeout(()=>{f(new Error(e))},t),i=h,o=f})}}function Os(n,e,t){return new Promise(async(i,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const h=await n;i(h)}catch(h){o(h)}clearTimeout(c)})}function $p(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function w3(n){return $p("topic",n)}function E3(n){return $p("id",n)}function Lp(n){const[e,t]=n.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")i.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))i.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return i}function Wr(n,e){return ve.fromMiliseconds((e||Date.now())+ve.toMiliseconds(n))}function jn(n){return Date.now()>=ve.toMiliseconds(n)}function Ht(n,e){return`${n}${e?`:${e}`:""}`}function Qc(n=[],e=[]){return[...new Set([...n,...e])]}async function D3({id:n,topic:e,wcDeepLink:t}){try{if(!t)return;const i=typeof t=="string"?JSON.parse(t):t;let o=i==null?void 0:i.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${n}&sessionTopic=${e}`,h=$s();h===Pr.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):h===Pr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(i){console.error(i)}}async function S3(n,e){try{return await n.getItem(e)||(Ki()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}const I3="irn";function Ou(n){return(n==null?void 0:n.relay)||{protocol:I3}}function Jo(n){const e=JE[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var x3=Object.defineProperty,Hf=Object.getOwnPropertySymbols,O3=Object.prototype.hasOwnProperty,P3=Object.prototype.propertyIsEnumerable,Bf=(n,e,t)=>e in n?x3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,C3=(n,e)=>{for(var t in e||(e={}))O3.call(e,t)&&Bf(n,t,e[t]);if(Hf)for(var t of Hf(e))P3.call(e,t)&&Bf(n,t,e[t]);return n};function A3(n,e="-"){const t={},i="relay"+e;return Object.keys(n).forEach(o=>{if(o.startsWith(i)){const c=o.replace(i,""),h=n[o];t[c]=h}}),t}function Kf(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const e=n.indexOf(":"),t=n.indexOf("?")!==-1?n.indexOf("?"):void 0,i=n.substring(0,e),o=n.substring(e+1,t).split("@"),c=typeof t<"u"?n.substring(t):"",h=xs.parse(c);return{protocol:i,topic:T3(o[0]),version:parseInt(o[1],10),symKey:h.symKey,relay:A3(h)}}function T3(n){return n.startsWith("//")?n.substring(2):n}function R3(n,e="-"){const t="relay",i={};return Object.keys(n).forEach(o=>{const c=t+e+o;n[o]&&(i[c]=n[o])}),i}function N3(n){return`${n.protocol}:${n.topic}@${n.version}?`+xs.stringify(C3({symKey:n.symKey},R3(n.relay)))}function Vi(n){const e=[];return n.forEach(t=>{const[i,o]=t.split(":");e.push(`${i}:${o}`)}),e}function $3(n){const e=[];return Object.values(n).forEach(t=>{e.push(...Vi(t.accounts))}),e}function L3(n,e){const t=[];return Object.values(n).forEach(i=>{Vi(i.accounts).includes(e)&&t.push(...i.methods)}),t}function U3(n,e){const t=[];return Object.values(n).forEach(i=>{Vi(i.accounts).includes(e)&&t.push(...i.events)}),t}function j3(n,e){const t=Qo(n,e);if(t)throw new Error(t.message);const i={};for(const[o,c]of Object.entries(n))i[o]={methods:c.methods,events:c.events,chains:c.accounts.map(h=>`${h.split(":")[0]}:${h.split(":")[1]}`)};return i}function nh(n){return n.includes(":")}function ws(n){return nh(n)?n.split(":")[0]:n}const M3={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},q3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(n,e){const{message:t,code:i}=q3[n];return{message:e?`${t} ${e}`:t,code:i}}function At(n,e){const{message:t,code:i}=M3[n];return{message:e?`${t} ${e}`:t,code:i}}function on(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function Mi(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function ur(n){return typeof n>"u"}function Wt(n,e){return e&&ur(n)?!0:typeof n=="string"&&!!n.trim().length}function ih(n,e){return e&&ur(n)?!0:typeof n=="number"&&!isNaN(n)}function F3(n,e){const{requiredNamespaces:t}=e,i=Object.keys(n.namespaces),o=Object.keys(t);let c=!0;return oi(o,i)?(i.forEach(h=>{const{accounts:f,methods:g,events:p}=n.namespaces[h],v=Vi(f),S=t[h];(!oi(Pp(h,S),v)||!oi(S.methods,g)||!oi(S.events,p))&&(c=!1)}),c):!1}function na(n){return Wt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function z3(n){if(Wt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&na(t)}}return!1}function H3(n){if(Wt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function B3(n){var e;return(e=n==null?void 0:n.proposer)==null?void 0:e.publicKey}function K3(n){return n==null?void 0:n.topic}function V3(n,e){let t=null;return Wt(n==null?void 0:n.publicKey,!1)||(t=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Vf(n){let e=!0;return on(n)?n.length&&(e=n.every(t=>Wt(t,!1))):e=!1,e}function k3(n,e,t){let i=null;return on(e)&&e.length?e.forEach(o=>{i||na(o)||(i=At("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):na(n)||(i=At("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function G3(n,e,t){let i=null;return Object.entries(n).forEach(([o,c])=>{if(i)return;const h=k3(o,Pp(o,c),`${e} ${t}`);h&&(i=h)}),i}function W3(n,e){let t=null;return on(n)?n.forEach(i=>{t||z3(i)||(t=At("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):t=At("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Y3(n,e){let t=null;return Object.values(n).forEach(i=>{if(t)return;const o=W3(i==null?void 0:i.accounts,`${e} namespace`);o&&(t=o)}),t}function J3(n,e){let t=null;return Vf(n==null?void 0:n.methods)?Vf(n==null?void 0:n.events)||(t=At("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=At("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Up(n,e){let t=null;return Object.values(n).forEach(i=>{if(t)return;const o=J3(i,`${e}, namespace`);o&&(t=o)}),t}function Q3(n,e,t){let i=null;if(n&&Mi(n)){const o=Up(n,e);o&&(i=o);const c=G3(n,e,t);c&&(i=c)}else i=ue("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return i}function Qo(n,e){let t=null;if(n&&Mi(n)){const i=Up(n,e);i&&(t=i);const o=Y3(n,e);o&&(t=o)}else t=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function jp(n){return Wt(n.protocol,!0)}function X3(n,e){let t=!1;return e&&!n?t=!0:n&&on(n)&&n.length&&n.forEach(i=>{t=jp(i)}),t}function Z3(n){return typeof n=="number"}function br(n){return typeof n<"u"&&typeof n!==null}function eD(n){return!(!n||typeof n!="object"||!n.code||!ih(n.code,!1)||!n.message||!Wt(n.message,!1))}function tD(n){return!(ur(n)||!Wt(n.method,!1))}function rD(n){return!(ur(n)||ur(n.result)&&ur(n.error)||!ih(n.id,!1)||!Wt(n.jsonrpc,!1))}function nD(n){return!(ur(n)||!Wt(n.name,!1))}function kf(n,e){return!(!na(e)||!$3(n).includes(e))}function iD(n,e,t){return Wt(t,!1)?L3(n,e).includes(t):!1}function sD(n,e,t){return Wt(t,!1)?U3(n,e).includes(t):!1}function Gf(n,e,t){let i=null;const o=oD(n),c=aD(e),h=Object.keys(o),f=Object.keys(c),g=Wf(Object.keys(n)),p=Wf(Object.keys(e)),v=g.filter(S=>!p.includes(S));return v.length&&(i=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${v.toString()}
      Received: ${Object.keys(e).toString()}`)),oi(h,f)||(i=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${h.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(S=>{if(!S.includes(":")||i)return;const D=Vi(e[S].accounts);D.includes(S)||(i=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${S}
        Required: ${S}
        Approved: ${D.toString()}`))}),h.forEach(S=>{i||(oi(o[S].methods,c[S].methods)?oi(o[S].events,c[S].events)||(i=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${S}`)):i=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${S}`))}),i}function oD(n){const e={};return Object.keys(n).forEach(t=>{var i;t.includes(":")?e[t]=n[t]:(i=n[t].chains)==null||i.forEach(o=>{e[o]={methods:n[t].methods,events:n[t].events}})}),e}function Wf(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function aD(n){const e={};return Object.keys(n).forEach(t=>{if(t.includes(":"))e[t]=n[t];else{const i=Vi(n[t].accounts);i==null||i.forEach(o=>{e[o]={accounts:n[t].accounts.filter(c=>c.includes(`${o}:`)),methods:n[t].methods,events:n[t].events}})}}),e}function cD(n,e){return ih(n,!1)&&n<=e.max&&n>=e.min}function Yf(){const n=$s();return new Promise(e=>{switch(n){case Pr.browser:e(uD());break;case Pr.reactNative:e(hD());break;case Pr.node:e(lD());break;default:e(!0)}})}function uD(){return Ki()&&(navigator==null?void 0:navigator.onLine)}async function hD(){if(Bi()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function lD(){return!0}function fD(n){switch($s()){case Pr.browser:dD(n);break;case Pr.reactNative:pD(n);break}}function dD(n){!Bi()&&Ki()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function pD(n){Bi()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>n(e==null?void 0:e.isConnected)))}const Xc={};let Bo=class{static get(e){return Xc[e]}static set(e,t){Xc[e]=t}static delete(e){delete Xc[e]}};const gD=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,yD=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,vD=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function _D(n,e){if(n==="__proto__"||n==="constructor"&&e&&typeof e=="object"&&"prototype"in e){mD(n);return}return e}function mD(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Ko(n,e={}){if(typeof n!="string")return n;const t=n.trim();if(n[0]==='"'&&n.at(-1)==='"'&&!n.includes("\\"))return t.slice(1,-1);if(t.length<=9){const i=t.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!vD.test(n)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(gD.test(n)||yD.test(n)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,_D)}return JSON.parse(n)}catch(i){if(e.strict)throw i;return n}}function bD(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function Gt(n,...e){try{return bD(n(...e))}catch(t){return Promise.reject(t)}}function wD(n){const e=typeof n;return n===null||e!=="object"&&e!=="function"}function ED(n){const e=Object.getPrototypeOf(n);return!e||e.isPrototypeOf(Object)}function Xo(n){if(wD(n))return String(n);if(ED(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Xo(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Mp(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Pu="base64:";function DD(n){if(typeof n=="string")return n;Mp();const e=Buffer.from(n).toString("base64");return Pu+e}function SD(n){return typeof n!="string"||!n.startsWith(Pu)?n:(Mp(),Buffer.from(n.slice(Pu.length),"base64"))}function mr(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function ID(...n){return mr(n.join(":"))}function Vo(n){return n=mr(n),n?n+":":""}const xD="memory",OD=()=>{const n=new Map;return{name:xD,options:{},hasItem(e){return n.has(e)},getItem(e){return n.get(e)??null},getItemRaw(e){return n.get(e)??null},setItem(e,t){n.set(e,t)},setItemRaw(e,t){n.set(e,t)},removeItem(e){n.delete(e)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function PD(n={}){const e={mounts:{"":n.driver||OD()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=p=>{for(const v of e.mountpoints)if(p.startsWith(v))return{base:v,relativeKey:p.slice(v.length),driver:e.mounts[v]};return{base:"",relativeKey:p,driver:e.mounts[""]}},i=(p,v)=>e.mountpoints.filter(S=>S.startsWith(p)||v&&p.startsWith(S)).map(S=>({relativeBase:p.length>S.length?p.slice(S.length):void 0,mountpoint:S,driver:e.mounts[S]})),o=(p,v)=>{if(e.watching){v=mr(v);for(const S of e.watchListeners)S(p,v)}},c=async()=>{if(!e.watching){e.watching=!0;for(const p in e.mounts)e.unwatch[p]=await Jf(e.mounts[p],o,p)}},h=async()=>{if(e.watching){for(const p in e.unwatch)await e.unwatch[p]();e.unwatch={},e.watching=!1}},f=(p,v,S)=>{const D=new Map,x=O=>{let z=D.get(O.base);return z||(z={driver:O.driver,base:O.base,items:[]},D.set(O.base,z)),z};for(const O of p){const z=typeof O=="string",B=mr(z?O:O.key),ie=z?void 0:O.value,$=z||!O.options?v:{...v,...O.options},U=t(B);x(U).items.push({key:B,value:ie,relativeKey:U.relativeKey,options:$})}return Promise.all([...D.values()].map(O=>S(O))).then(O=>O.flat())},g={hasItem(p,v={}){p=mr(p);const{relativeKey:S,driver:D}=t(p);return Gt(D.hasItem,S,v)},getItem(p,v={}){p=mr(p);const{relativeKey:S,driver:D}=t(p);return Gt(D.getItem,S,v).then(x=>Ko(x))},getItems(p,v){return f(p,v,S=>S.driver.getItems?Gt(S.driver.getItems,S.items.map(D=>({key:D.relativeKey,options:D.options})),v).then(D=>D.map(x=>({key:ID(S.base,x.key),value:Ko(x.value)}))):Promise.all(S.items.map(D=>Gt(S.driver.getItem,D.relativeKey,D.options).then(x=>({key:D.key,value:Ko(x)})))))},getItemRaw(p,v={}){p=mr(p);const{relativeKey:S,driver:D}=t(p);return D.getItemRaw?Gt(D.getItemRaw,S,v):Gt(D.getItem,S,v).then(x=>SD(x))},async setItem(p,v,S={}){if(v===void 0)return g.removeItem(p);p=mr(p);const{relativeKey:D,driver:x}=t(p);x.setItem&&(await Gt(x.setItem,D,Xo(v),S),x.watch||o("update",p))},async setItems(p,v){await f(p,v,async S=>{S.driver.setItems&&await Gt(S.driver.setItems,S.items.map(D=>({key:D.relativeKey,value:Xo(D.value),options:D.options})),v),S.driver.setItem&&await Promise.all(S.items.map(D=>Gt(S.driver.setItem,D.relativeKey,Xo(D.value),D.options)))})},async setItemRaw(p,v,S={}){if(v===void 0)return g.removeItem(p,S);p=mr(p);const{relativeKey:D,driver:x}=t(p);if(x.setItemRaw)await Gt(x.setItemRaw,D,v,S);else if(x.setItem)await Gt(x.setItem,D,DD(v),S);else return;x.watch||o("update",p)},async removeItem(p,v={}){typeof v=="boolean"&&(v={removeMeta:v}),p=mr(p);const{relativeKey:S,driver:D}=t(p);D.removeItem&&(await Gt(D.removeItem,S,v),(v.removeMeta||v.removeMata)&&await Gt(D.removeItem,S+"$",v),D.watch||o("remove",p))},async getMeta(p,v={}){typeof v=="boolean"&&(v={nativeOnly:v}),p=mr(p);const{relativeKey:S,driver:D}=t(p),x=Object.create(null);if(D.getMeta&&Object.assign(x,await Gt(D.getMeta,S,v)),!v.nativeOnly){const O=await Gt(D.getItem,S+"$",v).then(z=>Ko(z));O&&typeof O=="object"&&(typeof O.atime=="string"&&(O.atime=new Date(O.atime)),typeof O.mtime=="string"&&(O.mtime=new Date(O.mtime)),Object.assign(x,O))}return x},setMeta(p,v,S={}){return this.setItem(p+"$",v,S)},removeMeta(p,v={}){return this.removeItem(p+"$",v)},async getKeys(p,v={}){p=Vo(p);const S=i(p,!0);let D=[];const x=[];for(const O of S){const B=(await Gt(O.driver.getKeys,O.relativeBase,v)).map(ie=>O.mountpoint+mr(ie)).filter(ie=>!D.some($=>ie.startsWith($)));x.push(...B),D=[O.mountpoint,...D.filter(ie=>!ie.startsWith(O.mountpoint))]}return p?x.filter(O=>O.startsWith(p)&&!O.endsWith("$")):x.filter(O=>!O.endsWith("$"))},async clear(p,v={}){p=Vo(p),await Promise.all(i(p,!1).map(async S=>{if(S.driver.clear)return Gt(S.driver.clear,S.relativeBase,v);if(S.driver.removeItem){const D=await S.driver.getKeys(S.relativeBase||"",v);return Promise.all(D.map(x=>S.driver.removeItem(x,v)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(p=>Qf(p)))},async watch(p){return await c(),e.watchListeners.push(p),async()=>{e.watchListeners=e.watchListeners.filter(v=>v!==p),e.watchListeners.length===0&&await h()}},async unwatch(){e.watchListeners=[],await h()},mount(p,v){if(p=Vo(p),p&&e.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(e.mountpoints.push(p),e.mountpoints.sort((S,D)=>D.length-S.length)),e.mounts[p]=v,e.watching&&Promise.resolve(Jf(v,o,p)).then(S=>{e.unwatch[p]=S}).catch(console.error),g},async unmount(p,v=!0){p=Vo(p),!(!p||!e.mounts[p])&&(e.watching&&p in e.unwatch&&(e.unwatch[p](),delete e.unwatch[p]),v&&await Qf(e.mounts[p]),e.mountpoints=e.mountpoints.filter(S=>S!==p),delete e.mounts[p])},getMount(p=""){p=mr(p)+":";const v=t(p);return{driver:v.driver,base:v.base}},getMounts(p="",v={}){return p=mr(p),i(p,v.parents).map(D=>({driver:D.driver,base:D.mountpoint}))}};return g}function Jf(n,e,t){return n.watch?n.watch((i,o)=>e(i,t+o)):()=>{}}async function Qf(n){typeof n.dispose=="function"&&await Gt(n.dispose)}function hi(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}function qp(n,e){const t=indexedDB.open(n);t.onupgradeneeded=()=>t.result.createObjectStore(e);const i=hi(t);return(o,c)=>i.then(h=>c(h.transaction(e,o).objectStore(e)))}let Zc;function Ls(){return Zc||(Zc=qp("keyval-store","keyval")),Zc}function Xf(n,e=Ls()){return e("readonly",t=>hi(t.get(n)))}function CD(n,e,t=Ls()){return t("readwrite",i=>(i.put(e,n),hi(i.transaction)))}function AD(n,e=Ls()){return e("readwrite",t=>(t.delete(n),hi(t.transaction)))}function TD(n=Ls()){return n("readwrite",e=>(e.clear(),hi(e.transaction)))}function RD(n,e){return n.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},hi(n.transaction)}function ND(n=Ls()){return n("readonly",e=>{if(e.getAllKeys)return hi(e.getAllKeys());const t=[];return RD(e,i=>t.push(i.key)).then(()=>t)})}const $D=n=>JSON.stringify(n,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),LD=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=n.replace(e,'$1"$2n"$3');return JSON.parse(t,(i,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Us(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return LD(n)}catch{return n}}function ai(n){return typeof n=="string"?n:$D(n)||""}const UD="idb-keyval";var jD=(n={})=>{const e=n.base&&n.base.length>0?`${n.base}:`:"",t=o=>e+o;let i;return n.dbName&&n.storeName&&(i=qp(n.dbName,n.storeName)),{name:UD,options:n,async hasItem(o){return!(typeof await Xf(t(o),i)>"u")},async getItem(o){return await Xf(t(o),i)??null},setItem(o,c){return CD(t(o),c,i)},removeItem(o){return AD(t(o),i)},getKeys(){return ND(i)},clear(){return TD(i)}}};const MD="WALLET_CONNECT_V2_INDEXED_DB",qD="keyvaluestorage";let FD=class{constructor(){this.indexedDb=PD({driver:jD({dbName:MD,storeName:qD})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,ai(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var eu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zo={exports:{}};(function(){let n;function e(){}n=e,n.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},n.prototype.setItem=function(t,i){this[t]=String(i)},n.prototype.removeItem=function(t){delete this[t]},n.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(i){t[i]=void 0,delete t[i]})},n.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof eu<"u"&&eu.localStorage?Zo.exports=eu.localStorage:typeof window<"u"&&window.localStorage?Zo.exports=window.localStorage:Zo.exports=new e})();function zD(n){var e;return[n[0],Us((e=n[1])!=null?e:"")]}class HD{constructor(){this.localStorage=Zo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(zD)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Us(t)}async setItem(e,t){this.localStorage.setItem(e,ai(t))}async removeItem(e){this.localStorage.removeItem(e)}}const BD="wc_storage_version",Zf=1,KD=async(n,e,t)=>{const i=BD,o=await e.getItem(i);if(o&&o>=Zf){t(e);return}const c=await n.getKeys();if(!c.length){t(e);return}const h=[];for(;c.length;){const f=c.shift();if(!f)continue;const g=f.toLowerCase();if(g.includes("wc@")||g.includes("walletconnect")||g.includes("wc_")||g.includes("wallet_connect")){const p=await n.getItem(f);await e.setItem(f,p),h.push(f)}}await e.setItem(i,Zf),t(e),VD(n,h)},VD=async(n,e)=>{e.length&&e.forEach(async t=>{await n.removeItem(t)})};let kD=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new HD;this.storage=e;try{const t=new FD;KD(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var ki={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Cu=function(n,e){return Cu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])},Cu(n,e)};function GD(n,e){Cu(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Au=function(){return Au=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Au.apply(this,arguments)};function WD(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function YD(n,e,t,i){var o=arguments.length,c=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,i);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function JD(n,e){return function(t,i){e(t,i,n)}}function QD(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function XD(n,e,t,i){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(v){try{p(i.next(v))}catch(S){h(S)}}function g(v){try{p(i.throw(v))}catch(S){h(S)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((i=i.apply(n,e||[])).next())})}function ZD(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(p){return function(v){return g([p,v])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(v){p=[6,v],o=0}finally{i=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function eS(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}function tS(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Tu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return c}function rS(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Fp(arguments[e]));return n}function nS(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Ps(n){return this instanceof Ps?(this.v=n,this):new Ps(n)}function iS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){i[D]&&(o[D]=function(x){return new Promise(function(O,z){c.push([D,x,O,z])>1||f(D,x)})})}function f(D,x){try{g(i[D](x))}catch(O){S(c[0][3],O)}}function g(D){D.value instanceof Ps?Promise.resolve(D.value.v).then(p,v):S(c[0][2],D)}function p(D){f("next",D)}function v(D){f("throw",D)}function S(D,x){D(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function sS(n){var e,t;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,c){e[o]=n[o]?function(h){return(t=!t)?{value:Ps(n[o](h)),done:o==="return"}:c?c(h):h}:c}}function oS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Tu=="function"?Tu(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=n[c]&&function(h){return new Promise(function(f,g){h=n[c](h),o(f,g,h.done,h.value)})}}function o(c,h,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},h)}}function aS(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function cS(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function uS(n){return n&&n.__esModule?n:{default:n}}function hS(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function lS(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const fS=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Au},__asyncDelegator:sS,__asyncGenerator:iS,__asyncValues:oS,__await:Ps,__awaiter:XD,__classPrivateFieldGet:hS,__classPrivateFieldSet:lS,__createBinding:eS,__decorate:YD,__exportStar:tS,__extends:GD,__generator:ZD,__importDefault:uS,__importStar:cS,__makeTemplateObject:aS,__metadata:QD,__param:JD,__read:Fp,__rest:WD,__spread:rS,__spreadArrays:nS,__values:Tu},Symbol.toStringTag,{value:"Module"})),ya=Fi(fS);var ps={},tu={},gs={};let li=class{};const dS=Object.freeze(Object.defineProperty({__proto__:null,IEvents:li},Symbol.toStringTag,{value:"Module"})),pS=Fi(dS);var ed;function gS(){if(ed)return gs;ed=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.IHeartBeat=void 0;const n=pS;class e extends n.IEvents{constructor(i){super()}}return gs.IHeartBeat=e,gs}var td;function zp(){return td||(td=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ya.__exportStar(gS(),n)}(tu)),tu}var ru={},ii={},rd;function yS(){if(rd)return ii;rd=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.HEARTBEAT_EVENTS=ii.HEARTBEAT_INTERVAL=void 0;const n=ve;return ii.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,ii.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ii}var nd;function Hp(){return nd||(nd=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ya.__exportStar(yS(),n)}(ru)),ru}var id;function vS(){if(id)return ps;id=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.HeartBeat=void 0;const n=ya,e=Cr,t=ve,i=zp(),o=Hp();class c extends i.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const g=new c(f);return yield g.init(),g})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,g){this.events.on(f,g)}once(f,g){this.events.once(f,g)}off(f,g){this.events.off(f,g)}removeListener(f,g){this.events.removeListener(f,g)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return ps.HeartBeat=c,ps}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ya;e.__exportStar(vS(),n),e.__exportStar(zp(),n),e.__exportStar(Hp(),n)})(ki);var Je={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ru=function(n,e){return Ru=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])},Ru(n,e)};function _S(n,e){Ru(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Nu=function(){return Nu=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Nu.apply(this,arguments)};function mS(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function bS(n,e,t,i){var o=arguments.length,c=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,i);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function wS(n,e){return function(t,i){e(t,i,n)}}function ES(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function DS(n,e,t,i){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(v){try{p(i.next(v))}catch(S){h(S)}}function g(v){try{p(i.throw(v))}catch(S){h(S)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((i=i.apply(n,e||[])).next())})}function SS(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(p){return function(v){return g([p,v])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(v){p=[6,v],o=0}finally{i=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function IS(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}function xS(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function $u(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return c}function OS(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Bp(arguments[e]));return n}function PS(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Cs(n){return this instanceof Cs?(this.v=n,this):new Cs(n)}function CS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){i[D]&&(o[D]=function(x){return new Promise(function(O,z){c.push([D,x,O,z])>1||f(D,x)})})}function f(D,x){try{g(i[D](x))}catch(O){S(c[0][3],O)}}function g(D){D.value instanceof Cs?Promise.resolve(D.value.v).then(p,v):S(c[0][2],D)}function p(D){f("next",D)}function v(D){f("throw",D)}function S(D,x){D(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function AS(n){var e,t;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,c){e[o]=n[o]?function(h){return(t=!t)?{value:Cs(n[o](h)),done:o==="return"}:c?c(h):h}:c}}function TS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof $u=="function"?$u(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=n[c]&&function(h){return new Promise(function(f,g){h=n[c](h),o(f,g,h.done,h.value)})}}function o(c,h,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},h)}}function RS(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function NS(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function $S(n){return n&&n.__esModule?n:{default:n}}function LS(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function US(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const jS=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nu},__asyncDelegator:AS,__asyncGenerator:CS,__asyncValues:TS,__await:Cs,__awaiter:DS,__classPrivateFieldGet:LS,__classPrivateFieldSet:US,__createBinding:IS,__decorate:bS,__exportStar:xS,__extends:_S,__generator:SS,__importDefault:$S,__importStar:NS,__makeTemplateObject:RS,__metadata:ES,__param:wS,__read:Bp,__rest:mS,__spread:OS,__spreadArrays:PS,__values:$u},Symbol.toStringTag,{value:"Module"})),MS=Fi(jS);var nu,sd;function qS(){if(sd)return nu;sd=1;function n(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}nu=e;function e(t,i,o){var c=o&&o.stringify||n,h=1;if(typeof t=="object"&&t!==null){var f=i.length+h;if(f===1)return t;var g=new Array(f);g[0]=c(t);for(var p=1;p<f;p++)g[p]=c(i[p]);return g.join(" ")}if(typeof t!="string")return t;var v=i.length;if(v===0)return t;for(var S="",D=1-h,x=-1,O=t&&t.length||0,z=0;z<O;){if(t.charCodeAt(z)===37&&z+1<O){switch(x=x>-1?x:0,t.charCodeAt(z+1)){case 100:case 102:if(D>=v||i[D]==null)break;x<z&&(S+=t.slice(x,z)),S+=Number(i[D]),x=z+2,z++;break;case 105:if(D>=v||i[D]==null)break;x<z&&(S+=t.slice(x,z)),S+=Math.floor(Number(i[D])),x=z+2,z++;break;case 79:case 111:case 106:if(D>=v||i[D]===void 0)break;x<z&&(S+=t.slice(x,z));var B=typeof i[D];if(B==="string"){S+="'"+i[D]+"'",x=z+2,z++;break}if(B==="function"){S+=i[D].name||"<anonymous>",x=z+2,z++;break}S+=c(i[D]),x=z+2,z++;break;case 115:if(D>=v)break;x<z&&(S+=t.slice(x,z)),S+=String(i[D]),x=z+2,z++;break;case 37:x<z&&(S+=t.slice(x,z)),S+="%",x=z+2,z++,D--;break}++D}++z}return x===-1?t:(x<O&&(S+=t.slice(x)),S)}return nu}var iu,od;function FS(){if(od)return iu;od=1;const n=qS();iu=o;const e=R().console||{},t={mapHttpRequest:O,mapHttpResponse:O,wrapRequestSerializer:z,wrapResponseSerializer:z,wrapErrorSerializer:z,req:O,res:O,err:D};function i(E,u){return Array.isArray(E)?E.filter(function(G){return G!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function o(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const b=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const G=E.serializers||{},W=i(E.browser.serialize,G);let se=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),E.enabled===!1&&(E.level="silent");const de=E.level||"info",w=Object.create(b);w.log||(w.log=B),Object.defineProperty(w,"levelVal",{get:ee}),Object.defineProperty(w,"level",{get:Q,set:V});const A={transmit:u,serialize:W,asObject:E.browser.asObject,levels:ce,timestamp:x(E)};w.levels=o.levels,w.level=de,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=B,w.serializers=G,w._serialize=W,w._stdErrSerialize=se,w.child=k,u&&(w._logEvent=S());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Q(){return this._level}function V(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,c(A,w,"error","log"),c(A,w,"fatal","error"),c(A,w,"warn","error"),c(A,w,"info","log"),c(A,w,"debug","log"),c(A,w,"trace","log")}function k(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},W&&J.serializers&&(re.serializers=J.serializers);const be=re.serializers;if(W&&be){var oe=Object.assign({},G,be),we=E.browser.serialize===!0?Object.keys(oe):W;delete J.serializers,g([J],we,oe,this._stdErrSerialize)}function le(_e){this._childLevel=(_e._childLevel|0)+1,this.error=p(_e,J,"error"),this.fatal=p(_e,J,"fatal"),this.warn=p(_e,J,"warn"),this.info=p(_e,J,"info"),this.debug=p(_e,J,"debug"),this.trace=p(_e,J,"trace"),oe&&(this.serializers=oe,this._serialize=we),u&&(this._logEvent=S([].concat(_e._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return w}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:$,unixTime:U,isoTime:P});function c(E,u,b,G){const W=Object.getPrototypeOf(u);u[b]=u.levelVal>u.levels.values[b]?B:W[b]?W[b]:e[b]||e[G]||B,h(E,u,b)}function h(E,u,b){!E.transmit&&u[b]===B||(u[b]=function(G){return function(){const se=E.timestamp(),ce=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var w=0;w<ce.length;w++)ce[w]=arguments[w];if(E.serialize&&!E.asObject&&g(ce,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?G.call(de,f(this,b,ce,se)):G.apply(de,ce),E.transmit){const A=E.transmit.level||u.level,ee=o.levels.values[A],Q=o.levels.values[b];if(Q<ee)return;v(this,{ts:se,methodLevel:b,methodValue:Q,transmitLevel:A,transmitValue:o.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ce)}}}(u[b]))}function f(E,u,b,G){E._serialize&&g(b,E._serialize,E.serializers,E._stdErrSerialize);const W=b.slice();let se=W[0];const ce={};G&&(ce.time=G),ce.level=o.levels.values[u];let de=(E._childLevel|0)+1;if(de<1&&(de=1),se!==null&&typeof se=="object"){for(;de--&&typeof W[0]=="object";)Object.assign(ce,W.shift());se=W.length?n(W.shift(),W):void 0}else typeof se=="string"&&(se=n(W.shift(),W));return se!==void 0&&(ce.msg=se),ce}function g(E,u,b,G){for(const W in E)if(G&&E[W]instanceof Error)E[W]=o.stdSerializers.err(E[W]);else if(typeof E[W]=="object"&&!Array.isArray(E[W]))for(const se in E[W])u&&u.indexOf(se)>-1&&se in b&&(E[W][se]=b[se](E[W][se]))}function p(E,u,b){return function(){const G=new Array(1+arguments.length);G[0]=u;for(var W=1;W<G.length;W++)G[W]=arguments[W-1];return E[b].apply(this,G)}}function v(E,u,b){const G=u.send,W=u.ts,se=u.methodLevel,ce=u.methodValue,de=u.val,w=E._logEvent.bindings;g(b,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=W,E._logEvent.messages=b.filter(function(A){return w.indexOf(A)===-1}),E._logEvent.level.label=se,E._logEvent.level.value=ce,G(se,E._logEvent,de),E._logEvent=S(w)}function S(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function D(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const b in E)u[b]===void 0&&(u[b]=E[b]);return u}function x(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?ie:$}function O(){return{}}function z(E){return E}function B(){}function ie(){return!1}function $(){return Date.now()}function U(){return Math.round(Date.now()/1e3)}function P(){return new Date(Date.now()).toISOString()}function R(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return iu}var si={},ad;function Kp(){return ad||(ad=1,Object.defineProperty(si,"__esModule",{value:!0}),si.PINO_CUSTOM_CONTEXT_KEY=si.PINO_LOGGER_DEFAULTS=void 0,si.PINO_LOGGER_DEFAULTS={level:"info"},si.PINO_CUSTOM_CONTEXT_KEY="custom_context"),si}var cr={},cd;function zS(){if(cd)return cr;cd=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.generateChildLogger=cr.formatChildLoggerContext=cr.getLoggerContext=cr.setBrowserLoggerContext=cr.getBrowserLoggerContext=cr.getDefaultLoggerOptions=void 0;const n=Kp();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}cr.getDefaultLoggerOptions=e;function t(f,g=n.PINO_CUSTOM_CONTEXT_KEY){return f[g]||""}cr.getBrowserLoggerContext=t;function i(f,g,p=n.PINO_CUSTOM_CONTEXT_KEY){return f[p]=g,f}cr.setBrowserLoggerContext=i;function o(f,g=n.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof f.bindings>"u"?p=t(f,g):p=f.bindings().context||"",p}cr.getLoggerContext=o;function c(f,g,p=n.PINO_CUSTOM_CONTEXT_KEY){const v=o(f,p);return v.trim()?`${v}/${g}`:g}cr.formatChildLoggerContext=c;function h(f,g,p=n.PINO_CUSTOM_CONTEXT_KEY){const v=c(f,g,p),S=f.child({context:v});return i(S,v,p)}return cr.generateChildLogger=h,cr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=MS,t=e.__importDefault(FS());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(Kp(),n),e.__exportStar(zS(),n)})(Je);class HS extends li{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let BS=class extends li{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},KS=class{constructor(e,t){this.logger=e,this.core=t}},VS=class extends li{constructor(e,t){super(),this.relayer=e,this.logger=t}},kS=class extends li{constructor(e){super()}},GS=class{constructor(e,t,i,o){this.core=e,this.logger=t,this.name=i}};class WS extends li{constructor(e,t){super(),this.relayer=e,this.logger=t}}let YS=class extends li{constructor(e,t){super(),this.core=e,this.logger=t}},JS=class{constructor(e,t){this.projectId=e,this.logger=t}},QS=class{constructor(e,t){this.projectId=e,this.logger=t}},XS=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},ZS=class{constructor(e){this.client=e}};var sh={},Vp={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ue,t=Ar;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var i=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(g,p){if(p===void 0&&(p=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=g[v++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=g[v++],p--;return this},f.prototype.finish=function(g){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,S=p/536870912|0,D=p<<3,x=p%128<112?128:256;this._buffer[v]=128;for(var O=v+1;O<x-8;O++)this._buffer[O]=0;e.writeUint32BE(S,this._buffer,x-8),e.writeUint32BE(D,this._buffer,x-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,x),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)e.writeUint32BE(this._stateHi[O],g,O*8),e.writeUint32BE(this._stateLo[O],g,O*8+4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.stateHi),t.wipe(g.stateLo),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();n.SHA512=i;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,g,p,v,S,D,x){for(var O=p[0],z=p[1],B=p[2],ie=p[3],$=p[4],U=p[5],P=p[6],R=p[7],E=v[0],u=v[1],b=v[2],G=v[3],W=v[4],se=v[5],ce=v[6],de=v[7],w,A,ee,Q,V,k,J,re;x>=128;){for(var be=0;be<16;be++){var oe=8*be+D;f[be]=e.readUint32BE(S,oe),g[be]=e.readUint32BE(S,oe+4)}for(var be=0;be<80;be++){var we=O,le=z,_e=B,H=ie,F=$,L=U,d=P,T=R,ae=E,fe=u,Ie=b,He=G,Ve=W,je=se,gt=ce,yt=de;if(w=R,A=de,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=($>>>14|W<<18)^($>>>18|W<<14)^(W>>>9|$<<23),A=(W>>>14|$<<18)^(W>>>18|$<<14)^($>>>9|W<<23),V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,w=$&U^~$&P,A=W&se^~W&ce,V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,w=o[be*2],A=o[be*2+1],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,w=f[be%16],A=g[be%16],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,ee=J&65535|re<<16,Q=V&65535|k<<16,w=ee,A=Q,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=(O>>>28|E<<4)^(E>>>2|O<<30)^(E>>>7|O<<25),A=(E>>>28|O<<4)^(O>>>2|E<<30)^(O>>>7|E<<25),V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,w=O&z^O&B^z&B,A=E&u^E&b^u&b,V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,T=J&65535|re<<16,yt=V&65535|k<<16,w=H,A=He,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=ee,A=Q,V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,H=J&65535|re<<16,He=V&65535|k<<16,z=we,B=le,ie=_e,$=H,U=F,P=L,R=d,O=T,u=ae,b=fe,G=Ie,W=He,se=Ve,ce=je,de=gt,E=yt,be%16===15)for(var oe=0;oe<16;oe++)w=f[oe],A=g[oe],V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=f[(oe+9)%16],A=g[(oe+9)%16],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,ee=f[(oe+1)%16],Q=g[(oe+1)%16],w=(ee>>>1|Q<<31)^(ee>>>8|Q<<24)^ee>>>7,A=(Q>>>1|ee<<31)^(Q>>>8|ee<<24)^(Q>>>7|ee<<25),V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,ee=f[(oe+14)%16],Q=g[(oe+14)%16],w=(ee>>>19|Q<<13)^(Q>>>29|ee<<3)^ee>>>6,A=(Q>>>19|ee<<13)^(ee>>>29|Q<<3)^(Q>>>6|ee<<26),V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,f[oe]=J&65535|re<<16,g[oe]=V&65535|k<<16}w=O,A=E,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[0],A=v[0],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[0]=O=J&65535|re<<16,v[0]=E=V&65535|k<<16,w=z,A=u,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[1],A=v[1],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[1]=z=J&65535|re<<16,v[1]=u=V&65535|k<<16,w=B,A=b,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[2],A=v[2],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[2]=B=J&65535|re<<16,v[2]=b=V&65535|k<<16,w=ie,A=G,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[3],A=v[3],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[3]=ie=J&65535|re<<16,v[3]=G=V&65535|k<<16,w=$,A=W,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[4],A=v[4],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[4]=$=J&65535|re<<16,v[4]=W=V&65535|k<<16,w=U,A=se,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[5],A=v[5],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[5]=U=J&65535|re<<16,v[5]=se=V&65535|k<<16,w=P,A=ce,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[6],A=v[6],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[6]=P=J&65535|re<<16,v[6]=ce=V&65535|k<<16,w=R,A=de,V=A&65535,k=A>>>16,J=w&65535,re=w>>>16,w=p[7],A=v[7],V+=A&65535,k+=A>>>16,J+=w&65535,re+=w>>>16,k+=V>>>16,J+=k>>>16,re+=J>>>16,p[7]=R=J&65535|re<<16,v[7]=de=V&65535|k<<16,D+=128,x-=128}return D}function h(f){var g=new i;g.update(f);var p=g.digest();return g.clean(),p}n.hash=h})(Vp);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=zi,t=Vp,i=Ar;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(H){const F=new Float64Array(16);if(H)for(let L=0;L<H.length;L++)F[L]=H[L];return F}const c=new Uint8Array(32);c[0]=9;const h=o(),f=o([1]),g=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),v=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),S=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),D=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function x(H,F){for(let L=0;L<16;L++)H[L]=F[L]|0}function O(H){let F=1;for(let L=0;L<16;L++){let d=H[L]+F+65535;F=Math.floor(d/65536),H[L]=d-F*65536}H[0]+=F-1+37*(F-1)}function z(H,F,L){const d=~(L-1);for(let T=0;T<16;T++){const ae=d&(H[T]^F[T]);H[T]^=ae,F[T]^=ae}}function B(H,F){const L=o(),d=o();for(let T=0;T<16;T++)d[T]=F[T];O(d),O(d),O(d);for(let T=0;T<2;T++){L[0]=d[0]-65517;for(let fe=1;fe<15;fe++)L[fe]=d[fe]-65535-(L[fe-1]>>16&1),L[fe-1]&=65535;L[15]=d[15]-32767-(L[14]>>16&1);const ae=L[15]>>16&1;L[14]&=65535,z(d,L,1-ae)}for(let T=0;T<16;T++)H[2*T]=d[T]&255,H[2*T+1]=d[T]>>8}function ie(H,F){let L=0;for(let d=0;d<32;d++)L|=H[d]^F[d];return(1&L-1>>>8)-1}function $(H,F){const L=new Uint8Array(32),d=new Uint8Array(32);return B(L,H),B(d,F),ie(L,d)}function U(H){const F=new Uint8Array(32);return B(F,H),F[0]&1}function P(H,F){for(let L=0;L<16;L++)H[L]=F[2*L]+(F[2*L+1]<<8);H[15]&=32767}function R(H,F,L){for(let d=0;d<16;d++)H[d]=F[d]+L[d]}function E(H,F,L){for(let d=0;d<16;d++)H[d]=F[d]-L[d]}function u(H,F,L){let d,T,ae=0,fe=0,Ie=0,He=0,Ve=0,je=0,gt=0,yt=0,qe=0,xe=0,Ne=0,$e=0,Fe=0,Pe=0,Le=0,Se=0,Ce=0,Be=0,Oe=0,ke=0,We=0,et=0,tt=0,Qe=0,rr=0,fr=0,Qr=0,nr=0,an=0,xn=0,Hn=0,Dt=L[0],vt=L[1],St=L[2],It=L[3],wt=L[4],_t=L[5],Lt=L[6],Ut=L[7],xt=L[8],jt=L[9],Ot=L[10],Tt=L[11],Pt=L[12],lt=L[13],Mt=L[14],qt=L[15];d=F[0],ae+=d*Dt,fe+=d*vt,Ie+=d*St,He+=d*It,Ve+=d*wt,je+=d*_t,gt+=d*Lt,yt+=d*Ut,qe+=d*xt,xe+=d*jt,Ne+=d*Ot,$e+=d*Tt,Fe+=d*Pt,Pe+=d*lt,Le+=d*Mt,Se+=d*qt,d=F[1],fe+=d*Dt,Ie+=d*vt,He+=d*St,Ve+=d*It,je+=d*wt,gt+=d*_t,yt+=d*Lt,qe+=d*Ut,xe+=d*xt,Ne+=d*jt,$e+=d*Ot,Fe+=d*Tt,Pe+=d*Pt,Le+=d*lt,Se+=d*Mt,Ce+=d*qt,d=F[2],Ie+=d*Dt,He+=d*vt,Ve+=d*St,je+=d*It,gt+=d*wt,yt+=d*_t,qe+=d*Lt,xe+=d*Ut,Ne+=d*xt,$e+=d*jt,Fe+=d*Ot,Pe+=d*Tt,Le+=d*Pt,Se+=d*lt,Ce+=d*Mt,Be+=d*qt,d=F[3],He+=d*Dt,Ve+=d*vt,je+=d*St,gt+=d*It,yt+=d*wt,qe+=d*_t,xe+=d*Lt,Ne+=d*Ut,$e+=d*xt,Fe+=d*jt,Pe+=d*Ot,Le+=d*Tt,Se+=d*Pt,Ce+=d*lt,Be+=d*Mt,Oe+=d*qt,d=F[4],Ve+=d*Dt,je+=d*vt,gt+=d*St,yt+=d*It,qe+=d*wt,xe+=d*_t,Ne+=d*Lt,$e+=d*Ut,Fe+=d*xt,Pe+=d*jt,Le+=d*Ot,Se+=d*Tt,Ce+=d*Pt,Be+=d*lt,Oe+=d*Mt,ke+=d*qt,d=F[5],je+=d*Dt,gt+=d*vt,yt+=d*St,qe+=d*It,xe+=d*wt,Ne+=d*_t,$e+=d*Lt,Fe+=d*Ut,Pe+=d*xt,Le+=d*jt,Se+=d*Ot,Ce+=d*Tt,Be+=d*Pt,Oe+=d*lt,ke+=d*Mt,We+=d*qt,d=F[6],gt+=d*Dt,yt+=d*vt,qe+=d*St,xe+=d*It,Ne+=d*wt,$e+=d*_t,Fe+=d*Lt,Pe+=d*Ut,Le+=d*xt,Se+=d*jt,Ce+=d*Ot,Be+=d*Tt,Oe+=d*Pt,ke+=d*lt,We+=d*Mt,et+=d*qt,d=F[7],yt+=d*Dt,qe+=d*vt,xe+=d*St,Ne+=d*It,$e+=d*wt,Fe+=d*_t,Pe+=d*Lt,Le+=d*Ut,Se+=d*xt,Ce+=d*jt,Be+=d*Ot,Oe+=d*Tt,ke+=d*Pt,We+=d*lt,et+=d*Mt,tt+=d*qt,d=F[8],qe+=d*Dt,xe+=d*vt,Ne+=d*St,$e+=d*It,Fe+=d*wt,Pe+=d*_t,Le+=d*Lt,Se+=d*Ut,Ce+=d*xt,Be+=d*jt,Oe+=d*Ot,ke+=d*Tt,We+=d*Pt,et+=d*lt,tt+=d*Mt,Qe+=d*qt,d=F[9],xe+=d*Dt,Ne+=d*vt,$e+=d*St,Fe+=d*It,Pe+=d*wt,Le+=d*_t,Se+=d*Lt,Ce+=d*Ut,Be+=d*xt,Oe+=d*jt,ke+=d*Ot,We+=d*Tt,et+=d*Pt,tt+=d*lt,Qe+=d*Mt,rr+=d*qt,d=F[10],Ne+=d*Dt,$e+=d*vt,Fe+=d*St,Pe+=d*It,Le+=d*wt,Se+=d*_t,Ce+=d*Lt,Be+=d*Ut,Oe+=d*xt,ke+=d*jt,We+=d*Ot,et+=d*Tt,tt+=d*Pt,Qe+=d*lt,rr+=d*Mt,fr+=d*qt,d=F[11],$e+=d*Dt,Fe+=d*vt,Pe+=d*St,Le+=d*It,Se+=d*wt,Ce+=d*_t,Be+=d*Lt,Oe+=d*Ut,ke+=d*xt,We+=d*jt,et+=d*Ot,tt+=d*Tt,Qe+=d*Pt,rr+=d*lt,fr+=d*Mt,Qr+=d*qt,d=F[12],Fe+=d*Dt,Pe+=d*vt,Le+=d*St,Se+=d*It,Ce+=d*wt,Be+=d*_t,Oe+=d*Lt,ke+=d*Ut,We+=d*xt,et+=d*jt,tt+=d*Ot,Qe+=d*Tt,rr+=d*Pt,fr+=d*lt,Qr+=d*Mt,nr+=d*qt,d=F[13],Pe+=d*Dt,Le+=d*vt,Se+=d*St,Ce+=d*It,Be+=d*wt,Oe+=d*_t,ke+=d*Lt,We+=d*Ut,et+=d*xt,tt+=d*jt,Qe+=d*Ot,rr+=d*Tt,fr+=d*Pt,Qr+=d*lt,nr+=d*Mt,an+=d*qt,d=F[14],Le+=d*Dt,Se+=d*vt,Ce+=d*St,Be+=d*It,Oe+=d*wt,ke+=d*_t,We+=d*Lt,et+=d*Ut,tt+=d*xt,Qe+=d*jt,rr+=d*Ot,fr+=d*Tt,Qr+=d*Pt,nr+=d*lt,an+=d*Mt,xn+=d*qt,d=F[15],Se+=d*Dt,Ce+=d*vt,Be+=d*St,Oe+=d*It,ke+=d*wt,We+=d*_t,et+=d*Lt,tt+=d*Ut,Qe+=d*xt,rr+=d*jt,fr+=d*Ot,Qr+=d*Tt,nr+=d*Pt,an+=d*lt,xn+=d*Mt,Hn+=d*qt,ae+=38*Ce,fe+=38*Be,Ie+=38*Oe,He+=38*ke,Ve+=38*We,je+=38*et,gt+=38*tt,yt+=38*Qe,qe+=38*rr,xe+=38*fr,Ne+=38*Qr,$e+=38*nr,Fe+=38*an,Pe+=38*xn,Le+=38*Hn,T=1,d=ae+T+65535,T=Math.floor(d/65536),ae=d-T*65536,d=fe+T+65535,T=Math.floor(d/65536),fe=d-T*65536,d=Ie+T+65535,T=Math.floor(d/65536),Ie=d-T*65536,d=He+T+65535,T=Math.floor(d/65536),He=d-T*65536,d=Ve+T+65535,T=Math.floor(d/65536),Ve=d-T*65536,d=je+T+65535,T=Math.floor(d/65536),je=d-T*65536,d=gt+T+65535,T=Math.floor(d/65536),gt=d-T*65536,d=yt+T+65535,T=Math.floor(d/65536),yt=d-T*65536,d=qe+T+65535,T=Math.floor(d/65536),qe=d-T*65536,d=xe+T+65535,T=Math.floor(d/65536),xe=d-T*65536,d=Ne+T+65535,T=Math.floor(d/65536),Ne=d-T*65536,d=$e+T+65535,T=Math.floor(d/65536),$e=d-T*65536,d=Fe+T+65535,T=Math.floor(d/65536),Fe=d-T*65536,d=Pe+T+65535,T=Math.floor(d/65536),Pe=d-T*65536,d=Le+T+65535,T=Math.floor(d/65536),Le=d-T*65536,d=Se+T+65535,T=Math.floor(d/65536),Se=d-T*65536,ae+=T-1+37*(T-1),T=1,d=ae+T+65535,T=Math.floor(d/65536),ae=d-T*65536,d=fe+T+65535,T=Math.floor(d/65536),fe=d-T*65536,d=Ie+T+65535,T=Math.floor(d/65536),Ie=d-T*65536,d=He+T+65535,T=Math.floor(d/65536),He=d-T*65536,d=Ve+T+65535,T=Math.floor(d/65536),Ve=d-T*65536,d=je+T+65535,T=Math.floor(d/65536),je=d-T*65536,d=gt+T+65535,T=Math.floor(d/65536),gt=d-T*65536,d=yt+T+65535,T=Math.floor(d/65536),yt=d-T*65536,d=qe+T+65535,T=Math.floor(d/65536),qe=d-T*65536,d=xe+T+65535,T=Math.floor(d/65536),xe=d-T*65536,d=Ne+T+65535,T=Math.floor(d/65536),Ne=d-T*65536,d=$e+T+65535,T=Math.floor(d/65536),$e=d-T*65536,d=Fe+T+65535,T=Math.floor(d/65536),Fe=d-T*65536,d=Pe+T+65535,T=Math.floor(d/65536),Pe=d-T*65536,d=Le+T+65535,T=Math.floor(d/65536),Le=d-T*65536,d=Se+T+65535,T=Math.floor(d/65536),Se=d-T*65536,ae+=T-1+37*(T-1),H[0]=ae,H[1]=fe,H[2]=Ie,H[3]=He,H[4]=Ve,H[5]=je,H[6]=gt,H[7]=yt,H[8]=qe,H[9]=xe,H[10]=Ne,H[11]=$e,H[12]=Fe,H[13]=Pe,H[14]=Le,H[15]=Se}function b(H,F){u(H,F,F)}function G(H,F){const L=o();let d;for(d=0;d<16;d++)L[d]=F[d];for(d=253;d>=0;d--)b(L,L),d!==2&&d!==4&&u(L,L,F);for(d=0;d<16;d++)H[d]=L[d]}function W(H,F){const L=o();let d;for(d=0;d<16;d++)L[d]=F[d];for(d=250;d>=0;d--)b(L,L),d!==1&&u(L,L,F);for(d=0;d<16;d++)H[d]=L[d]}function se(H,F){const L=o(),d=o(),T=o(),ae=o(),fe=o(),Ie=o(),He=o(),Ve=o(),je=o();E(L,H[1],H[0]),E(je,F[1],F[0]),u(L,L,je),R(d,H[0],H[1]),R(je,F[0],F[1]),u(d,d,je),u(T,H[3],F[3]),u(T,T,p),u(ae,H[2],F[2]),R(ae,ae,ae),E(fe,d,L),E(Ie,ae,T),R(He,ae,T),R(Ve,d,L),u(H[0],fe,Ie),u(H[1],Ve,He),u(H[2],He,Ie),u(H[3],fe,Ve)}function ce(H,F,L){for(let d=0;d<4;d++)z(H[d],F[d],L)}function de(H,F){const L=o(),d=o(),T=o();G(T,F[2]),u(L,F[0],T),u(d,F[1],T),B(H,d),H[31]^=U(L)<<7}function w(H,F,L){x(H[0],h),x(H[1],f),x(H[2],f),x(H[3],h);for(let d=255;d>=0;--d){const T=L[d/8|0]>>(d&7)&1;ce(H,F,T),se(F,H),se(H,H),ce(H,F,T)}}function A(H,F){const L=[o(),o(),o(),o()];x(L[0],v),x(L[1],S),x(L[2],f),u(L[3],v,S),w(H,L,F)}function ee(H){if(H.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const F=(0,t.hash)(H);F[0]&=248,F[31]&=127,F[31]|=64;const L=new Uint8Array(32),d=[o(),o(),o(),o()];A(d,F),de(L,d);const T=new Uint8Array(64);return T.set(H),T.set(L,32),{publicKey:L,secretKey:T}}n.generateKeyPairFromSeed=ee;function Q(H){const F=(0,e.randomBytes)(32,H),L=ee(F);return(0,i.wipe)(F),L}n.generateKeyPair=Q;function V(H){if(H.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(H.subarray(32))}n.extractPublicKeyFromSecretKey=V;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(H,F){let L,d,T,ae;for(d=63;d>=32;--d){for(L=0,T=d-32,ae=d-12;T<ae;++T)F[T]+=L-16*F[d]*k[T-(d-32)],L=Math.floor((F[T]+128)/256),F[T]-=L*256;F[T]+=L,F[d]=0}for(L=0,T=0;T<32;T++)F[T]+=L-(F[31]>>4)*k[T],L=F[T]>>8,F[T]&=255;for(T=0;T<32;T++)F[T]-=L*k[T];for(d=0;d<32;d++)F[d+1]+=F[d]>>8,H[d]=F[d]&255}function re(H){const F=new Float64Array(64);for(let L=0;L<64;L++)F[L]=H[L];for(let L=0;L<64;L++)H[L]=0;J(H,F)}function be(H,F){const L=new Float64Array(64),d=[o(),o(),o(),o()],T=(0,t.hash)(H.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const ae=new Uint8Array(64);ae.set(T.subarray(32),32);const fe=new t.SHA512;fe.update(ae.subarray(32)),fe.update(F);const Ie=fe.digest();fe.clean(),re(Ie),A(d,Ie),de(ae,d),fe.reset(),fe.update(ae.subarray(0,32)),fe.update(H.subarray(32)),fe.update(F);const He=fe.digest();re(He);for(let Ve=0;Ve<32;Ve++)L[Ve]=Ie[Ve];for(let Ve=0;Ve<32;Ve++)for(let je=0;je<32;je++)L[Ve+je]+=He[Ve]*T[je];return J(ae.subarray(32),L),ae}n.sign=be;function oe(H,F){const L=o(),d=o(),T=o(),ae=o(),fe=o(),Ie=o(),He=o();return x(H[2],f),P(H[1],F),b(T,H[1]),u(ae,T,g),E(T,T,H[2]),R(ae,H[2],ae),b(fe,ae),b(Ie,fe),u(He,Ie,fe),u(L,He,T),u(L,L,ae),W(L,L),u(L,L,T),u(L,L,ae),u(L,L,ae),u(H[0],L,ae),b(d,H[0]),u(d,d,ae),$(d,T)&&u(H[0],H[0],D),b(d,H[0]),u(d,d,ae),$(d,T)?-1:(U(H[0])===F[31]>>7&&E(H[0],h,H[0]),u(H[3],H[0],H[1]),0)}function we(H,F,L){const d=new Uint8Array(32),T=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(L.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(oe(ae,H))return!1;const fe=new t.SHA512;fe.update(L.subarray(0,32)),fe.update(H),fe.update(F);const Ie=fe.digest();return re(Ie),w(T,ae,Ie),A(ae,L.subarray(32)),se(T,ae),de(d,T),!ie(L,d)}n.verify=we;function le(H){let F=[o(),o(),o(),o()];if(oe(F,H))throw new Error("Ed25519: invalid public key");let L=o(),d=o(),T=F[1];R(L,f,T),E(d,f,T),G(d,d),u(L,L,d);let ae=new Uint8Array(32);return B(ae,L),ae}n.convertPublicKeyToX25519=le;function _e(H){const F=(0,t.hash)(H.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const L=new Uint8Array(F.subarray(0,32));return(0,i.wipe)(F),L}n.convertSecretKeyToX25519=_e})(sh);const e2="EdDSA",t2="JWT",kp=".",Gp="base64url",r2="utf8",n2="utf8",i2=":",s2="did",o2="key",ud="base58btc",a2="z",c2="K36",u2=32;function ia(n){return lr(wr(ai(n),r2),Gp)}function Wp(n){const e=wr(c2,ud),t=a2+lr(mu([e,n]),ud);return[s2,o2,t].join(i2)}function h2(n){return lr(n,Gp)}function l2(n){return wr([ia(n.header),ia(n.payload)].join(kp),n2)}function f2(n){return[ia(n.header),ia(n.payload),h2(n.signature)].join(kp)}function hd(n=zi.randomBytes(u2)){return sh.generateKeyPairFromSeed(n)}async function d2(n,e,t,i,o=ve.fromMiliseconds(Date.now())){const c={alg:e2,typ:t2},h=Wp(i.publicKey),f=o+t,g={iss:h,sub:n,aud:e,iat:o,exp:f},p=l2({header:c,payload:g}),v=sh.sign(i.secretKey,p);return f2({header:c,payload:g,signature:v})}const p2="PARSE_ERROR",g2="INVALID_REQUEST",y2="METHOD_NOT_FOUND",v2="INVALID_PARAMS",Yp="INTERNAL_ERROR",oh="SERVER_ERROR",_2=[-32700,-32600,-32601,-32602,-32603],Ss={[p2]:{code:-32700,message:"Parse error"},[g2]:{code:-32600,message:"Invalid Request"},[y2]:{code:-32601,message:"Method not found"},[v2]:{code:-32602,message:"Invalid params"},[Yp]:{code:-32603,message:"Internal error"},[oh]:{code:-32e3,message:"Server error"}},Jp=oh;function m2(n){return _2.includes(n)}function ld(n){return Object.keys(Ss).includes(n)?Ss[n]:Ss[Jp]}function b2(n){const e=Object.values(Ss).find(t=>t.code===n);return e||Ss[Jp]}function Qp(n,e,t){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):n}var Xp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Lu=function(n,e){return Lu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])},Lu(n,e)};function w2(n,e){Lu(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Uu=function(){return Uu=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Uu.apply(this,arguments)};function E2(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function D2(n,e,t,i){var o=arguments.length,c=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,i);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function S2(n,e){return function(t,i){e(t,i,n)}}function I2(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function x2(n,e,t,i){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(v){try{p(i.next(v))}catch(S){h(S)}}function g(v){try{p(i.throw(v))}catch(S){h(S)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((i=i.apply(n,e||[])).next())})}function O2(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(p){return function(v){return g([p,v])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(v){p=[6,v],o=0}finally{i=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function P2(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}function C2(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function ju(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return c}function A2(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Zp(arguments[e]));return n}function T2(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function As(n){return this instanceof As?(this.v=n,this):new As(n)}function R2(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){i[D]&&(o[D]=function(x){return new Promise(function(O,z){c.push([D,x,O,z])>1||f(D,x)})})}function f(D,x){try{g(i[D](x))}catch(O){S(c[0][3],O)}}function g(D){D.value instanceof As?Promise.resolve(D.value.v).then(p,v):S(c[0][2],D)}function p(D){f("next",D)}function v(D){f("throw",D)}function S(D,x){D(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function N2(n){var e,t;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,c){e[o]=n[o]?function(h){return(t=!t)?{value:As(n[o](h)),done:o==="return"}:c?c(h):h}:c}}function $2(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ju=="function"?ju(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=n[c]&&function(h){return new Promise(function(f,g){h=n[c](h),o(f,g,h.done,h.value)})}}function o(c,h,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},h)}}function L2(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function U2(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function j2(n){return n&&n.__esModule?n:{default:n}}function M2(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function q2(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const F2=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Uu},__asyncDelegator:N2,__asyncGenerator:R2,__asyncValues:$2,__await:As,__awaiter:x2,__classPrivateFieldGet:M2,__classPrivateFieldSet:q2,__createBinding:P2,__decorate:D2,__exportStar:C2,__extends:w2,__generator:O2,__importDefault:j2,__importStar:U2,__makeTemplateObject:L2,__metadata:I2,__param:S2,__read:Zp,__rest:E2,__spread:A2,__spreadArrays:T2,__values:ju},Symbol.toStringTag,{value:"Module"})),z2=Fi(F2);var mn={},fd;function H2(){if(fd)return mn;fd=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.isBrowserCryptoAvailable=mn.getSubtleCrypto=mn.getBrowerCrypto=void 0;function n(){return(Jr===null||Jr===void 0?void 0:Jr.crypto)||(Jr===null||Jr===void 0?void 0:Jr.msCrypto)||{}}mn.getBrowerCrypto=n;function e(){const i=n();return i.subtle||i.webkitSubtle}mn.getSubtleCrypto=e;function t(){return!!n()&&!!e()}return mn.isBrowserCryptoAvailable=t,mn}var bn={},dd;function B2(){if(dd)return bn;dd=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.isBrowser=bn.isNode=bn.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}bn.isReactNative=n;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}bn.isNode=e;function t(){return!n()&&!e()}return bn.isBrowser=t,bn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=z2;e.__exportStar(H2(),n),e.__exportStar(B2(),n)})(Xp);function ah(n=3){const e=Date.now()*Math.pow(10,n),t=Math.floor(Math.random()*Math.pow(10,n));return e+t}function eg(n=6){return BigInt(ah(n))}function qi(n,e,t){return{id:t||ah(),jsonrpc:"2.0",method:n,params:e}}function va(n,e){return{id:n,jsonrpc:"2.0",result:e}}function _a(n,e,t){return{id:n,jsonrpc:"2.0",error:K2(e,t)}}function K2(n,e){return typeof n>"u"?ld(Yp):(typeof n=="string"&&(n=Object.assign(Object.assign({},ld(oh)),{message:n})),typeof e<"u"&&(n.data=e),m2(n.code)&&(n=b2(n.code)),n)}class V2{}class k2 extends V2{constructor(){super()}}class G2 extends k2{constructor(e){super()}}const W2="^https?:",Y2="^wss?:";function J2(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function tg(n,e){const t=J2(n);return typeof t>"u"?!1:new RegExp(e).test(t)}function pd(n){return tg(n,W2)}function gd(n){return tg(n,Y2)}function Q2(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function rg(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function ch(n){return rg(n)&&"method"in n}function ma(n){return rg(n)&&(Dn(n)||Yr(n))}function Dn(n){return"result"in n}function Yr(n){return"error"in n}class Sn extends G2{constructor(e){super(e),this.events=new Cr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(qi(e.method,e.params||[],e.id||eg().toString()),t)}async requestStrict(e,t){return new Promise(async(i,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Yr(c)?o(c.error):i(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ma(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const X2=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Z2=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",yd=n=>n.split("?")[0],vd=10,e6=X2();let t6=class{constructor(e){if(this.url=e,this.events=new Cr.EventEmitter,this.registering=!1,!gd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ai(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!gd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,i)=>{const o=new URLSearchParams(e).get("origin"),c=Xp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!Q2(e)},h=new e6(e,[],c);Z2()?h.onerror=f=>{const g=f;i(this.emitError(g.error))}:h.on("error",f=>{i(this.emitError(f))}),h.onopen=()=>{this.onOpen(h),t(h)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Us(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),o=i.message||i.toString(),c=_a(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Qp(e,yd(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>vd&&this.events.setMaxListeners(vd)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${yd(this.url)}`));return this.events.emit("register_error",t),t}};var sa={exports:{}};sa.exports;(function(n,e){var t=200,i="__lodash_hash_undefined__",o=1,c=2,h=9007199254740991,f="[object Arguments]",g="[object Array]",p="[object AsyncFunction]",v="[object Boolean]",S="[object Date]",D="[object Error]",x="[object Function]",O="[object GeneratorFunction]",z="[object Map]",B="[object Number]",ie="[object Null]",$="[object Object]",U="[object Promise]",P="[object Proxy]",R="[object RegExp]",E="[object Set]",u="[object String]",b="[object Symbol]",G="[object Undefined]",W="[object WeakMap]",se="[object ArrayBuffer]",ce="[object DataView]",de="[object Float32Array]",w="[object Float64Array]",A="[object Int8Array]",ee="[object Int16Array]",Q="[object Int32Array]",V="[object Uint8Array]",k="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[w]=le[A]=le[ee]=le[Q]=le[V]=le[k]=le[J]=le[re]=!0,le[f]=le[g]=le[se]=le[v]=le[ce]=le[S]=le[D]=le[x]=le[z]=le[B]=le[$]=le[R]=le[E]=le[u]=le[W]=!1;var _e=typeof Jr=="object"&&Jr&&Jr.Object===Object&&Jr,H=typeof self=="object"&&self&&self.Object===Object&&self,F=_e||H||Function("return this")(),L=e&&!e.nodeType&&e,d=L&&!0&&n&&!n.nodeType&&n,T=d&&d.exports===L,ae=T&&_e.process,fe=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function He(I,j){for(var te=-1,pe=I==null?0:I.length,ct=0,Te=[];++te<pe;){var dt=I[te];j(dt,te,I)&&(Te[ct++]=dt)}return Te}function Ve(I,j){for(var te=-1,pe=j.length,ct=I.length;++te<pe;)I[ct+te]=j[te];return I}function je(I,j){for(var te=-1,pe=I==null?0:I.length;++te<pe;)if(j(I[te],te,I))return!0;return!1}function gt(I,j){for(var te=-1,pe=Array(I);++te<I;)pe[te]=j(te);return pe}function yt(I){return function(j){return I(j)}}function qe(I,j){return I.has(j)}function xe(I,j){return I==null?void 0:I[j]}function Ne(I){var j=-1,te=Array(I.size);return I.forEach(function(pe,ct){te[++j]=[ct,pe]}),te}function $e(I,j){return function(te){return I(j(te))}}function Fe(I){var j=-1,te=Array(I.size);return I.forEach(function(pe){te[++j]=pe}),te}var Pe=Array.prototype,Le=Function.prototype,Se=Object.prototype,Ce=F["__core-js_shared__"],Be=Le.toString,Oe=Se.hasOwnProperty,ke=function(){var I=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""}(),We=Se.toString,et=RegExp("^"+Be.call(Oe).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=T?F.Buffer:void 0,Qe=F.Symbol,rr=F.Uint8Array,fr=Se.propertyIsEnumerable,Qr=Pe.splice,nr=Qe?Qe.toStringTag:void 0,an=Object.getOwnPropertySymbols,xn=tt?tt.isBuffer:void 0,Hn=$e(Object.keys,Object),Dt=Er(F,"DataView"),vt=Er(F,"Map"),St=Er(F,"Promise"),It=Er(F,"Set"),wt=Er(F,"WeakMap"),_t=Er(Object,"create"),Lt=un(Dt),Ut=un(vt),xt=un(St),jt=un(It),Ot=un(wt),Tt=Qe?Qe.prototype:void 0,Pt=Tt?Tt.valueOf:void 0;function lt(I){var j=-1,te=I==null?0:I.length;for(this.clear();++j<te;){var pe=I[j];this.set(pe[0],pe[1])}}function Mt(){this.__data__=_t?_t(null):{},this.size=0}function qt(I){var j=this.has(I)&&delete this.__data__[I];return this.size-=j?1:0,j}function Ea(I){var j=this.__data__;if(_t){var te=j[I];return te===i?void 0:te}return Oe.call(j,I)?j[I]:void 0}function Da(I){var j=this.__data__;return _t?j[I]!==void 0:Oe.call(j,I)}function Sa(I,j){var te=this.__data__;return this.size+=this.has(I)?0:1,te[I]=_t&&j===void 0?i:j,this}lt.prototype.clear=Mt,lt.prototype.delete=qt,lt.prototype.get=Ea,lt.prototype.has=Da,lt.prototype.set=Sa;function Tr(I){var j=-1,te=I==null?0:I.length;for(this.clear();++j<te;){var pe=I[j];this.set(pe[0],pe[1])}}function Ia(){this.__data__=[],this.size=0}function xa(I){var j=this.__data__,te=Bn(j,I);if(te<0)return!1;var pe=j.length-1;return te==pe?j.pop():Qr.call(j,te,1),--this.size,!0}function Oa(I){var j=this.__data__,te=Bn(j,I);return te<0?void 0:j[te][1]}function Pa(I){return Bn(this.__data__,I)>-1}function Ca(I,j){var te=this.__data__,pe=Bn(te,I);return pe<0?(++this.size,te.push([I,j])):te[pe][1]=j,this}Tr.prototype.clear=Ia,Tr.prototype.delete=xa,Tr.prototype.get=Oa,Tr.prototype.has=Pa,Tr.prototype.set=Ca;function cn(I){var j=-1,te=I==null?0:I.length;for(this.clear();++j<te;){var pe=I[j];this.set(pe[0],pe[1])}}function di(){this.size=0,this.__data__={hash:new lt,map:new(vt||Tr),string:new lt}}function Aa(I){var j=On(this,I).delete(I);return this.size-=j?1:0,j}function pi(I){return On(this,I).get(I)}function Ta(I){return On(this,I).has(I)}function Ra(I,j){var te=On(this,I),pe=te.size;return te.set(I,j),this.size+=te.size==pe?0:1,this}cn.prototype.clear=di,cn.prototype.delete=Aa,cn.prototype.get=pi,cn.prototype.has=Ta,cn.prototype.set=Ra;function gi(I){var j=-1,te=I==null?0:I.length;for(this.__data__=new cn;++j<te;)this.add(I[j])}function Ms(I){return this.__data__.set(I,i),this}function qs(I){return this.__data__.has(I)}gi.prototype.add=gi.prototype.push=Ms,gi.prototype.has=qs;function zr(I){var j=this.__data__=new Tr(I);this.size=j.size}function Na(){this.__data__=new Tr,this.size=0}function $a(I){var j=this.__data__,te=j.delete(I);return this.size=j.size,te}function La(I){return this.__data__.get(I)}function Ua(I){return this.__data__.has(I)}function Fs(I,j){var te=this.__data__;if(te instanceof Tr){var pe=te.__data__;if(!vt||pe.length<t-1)return pe.push([I,j]),this.size=++te.size,this;te=this.__data__=new cn(pe)}return te.set(I,j),this.size=te.size,this}zr.prototype.clear=Na,zr.prototype.delete=$a,zr.prototype.get=La,zr.prototype.has=Ua,zr.prototype.set=Fs;function zs(I,j){var te=_i(I),pe=!te&&Zs(I),ct=!te&&!pe&&Yi(I),Te=!te&&!pe&&!ct&&ro(I),dt=te||pe||ct||Te,Ft=dt?gt(I.length,String):[],Xe=Ft.length;for(var ut in I)(j||Oe.call(I,ut))&&!(dt&&(ut=="length"||ct&&(ut=="offset"||ut=="parent")||Te&&(ut=="buffer"||ut=="byteLength"||ut=="byteOffset")||Ws(ut,Xe)))&&Ft.push(ut);return Ft}function Bn(I,j){for(var te=I.length;te--;)if(Xs(I[te][0],j))return te;return-1}function Gi(I,j,te){var pe=j(I);return _i(I)?pe:Ve(pe,te(I))}function Kn(I){return I==null?I===void 0?G:ie:nr&&nr in Object(I)?ks(I):qa(I)}function Wi(I){return kn(I)&&Kn(I)==f}function Vn(I,j,te,pe,ct){return I===j?!0:I==null||j==null||!kn(I)&&!kn(j)?I!==I&&j!==j:Hs(I,j,te,pe,Vn,ct)}function Hs(I,j,te,pe,ct,Te){var dt=_i(I),Ft=_i(j),Xe=dt?g:Xr(I),ut=Ft?g:Xr(j);Xe=Xe==f?$:Xe,ut=ut==f?$:ut;var Rt=Xe==$,dr=ut==$,zt=Xe==ut;if(zt&&Yi(I)){if(!Yi(j))return!1;dt=!0,Rt=!1}if(zt&&!Rt)return Te||(Te=new zr),dt||ro(I)?yi(I,j,te,pe,ct,Te):Ma(I,j,Xe,te,pe,ct,Te);if(!(te&o)){var pt=Rt&&Oe.call(I,"__wrapped__"),ir=dr&&Oe.call(j,"__wrapped__");if(pt||ir){var Hr=pt?I.value():I,Rr=ir?j.value():j;return Te||(Te=new zr),ct(Hr,Rr,te,pe,Te)}}return zt?(Te||(Te=new zr),Vs(I,j,te,pe,ct,Te)):!1}function ja(I){if(!to(I)||Js(I))return!1;var j=mi(I)?et:oe;return j.test(un(I))}function Bs(I){return kn(I)&&eo(I.length)&&!!le[Kn(I)]}function Ks(I){if(!Qs(I))return Hn(I);var j=[];for(var te in Object(I))Oe.call(I,te)&&te!="constructor"&&j.push(te);return j}function yi(I,j,te,pe,ct,Te){var dt=te&o,Ft=I.length,Xe=j.length;if(Ft!=Xe&&!(dt&&Xe>Ft))return!1;var ut=Te.get(I);if(ut&&Te.get(j))return ut==j;var Rt=-1,dr=!0,zt=te&c?new gi:void 0;for(Te.set(I,j),Te.set(j,I);++Rt<Ft;){var pt=I[Rt],ir=j[Rt];if(pe)var Hr=dt?pe(ir,pt,Rt,j,I,Te):pe(pt,ir,Rt,I,j,Te);if(Hr!==void 0){if(Hr)continue;dr=!1;break}if(zt){if(!je(j,function(Rr,Zr){if(!qe(zt,Zr)&&(pt===Rr||ct(pt,Rr,te,pe,Te)))return zt.push(Zr)})){dr=!1;break}}else if(!(pt===ir||ct(pt,ir,te,pe,Te))){dr=!1;break}}return Te.delete(I),Te.delete(j),dr}function Ma(I,j,te,pe,ct,Te,dt){switch(te){case ce:if(I.byteLength!=j.byteLength||I.byteOffset!=j.byteOffset)return!1;I=I.buffer,j=j.buffer;case se:return!(I.byteLength!=j.byteLength||!Te(new rr(I),new rr(j)));case v:case S:case B:return Xs(+I,+j);case D:return I.name==j.name&&I.message==j.message;case R:case u:return I==j+"";case z:var Ft=Ne;case E:var Xe=pe&o;if(Ft||(Ft=Fe),I.size!=j.size&&!Xe)return!1;var ut=dt.get(I);if(ut)return ut==j;pe|=c,dt.set(I,j);var Rt=yi(Ft(I),Ft(j),pe,ct,Te,dt);return dt.delete(I),Rt;case b:if(Pt)return Pt.call(I)==Pt.call(j)}return!1}function Vs(I,j,te,pe,ct,Te){var dt=te&o,Ft=vi(I),Xe=Ft.length,ut=vi(j),Rt=ut.length;if(Xe!=Rt&&!dt)return!1;for(var dr=Xe;dr--;){var zt=Ft[dr];if(!(dt?zt in j:Oe.call(j,zt)))return!1}var pt=Te.get(I);if(pt&&Te.get(j))return pt==j;var ir=!0;Te.set(I,j),Te.set(j,I);for(var Hr=dt;++dr<Xe;){zt=Ft[dr];var Rr=I[zt],Zr=j[zt];if(pe)var Ji=dt?pe(Zr,Rr,zt,j,I,Te):pe(Rr,Zr,zt,I,j,Te);if(!(Ji===void 0?Rr===Zr||ct(Rr,Zr,te,pe,Te):Ji)){ir=!1;break}Hr||(Hr=zt=="constructor")}if(ir&&!Hr){var Gn=I.constructor,Vt=j.constructor;Gn!=Vt&&"constructor"in I&&"constructor"in j&&!(typeof Gn=="function"&&Gn instanceof Gn&&typeof Vt=="function"&&Vt instanceof Vt)&&(ir=!1)}return Te.delete(I),Te.delete(j),ir}function vi(I){return Gi(I,Ha,Gs)}function On(I,j){var te=I.__data__;return Ys(j)?te[typeof j=="string"?"string":"hash"]:te.map}function Er(I,j){var te=xe(I,j);return ja(te)?te:void 0}function ks(I){var j=Oe.call(I,nr),te=I[nr];try{I[nr]=void 0;var pe=!0}catch{}var ct=We.call(I);return pe&&(j?I[nr]=te:delete I[nr]),ct}var Gs=an?function(I){return I==null?[]:(I=Object(I),He(an(I),function(j){return fr.call(I,j)}))}:at,Xr=Kn;(Dt&&Xr(new Dt(new ArrayBuffer(1)))!=ce||vt&&Xr(new vt)!=z||St&&Xr(St.resolve())!=U||It&&Xr(new It)!=E||wt&&Xr(new wt)!=W)&&(Xr=function(I){var j=Kn(I),te=j==$?I.constructor:void 0,pe=te?un(te):"";if(pe)switch(pe){case Lt:return ce;case Ut:return z;case xt:return U;case jt:return E;case Ot:return W}return j});function Ws(I,j){return j=j??h,!!j&&(typeof I=="number"||we.test(I))&&I>-1&&I%1==0&&I<j}function Ys(I){var j=typeof I;return j=="string"||j=="number"||j=="symbol"||j=="boolean"?I!=="__proto__":I===null}function Js(I){return!!ke&&ke in I}function Qs(I){var j=I&&I.constructor,te=typeof j=="function"&&j.prototype||Se;return I===te}function qa(I){return We.call(I)}function un(I){if(I!=null){try{return Be.call(I)}catch{}try{return I+""}catch{}}return""}function Xs(I,j){return I===j||I!==I&&j!==j}var Zs=Wi(function(){return arguments}())?Wi:function(I){return kn(I)&&Oe.call(I,"callee")&&!fr.call(I,"callee")},_i=Array.isArray;function Fa(I){return I!=null&&eo(I.length)&&!mi(I)}var Yi=xn||st;function za(I,j){return Vn(I,j)}function mi(I){if(!to(I))return!1;var j=Kn(I);return j==x||j==O||j==p||j==P}function eo(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=h}function to(I){var j=typeof I;return I!=null&&(j=="object"||j=="function")}function kn(I){return I!=null&&typeof I=="object"}var ro=Ie?yt(Ie):Bs;function Ha(I){return Fa(I)?zs(I):Ks(I)}function at(){return[]}function st(){return!1}n.exports=za})(sa,sa.exports);var r6=sa.exports;const n6=aa(r6);function i6(n,e){return e=e||{},new Promise(function(t,i){var o=new XMLHttpRequest,c=[],h=[],f={},g=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:g,headers:{keys:function(){return c},entries:function(){return h},get:function(v){return f[v.toLowerCase()]},has:function(v){return v.toLowerCase()in f}}}};for(var p in o.open(e.method||"get",n,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(v,S,D){c.push(S=S.toLowerCase()),h.push([S,D]),f[S]=f[S]?f[S]+","+D:D}),t(g())},o.onerror=i,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(p,e.headers[p]);o.send(e.body||null)})}const s6=Object.freeze(Object.defineProperty({__proto__:null,default:i6},Symbol.toStringTag,{value:"Module"})),_d=Fi(s6);var o6=self.fetch||(self.fetch=_d.default||_d);const a6=aa(o6);var c6={};function u6(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var o=0;o<n.length;o++){var c=n.charAt(o),h=c.charCodeAt(0);if(t[h]!==255)throw new TypeError(c+" is ambiguous");t[h]=o}var f=n.length,g=n.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function S(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var z=0,B=0,ie=0,$=O.length;ie!==$&&O[ie]===0;)ie++,z++;for(var U=($-ie)*v+1>>>0,P=new Uint8Array(U);ie!==$;){for(var R=O[ie],E=0,u=U-1;(R!==0||E<B)&&u!==-1;u--,E++)R+=256*P[u]>>>0,P[u]=R%f>>>0,R=R/f>>>0;if(R!==0)throw new Error("Non-zero carry");B=E,ie++}for(var b=U-B;b!==U&&P[b]===0;)b++;for(var G=g.repeat(z);b<U;++b)G+=n.charAt(P[b]);return G}function D(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var z=0;if(O[z]!==" "){for(var B=0,ie=0;O[z]===g;)B++,z++;for(var $=(O.length-z)*p+1>>>0,U=new Uint8Array($);O[z];){var P=t[O.charCodeAt(z)];if(P===255)return;for(var R=0,E=$-1;(P!==0||R<ie)&&E!==-1;E--,R++)P+=f*U[E]>>>0,U[E]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");ie=R,z++}if(O[z]!==" "){for(var u=$-ie;u!==$&&U[u]===0;)u++;for(var b=new Uint8Array(B+($-u)),G=B;u!==$;)b[G++]=U[u++];return b}}}function x(O){var z=D(O);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:S,decodeUnsafe:D,decode:x}}var h6=u6,l6=h6;const ng=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},f6=n=>new TextEncoder().encode(n),d6=n=>new TextDecoder().decode(n);class p6{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class g6{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ig(this,e)}}class y6{constructor(e){this.decoders=e}or(e){return ig(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ig=(n,e)=>new y6({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class v6{constructor(e,t,i,o){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=o,this.encoder=new p6(e,t,i),this.decoder=new g6(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ba=({name:n,prefix:e,encode:t,decode:i})=>new v6(n,e,t,i),js=({prefix:n,name:e,alphabet:t})=>{const{encode:i,decode:o}=l6(t,e);return ba({prefix:n,name:e,encode:i,decode:c=>ng(o(c))})},_6=(n,e,t,i)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=n.length;for(;n[c-1]==="=";)--c;const h=new Uint8Array(c*t/8|0);let f=0,g=0,p=0;for(let v=0;v<c;++v){const S=o[n[v]];if(S===void 0)throw new SyntaxError(`Non-${i} character`);g=g<<t|S,f+=t,f>=8&&(f-=8,h[p++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return h},m6=(n,e,t)=>{const i=e[e.length-1]==="=",o=(1<<t)-1;let c="",h=0,f=0;for(let g=0;g<n.length;++g)for(f=f<<8|n[g],h+=8;h>t;)h-=t,c+=e[o&f>>h];if(h&&(c+=e[o&f<<t-h]),i)for(;c.length*t&7;)c+="=";return c},Qt=({name:n,prefix:e,bitsPerChar:t,alphabet:i})=>ba({prefix:e,name:n,encode(o){return m6(o,i,t)},decode(o){return _6(o,i,t,n)}}),b6=ba({prefix:"\0",name:"identity",encode:n=>d6(n),decode:n=>f6(n)});var w6=Object.freeze({__proto__:null,identity:b6});const E6=Qt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var D6=Object.freeze({__proto__:null,base2:E6});const S6=Qt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var I6=Object.freeze({__proto__:null,base8:S6});const x6=js({prefix:"9",name:"base10",alphabet:"0123456789"});var O6=Object.freeze({__proto__:null,base10:x6});const P6=Qt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),C6=Qt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var A6=Object.freeze({__proto__:null,base16:P6,base16upper:C6});const T6=Qt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),R6=Qt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),N6=Qt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$6=Qt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),L6=Qt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),U6=Qt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),j6=Qt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),M6=Qt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),q6=Qt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var F6=Object.freeze({__proto__:null,base32:T6,base32upper:R6,base32pad:N6,base32padupper:$6,base32hex:L6,base32hexupper:U6,base32hexpad:j6,base32hexpadupper:M6,base32z:q6});const z6=js({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),H6=js({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var B6=Object.freeze({__proto__:null,base36:z6,base36upper:H6});const K6=js({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),V6=js({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var k6=Object.freeze({__proto__:null,base58btc:K6,base58flickr:V6});const G6=Qt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),W6=Qt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Y6=Qt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),J6=Qt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Q6=Object.freeze({__proto__:null,base64:G6,base64pad:W6,base64url:Y6,base64urlpad:J6});const sg=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),X6=sg.reduce((n,e,t)=>(n[t]=e,n),[]),Z6=sg.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function eI(n){return n.reduce((e,t)=>(e+=X6[t],e),"")}function tI(n){const e=[];for(const t of n){const i=Z6[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const rI=ba({prefix:"🚀",name:"base256emoji",encode:eI,decode:tI});var nI=Object.freeze({__proto__:null,base256emoji:rI}),iI=og,md=128,sI=127,oI=~sI,aI=Math.pow(2,31);function og(n,e,t){e=e||[],t=t||0;for(var i=t;n>=aI;)e[t++]=n&255|md,n/=128;for(;n&oI;)e[t++]=n&255|md,n>>>=7;return e[t]=n|0,og.bytes=t-i+1,e}var cI=Mu,uI=128,bd=127;function Mu(n,i){var t=0,i=i||0,o=0,c=i,h,f=n.length;do{if(c>=f)throw Mu.bytes=0,new RangeError("Could not decode varint");h=n[c++],t+=o<28?(h&bd)<<o:(h&bd)*Math.pow(2,o),o+=7}while(h>=uI);return Mu.bytes=c-i,t}var hI=Math.pow(2,7),lI=Math.pow(2,14),fI=Math.pow(2,21),dI=Math.pow(2,28),pI=Math.pow(2,35),gI=Math.pow(2,42),yI=Math.pow(2,49),vI=Math.pow(2,56),_I=Math.pow(2,63),mI=function(n){return n<hI?1:n<lI?2:n<fI?3:n<dI?4:n<pI?5:n<gI?6:n<yI?7:n<vI?8:n<_I?9:10},bI={encode:iI,decode:cI,encodingLength:mI},ag=bI;const wd=(n,e,t=0)=>(ag.encode(n,e,t),e),Ed=n=>ag.encodingLength(n),qu=(n,e)=>{const t=e.byteLength,i=Ed(n),o=i+Ed(t),c=new Uint8Array(o+t);return wd(n,c,0),wd(t,c,i),c.set(e,o),new wI(n,t,e,c)};class wI{constructor(e,t,i,o){this.code=e,this.size=t,this.digest=i,this.bytes=o}}const cg=({name:n,code:e,encode:t})=>new EI(n,e,t);class EI{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?qu(this.code,t):t.then(i=>qu(this.code,i))}else throw Error("Unknown type, must be binary type")}}const ug=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),DI=cg({name:"sha2-256",code:18,encode:ug("SHA-256")}),SI=cg({name:"sha2-512",code:19,encode:ug("SHA-512")});var II=Object.freeze({__proto__:null,sha256:DI,sha512:SI});const hg=0,xI="identity",lg=ng,OI=n=>qu(hg,lg(n)),PI={code:hg,name:xI,encode:lg,digest:OI};var CI=Object.freeze({__proto__:null,identity:PI});new TextEncoder,new TextDecoder;const Dd={...w6,...D6,...I6,...O6,...A6,...F6,...B6,...k6,...Q6,...nI};({...II,...CI});function fg(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function AI(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?fg(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function dg(n,e,t,i){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:i}}}const Sd=dg("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),su=dg("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=AI(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),TI={utf8:Sd,"utf-8":Sd,hex:Dd.base16,latin1:su,ascii:su,binary:su,...Dd};function RI(n,e="utf8"){const t=TI[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?fg(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}const pg="wc",NI=2,uh="core",Mn=`${pg}@2:${uh}:`,$I={name:uh,logger:"error"},LI={database:":memory:"},UI="crypto",Id="client_ed25519_seed",jI=ve.ONE_DAY,MI="keychain",qI="0.3",FI="messages",zI="0.3",HI=ve.SIX_HOURS,BI="publisher",gg="irn",KI="error",yg="wss://relay.walletconnect.com",xd="wss://relay.walletconnect.org",VI="relayer",tr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},kI="_subscription",wn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},GI=ve.ONE_SECOND,WI="2.11.0",YI=1e4,JI="0.3",QI="WALLETCONNECT_CLIENT_ID",Gr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},XI="subscription",ZI="0.3",ex=ve.FIVE_SECONDS*1e3,tx="pairing",rx="0.3",ys={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},Es={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},sn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},nx="history",ix="0.3",sx="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},ox="0.3",ou="verify-api",Li="https://verify.walletconnect.com",Fu="https://verify.walletconnect.org",ax=[Li,Fu],cx="echo",ux="https://echo.walletconnect.com";class hx{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=MI,this.version=qI,this.initialized=!1,this.storagePrefix=Mn,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,o)=>{this.isInitialized(),this.keychain.set(i,o),await this.persist()},this.get=i=>{this.isInitialized();const o=this.keychain.get(i);if(typeof o>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(c)}return o},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Rp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Np(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class lx{constructor(e,t,i){this.core=e,this.logger=t,this.name=UI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=hd(o);return Wp(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=t3();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),h=hd(c),f=xu();return await d2(f,o,jI,h)},this.generateSharedKey=(o,c,h)=>{this.isInitialized();const f=this.getPrivateKey(o),g=r3(f,c);return this.setSymKey(g,h)},this.setSymKey=async(o,c)=>{this.isInitialized();const h=c||n3(o);return await this.keychain.set(h,o),h},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,h)=>{this.isInitialized();const f=Tp(h),g=ai(c);if(Mf(f)){const D=f.senderPublicKey,x=f.receiverPublicKey;o=await this.generateSharedKey(D,x)}const p=this.getSymKey(o),{type:v,senderPublicKey:S}=f;return s3({type:v,symKey:p,message:g,senderPublicKey:S})},this.decode=async(o,c,h)=>{this.isInitialized();const f=c3(c,h);if(Mf(f)){const g=f.receiverPublicKey,p=f.senderPublicKey;o=await this.generateSharedKey(g,p)}try{const g=this.getSymKey(o),p=o3({symKey:g,encoded:c});return Us(p)}catch(g){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(g)}},this.getPayloadType=o=>{const c=ra(o);return Ns(c.type)},this.getPayloadSenderPublicKey=o=>{const c=ra(o);return c.senderPublicKey?lr(c.senderPublicKey,hr):void 0},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.keychain=i||new hx(this.core,this.logger)}get context(){return Je.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Id)}catch{e=xu(),await this.keychain.set(Id,e)}return RI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class fx extends KS{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=FI,this.version=zI,this.initialized=!1,this.storagePrefix=Mn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,o)=>{this.isInitialized();const c=ji(o);let h=this.messages.get(i);return typeof h>"u"&&(h={}),typeof h[c]<"u"||(h[c]=o,this.messages.set(i,h),await this.persist()),c},this.get=i=>{this.isInitialized();let o=this.messages.get(i);return typeof o>"u"&&(o={}),o},this.has=(i,o)=>{this.isInitialized();const c=this.get(i),h=ji(o);return typeof c[h]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Je.generateChildLogger(e,this.name),this.core=t}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Rp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Np(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class dx extends VS{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Cr.EventEmitter,this.name=BI,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(i,o,c)=>{var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||HI,g=Ou(c),p=(c==null?void 0:c.prompt)||!1,v=(c==null?void 0:c.tag)||0,S=(c==null?void 0:c.id)||eg().toString(),D={topic:i,message:o,opts:{ttl:f,relay:g,prompt:p,tag:v,id:S}},x=setTimeout(()=>this.queue.set(S,D),this.publishTimeout);try{await await Os(this.rpcPublish(i,o,f,g,p,v,S),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(S),this.relayer.events.emit(tr.publish,D)}catch(O){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(h=c==null?void 0:c.internal)!=null&&h.throwOnFailedPublish)throw this.removeRequestFromQueue(S),O;return}finally{clearTimeout(x)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Je.getLoggerContext(this.logger)}rpcPublish(e,t,i,o,c,h,f){var g,p,v,S;const D={method:Jo(o.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:c,tag:h},id:f};return ur((g=D.params)==null?void 0:g.prompt)&&((p=D.params)==null||delete p.prompt),ur((v=D.params)==null?void 0:v.tag)&&((S=D.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:D}),this.relayer.request(D)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:i,opts:o}=e;await this.publish(t,i,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(ki.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(tr.connection_stalled);return}this.checkQueue()}),this.relayer.on(tr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class px{constructor(){this.map=new Map,this.set=(e,t)=>{const i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,t))return;const o=i.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var gx=Object.defineProperty,yx=Object.defineProperties,vx=Object.getOwnPropertyDescriptors,Od=Object.getOwnPropertySymbols,_x=Object.prototype.hasOwnProperty,mx=Object.prototype.propertyIsEnumerable,Pd=(n,e,t)=>e in n?gx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vs=(n,e)=>{for(var t in e||(e={}))_x.call(e,t)&&Pd(n,t,e[t]);if(Od)for(var t of Od(e))mx.call(e,t)&&Pd(n,t,e[t]);return n},au=(n,e)=>yx(n,vx(e));class bx extends WS{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new px,this.events=new Cr.EventEmitter,this.name=XI,this.version=ZI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Mn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:o}});try{const c=Ou(o),h={topic:i,relay:c};this.pending.set(i,h);const f=await this.rpcSubscribe(i,c);return this.onSubscribe(f,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(i,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(i,o.id,o):await this.unsubscribeByTopic(i,o)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((o,c)=>{const h=new ve.Watch;h.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(f),h.stop(this.pendingSubscriptionWatchLabel),o(!0)),h.elapsed(this.pendingSubscriptionWatchLabel)>=ex&&(clearInterval(f),h.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.clientId=""}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const i=this.topicMap.get(e);await Promise.all(i.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{const o=Ou(i);await this.rpcUnsubscribe(e,t,o);const c=At("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const i={method:Jo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await Os(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(tr.connection_stalled)}return ji(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,i={method:Jo(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await Os(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(tr.connection_stalled)}}rpcUnsubscribe(e,t,i){const o={method:Jo(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,au(vs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,vs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,vs({},t)),this.topicMap.set(t.topic,e),this.events.emit(Gr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:i}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Gr.deleted,au(vs({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Gr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Gr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);on(t)&&this.onBatchSubscribe(t.map((i,o)=>au(vs({},e[o]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(ki.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(tr.connect,async()=>{await this.onConnect()}),this.relayer.on(tr.disconnect,()=>{this.onDisconnect()}),this.events.on(Gr.created,async e=>{const t=Gr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Gr.deleted,async e=>{const t=Gr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var wx=Object.defineProperty,Cd=Object.getOwnPropertySymbols,Ex=Object.prototype.hasOwnProperty,Dx=Object.prototype.propertyIsEnumerable,Ad=(n,e,t)=>e in n?wx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Sx=(n,e)=>{for(var t in e||(e={}))Ex.call(e,t)&&Ad(n,t,e[t]);if(Cd)for(var t of Cd(e))Dx.call(e,t)&&Ad(n,t,e[t]);return n};class Ix extends kS{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Cr.EventEmitter,this.name=VI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(tr.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(tr.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(wn.payload,this.onPayloadHandler),this.provider.on(wn.connect,this.onConnectHandler),this.provider.on(wn.disconnect,this.onDisconnectHandler),this.provider.on(wn.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Je.generateChildLogger(e.logger,this.name):Je.pino(Je.getDefaultLoggerOptions({level:e.logger||KI})),this.messages=new fx(this.logger,e.core),this.subscriber=new bx(this,this.logger),this.publisher=new dx(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||yg,this.projectId=e.projectId,this.bundleId=p3(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${xd}...`),await this.restartTransport(xd)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},YI)}get context(){return Je.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var i;this.isInitialized();let o=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"";if(o)return o;let c;const h=f=>{f.topic===e&&(this.subscriber.off(Gr.created,h),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Gr.created,h)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Os(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Gr.resubscribed,()=>{t()})}),new Promise(async(t,i)=>{try{await Os(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){i(o);return}t()})])}catch(t){this.logger.error(t);const i=t;if(!this.isConnectionStalled(i.message))throw t;this.provider.events.emit(wn.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Yf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Sn(new t6(b3({sdkVersion:WI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){const{topic:t,message:i}=e;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,i);return o&&this.logger.debug(`Ignoring duplicate message: ${i}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ch(e)){if(!e.method.endsWith(kI))return;const t=e.params,{topic:i,message:o,publishedAt:c}=t.data,h={topic:i,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Sx({type:"event",event:t.id},h)),this.events.emit(t.id,h),await this.acknowledgePayload(e),await this.onMessageEvent(h)}else ma(e)&&this.events.emit(tr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(tr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=va(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(wn.payload,this.onPayloadHandler),this.provider.off(wn.connect,this.onConnectHandler),this.provider.off(wn.disconnect,this.onDisconnectHandler),this.provider.off(wn.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(tr.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await Yf();fD(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(i=>this.logger.error(i))))})}onProviderDisconnect(){this.events.emit(tr.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ve.toMiliseconds(GI)))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var xx=Object.defineProperty,Td=Object.getOwnPropertySymbols,Ox=Object.prototype.hasOwnProperty,Px=Object.prototype.propertyIsEnumerable,Rd=(n,e,t)=>e in n?xx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Nd=(n,e)=>{for(var t in e||(e={}))Ox.call(e,t)&&Rd(n,t,e[t]);if(Td)for(var t of Td(e))Px.call(e,t)&&Rd(n,t,e[t]);return n};class wa extends GS{constructor(e,t,i,o=Mn,c=void 0){super(e,t,i,o),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=JI,this.cached=[],this.initialized=!1,this.storagePrefix=Mn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!ur(h)?this.map.set(this.getKey(h),h):B3(h)?this.map.set(h.id,h):K3(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,f)=>{this.isInitialized(),this.map.has(h)?await this.update(h,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:f}),this.map.set(h,f),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(f=>Object.keys(h).every(g=>n6(f[g],h[g]))):this.values),this.update=async(h,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:f});const g=Nd(Nd({},this.getData(h)),f);this.map.set(h,g),await this.persist()},this.delete=async(h,f)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:f}),this.map.delete(h),await this.persist())},this.logger=Je.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:i}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Cx{constructor(e,t){this.core=e,this.logger=t,this.name=tx,this.version=rx,this.events=new ku,this.initialized=!1,this.storagePrefix=Mn,this.ignoredPayloadTypes=[ui],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=xu(),o=await this.core.crypto.setSymKey(i),c=Wr(ve.FIVE_MINUTES),h={protocol:gg},f={topic:o,expiry:c,relay:h,active:!1},g=N3({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:i,relay:h});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:g}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:o,symKey:c,relay:h}=Kf(i.uri);let f;if(this.pairings.keys.includes(o)&&(f=this.pairings.get(o),f.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const g=Wr(ve.FIVE_MINUTES),p={topic:o,relay:h,expiry:g,active:!1};return await this.pairings.set(o,p),this.core.expirer.set(o,g),i.activatePairing&&await this.activate({topic:o}),this.events.emit(Es.create,p),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:h})),p},this.activate=async({topic:i})=>{this.isInitialized();const o=Wr(ve.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:o}),this.core.expirer.set(i,o)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:o}=i;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:h,resolve:f,reject:g}=$i();this.events.once(Ht("pairing_ping",c),({error:p})=>{p?g(p):f()}),await h()}},this.updateExpiry=async({topic:i,expiry:o})=>{this.isInitialized(),await this.pairings.update(i,{expiry:o})},this.updateMetadata=async({topic:i,metadata:o})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:o}=i;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",At("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(i,o,c)=>{const h=qi(o,c),f=await this.core.crypto.encode(i,h),g=ys[o].req;return this.core.history.set(i,h),this.core.relayer.publish(i,f,g),h.id},this.sendResult=async(i,o,c)=>{const h=va(i,c),f=await this.core.crypto.encode(o,h),g=await this.core.history.get(o,i),p=ys[g.request.method].res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(h)},this.sendError=async(i,o,c)=>{const h=_a(i,c),f=await this.core.crypto.encode(o,h),g=await this.core.history.get(o,i),p=ys[g.request.method]?ys[g.request.method].res:ys.unregistered_method.res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(h)},this.deletePairing=async(i,o)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,At("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),o?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(o=>jn(o.expiry));await Promise.all(i.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=i=>{const{topic:o,payload:c}=i;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async i=>{const{topic:o,payload:c}=i,h=(await this.core.history.get(o,c.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(i,o)=>{const{id:c}=o;try{this.isValidPing({topic:i}),await this.sendResult(c,i,!0),this.events.emit(Es.ping,{id:c,topic:i})}catch(h){await this.sendError(c,i,h),this.logger.error(h)}},this.onPairingPingResponse=(i,o)=>{const{id:c}=o;setTimeout(()=>{Dn(o)?this.events.emit(Ht("pairing_ping",c),{}):Yr(o)&&this.events.emit(Ht("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(i,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(Es.delete,{id:c,topic:i})}catch(h){await this.sendError(c,i,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(i,o)=>{const{id:c,method:h}=o;try{if(this.registeredMethods.includes(h))return;const f=At("WC_METHOD_UNSUPPORTED",h);await this.sendError(c,i,f),this.logger.error(f)}catch(f){await this.sendError(c,i,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(At("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{var o;if(!br(i)){const{message:h}=ue("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(h)}if(!H3(i.uri)){const{message:h}=ue("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(h)}const c=Kf(i.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:h}=ue("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(h)}if(!(c!=null&&c.symKey)){const{message:h}=ue("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(h)}},this.isValidPing=async i=>{if(!br(i)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(c)}const{topic:o}=i;await this.isValidPairingTopic(o)},this.isValidDisconnect=async i=>{if(!br(i)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(c)}const{topic:o}=i;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async i=>{if(!Wt(i,!1)){const{message:o}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(o)}if(!this.pairings.keys.includes(i)){const{message:o}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(o)}if(jn(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:o}=ue("EXPIRED",`pairing topic: ${i}`);throw new Error(o)}},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.pairings=new wa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Je.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tr.message,async e=>{const{topic:t,message:i}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const o=await this.core.crypto.decode(t,i);try{ch(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ma(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async e=>{const{topic:t}=Lp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Es.expire,{topic:t}))})}}class Ax extends BS{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Cr.EventEmitter,this.name=nx,this.version=ix,this.cached=[],this.initialized=!1,this.storagePrefix=Mn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:o,chainId:c}),this.records.has(o.id))return;const h={id:o.id,topic:i,request:{method:o.method,params:o.params||null},chainId:c,expiry:Wr(ve.THIRTY_DAYS)};this.records.set(h.id,h),this.events.emit(sn.created,h)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const o=await this.getRecord(i.id);typeof o.response>"u"&&(o.response=Yr(i)?{error:i.error}:{result:i.result},this.records.set(o.id,o),this.events.emit(sn.updated,o))},this.get=async(i,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:o}),await this.getRecord(o)),this.delete=(i,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===i){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(sn.deleted,c)}})},this.exists=async(i,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===i:!1),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const i={topic:t.topic,request:qi(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:i}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(sn.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(sn.created,e=>{const t=sn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(sn.updated,e=>{const t=sn.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(sn.deleted,e=>{const t=sn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(ki.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ve.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Tx extends YS{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Cr.EventEmitter,this.name=sx,this.version=ox,this.cached=[],this.initialized=!1,this.storagePrefix=Mn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const o=this.formatTarget(i);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(i,o)=>{this.isInitialized();const c=this.formatTarget(i),h={target:c,expiry:o};this.expirations.set(c,h),this.checkExpiry(c,h),this.events.emit(Fr.created,{target:c,expiration:h})},this.get=i=>{this.isInitialized();const o=this.formatTarget(i);return this.getExpiration(o)},this.del=i=>{if(this.isInitialized(),this.has(i)){const o=this.formatTarget(i),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Fr.deleted,{target:o,expiration:c})}},this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return w3(e);if(typeof e=="number")return E3(e);const{message:t}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:i}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}checkExpiry(e,t){const{expiry:i}=t;ve.toMiliseconds(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Fr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(ki.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,e=>{const t=Fr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fr.expired,e=>{const t=Fr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fr.deleted,e=>{const t=Fr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Rx extends JS{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=ou,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async i=>{if(this.verifyDisabled||Bi()||!Ki())return;const o=this.getVerifyUrl(i==null?void 0:i.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Fu;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async i=>{this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),await this.init())},this.resolve=async i=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(i==null?void 0:i.verifyUrl);let c;try{c=await this.fetchAttestation(i.attestationId,o)}catch(h){this.logger.info(`failed to resolve attestation: ${i.attestationId} from url: ${o}`),this.logger.info(h),c=await this.fetchAttestation(i.attestationId,Fu)}return c},this.fetchAttestation=async(i,o)=>{this.logger.info(`resolving attestation: ${i} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),h=await fetch(`${o}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(c),h.status===200?await h.json():void 0},this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let i;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),i())};await Promise.race([new Promise(c=>{if(document.getElementById(ou))return c();window.addEventListener("message",o);const h=document.createElement("iframe");h.id=ou,h.src=`${this.verifyUrl}/${this.projectId}`,h.style.display="none",document.body.append(h),this.iframe=h,i=c}),new Promise((c,h)=>setTimeout(()=>{window.removeEventListener("message",o),h("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=i=>{let o=i||Li;return ax.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Li}`),o=Li),o},this.logger=Je.generateChildLogger(t,this.name),this.verifyUrl=Li,this.abortController=new AbortController,this.isDevEnv=rh()&&c6.IS_VITEST}get context(){return Je.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(e))}}class Nx extends QS{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=cx,this.registerDeviceToken=async i=>{const{clientId:o,token:c,notificationType:h,enableEncrypted:f=!1}=i,g=`${ux}/${this.projectId}/clients`;await a6(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:h,token:c,always_raw:f})})},this.logger=Je.generateChildLogger(t,this.context)}}var $x=Object.defineProperty,$d=Object.getOwnPropertySymbols,Lx=Object.prototype.hasOwnProperty,Ux=Object.prototype.propertyIsEnumerable,Ld=(n,e,t)=>e in n?$x(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ud=(n,e)=>{for(var t in e||(e={}))Lx.call(e,t)&&Ld(n,t,e[t]);if($d)for(var t of $d(e))Ux.call(e,t)&&Ld(n,t,e[t]);return n};class hh extends HS{constructor(e){super(e),this.protocol=pg,this.version=NI,this.name=uh,this.events=new Cr.EventEmitter,this.initialized=!1,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||yg,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||$I.logger}));this.logger=Je.generateChildLogger(t,this.name),this.heartbeat=new ki.HeartBeat,this.crypto=new lx(this,this.logger,e==null?void 0:e.keychain),this.history=new Ax(this,this.logger),this.expirer=new Tx(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new kD(Ud(Ud({},LI),e==null?void 0:e.storageOptions)),this.relayer=new Ix({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Cx(this,this.logger),this.verify=new Rx(this.projectId||"",this.logger),this.echoClient=new Nx(this.projectId||"",this.logger)}static async init(e){const t=new hh(e);await t.initialize();const i=await t.crypto.getClientId();return await t.storage.setItem(QI,i),t}get context(){return Je.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const jx=hh,vg="wc",_g=2,mg="client",lh=`${vg}@${_g}:${mg}:`,cu={name:mg,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},jd="WALLETCONNECT_DEEPLINK_CHOICE",Mx="proposal",bg="Proposal expired",qx="session",ko=ve.SEVEN_DAYS,Fx="engine",_s={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},uu={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},En={idle:"IDLE",active:"ACTIVE"},zx="request",Hx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Bx=Object.defineProperty,Kx=Object.defineProperties,Vx=Object.getOwnPropertyDescriptors,Md=Object.getOwnPropertySymbols,kx=Object.prototype.hasOwnProperty,Gx=Object.prototype.propertyIsEnumerable,qd=(n,e,t)=>e in n?Bx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_r=(n,e)=>{for(var t in e||(e={}))kx.call(e,t)&&qd(n,t,e[t]);if(Md)for(var t of Md(e))Gx.call(e,t)&&qd(n,t,e[t]);return n},ms=(n,e)=>Kx(n,Vx(e));class Wx extends ZS{constructor(e){super(e),this.name=Fx,this.events=new ku,this.initialized=!1,this.ignoredPayloadTypes=[ui],this.requestQueue={state:En.idle,queue:[]},this.sessionRequestQueue={state:En.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(_s)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const i=ms(_r({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:h,sessionProperties:f,relays:g}=i;let p=o,v,S=!1;if(p&&(S=this.client.core.pairing.pairings.get(p).active),!p||!S){const{topic:U,uri:P}=await this.client.core.pairing.create();p=U,v=P}const D=await this.client.core.crypto.generateKeyPair(),x=_r({requiredNamespaces:c,optionalNamespaces:h,relays:g??[{protocol:gg}],proposer:{publicKey:D,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:O,resolve:z,done:B}=$i(ve.FIVE_MINUTES,bg);if(this.events.once(Ht("session_connect"),async({error:U,session:P})=>{if(U)O(U);else if(P){P.self.publicKey=D;const R=ms(_r({},P),{requiredNamespaces:P.requiredNamespaces,optionalNamespaces:P.optionalNamespaces});await this.client.session.set(P.topic,R),await this.setExpiry(P.topic,P.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:P.peer.metadata}),z(R)}}),!p){const{message:U}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(U)}const ie=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:x}),$=Wr(ve.FIVE_MINUTES);return await this.setProposal(ie,_r({id:ie,expiry:$},x)),{uri:v,approval:B}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:i,relayProtocol:o,namespaces:c,sessionProperties:h}=t,f=this.client.proposal.get(i);let{pairingTopic:g,proposer:p,requiredNamespaces:v,optionalNamespaces:S}=f;g=g||"",Mi(v)||(v=j3(c,"approve()"));const D=await this.client.core.crypto.generateKeyPair(),x=p.publicKey,O=await this.client.core.crypto.generateSharedKey(D,x);g&&i&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:p.metadata}),await this.sendResult({id:i,topic:g,result:{relay:{protocol:o??"irn"},responderPublicKey:D}}),await this.client.proposal.delete(i,At("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const z=_r({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:v,optionalNamespaces:S,pairingTopic:g,controller:{publicKey:D,metadata:this.client.metadata},expiry:Wr(ko)},h&&{sessionProperties:h});await this.client.core.relayer.subscribe(O),await this.sendRequest({topic:O,method:"wc_sessionSettle",params:z,throwOnFailedPublish:!0});const B=ms(_r({},z),{topic:O,pairingTopic:g,acknowledged:!1,self:z.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:D});return await this.client.session.set(O,B),await this.setExpiry(O,Wr(ko)),{topic:O,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(O)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:i,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(i);c&&(await this.sendError(i,c,o),await this.client.proposal.delete(i,At("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:i,namespaces:o}=t,c=await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:h,resolve:f,reject:g}=$i();return this.events.once(Ht("session_update",c),({error:p})=>{p?g(p):f()}),await this.client.session.update(i,{namespaces:o}),{acknowledged:h}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:i}=t,o=await this.sendRequest({topic:i,method:"wc_sessionExtend",params:{}}),{done:c,resolve:h,reject:f}=$i();return this.events.once(Ht("session_extend",o),({error:g})=>{g?f(g):h()}),await this.setExpiry(i,Wr(ko)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:i,request:o,topic:c,expiry:h}=t,f=ah(),{done:g,resolve:p,reject:v}=$i(h,"Request expired. Please try again.");return this.events.once(Ht("session_request",f),({error:S,result:D})=>{S?v(S):p(D)}),await Promise.all([new Promise(async S=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:i},expiry:h,throwOnFailedPublish:!0}).catch(D=>v(D)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:i,id:f}),S()}),new Promise(async S=>{const D=await S3(this.client.core.storage,jd);D3({id:f,topic:c,wcDeepLink:D}),S()}),g()]).then(S=>S[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:i,response:o}=t,{id:c}=o;Dn(o)?await this.sendResult({id:c,topic:i,result:o.result,throwOnFailedPublish:!0}):Yr(o)&&await this.sendError(c,i,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:i}=t;if(this.client.session.keys.includes(i)){const o=await this.sendRequest({topic:i,method:"wc_sessionPing",params:{}}),{done:c,resolve:h,reject:f}=$i();this.events.once(Ht("session_ping",o),({error:g})=>{g?f(g):h()}),await c()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:i,event:o,chainId:c}=t;await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:i}=t;this.client.session.keys.includes(i)?(await this.sendRequest({topic:i,method:"wc_sessionDelete",params:At("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(i=>F3(i,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const i=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var h,f;return((h=c.peerMetadata)==null?void 0:h.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==i.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(t,i)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,At("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),i||this.client.core.expirer.del(t),this.client.core.storage.removeItem(jd).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===t&&this.deletePendingSessionRequest(c.id,At("USER_DISCONNECTED"))})},this.deleteProposal=async(t,i)=>{await Promise.all([this.client.proposal.delete(t,At("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,i,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,i),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=En.idle)},this.setExpiry=async(t,i)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:i}),this.client.core.expirer.set(t,i)},this.setProposal=async(t,i)=>{await this.client.proposal.set(t,i),this.client.core.expirer.set(t,i.expiry)},this.setPendingSessionRequest=async t=>{const i=_s.wc_sessionRequest.req.ttl,{id:o,topic:c,params:h,verifyContext:f}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:h,verifyContext:f}),i&&this.client.core.expirer.set(o,Wr(i))},this.sendRequest=async t=>{const{topic:i,method:o,params:c,expiry:h,relayRpcId:f,clientRpcId:g,throwOnFailedPublish:p}=t,v=qi(o,c,g);if(Ki()&&Hx.includes(o)){const x=ji(JSON.stringify(v));this.client.core.verify.register({attestationId:x})}const S=await this.client.core.crypto.encode(i,v),D=_s[o].req;return h&&(D.ttl=h),f&&(D.id=f),this.client.core.history.set(i,v),p?(D.internal=ms(_r({},D.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,S,D)):this.client.core.relayer.publish(i,S,D).catch(x=>this.client.logger.error(x)),v.id},this.sendResult=async t=>{const{id:i,topic:o,result:c,throwOnFailedPublish:h}=t,f=va(i,c),g=await this.client.core.crypto.encode(o,f),p=await this.client.core.history.get(o,i),v=_s[p.request.method].res;h?(v.internal=ms(_r({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,g,v)):this.client.core.relayer.publish(o,g,v).catch(S=>this.client.logger.error(S)),await this.client.core.history.resolve(f)},this.sendError=async(t,i,o)=>{const c=_a(t,o),h=await this.client.core.crypto.encode(i,c),f=await this.client.core.history.get(i,t),g=_s[f.request.method].res;this.client.core.relayer.publish(i,h,g),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],i=[];this.client.session.getAll().forEach(o=>{jn(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{jn(o.expiry)&&i.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...i.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===En.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=En.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=En.idle},this.processRequest=t=>{const{topic:i,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(i,o);case"wc_sessionSettle":return this.onSessionSettleRequest(i,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,o);case"wc_sessionExtend":return this.onSessionExtendRequest(i,o);case"wc_sessionPing":return this.onSessionPingRequest(i,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,o);case"wc_sessionRequest":return this.onSessionRequest(i,o);case"wc_sessionEvent":return this.onSessionEventRequest(i,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:i,payload:o}=t,c=(await this.client.core.history.get(i,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(i,o);case"wc_sessionSettle":return this.onSessionSettleResponse(i,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,o);case"wc_sessionExtend":return this.onSessionExtendResponse(i,o);case"wc_sessionPing":return this.onSessionPingResponse(i,o);case"wc_sessionRequest":return this.onSessionRequestResponse(i,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:i}=t,{message:o}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,i)=>{const{params:o,id:c}=i;try{this.isValidConnect(_r({},i.params));const h=Wr(ve.FIVE_MINUTES),f=_r({id:c,pairingTopic:t,expiry:h},o);await this.setProposal(c,f);const g=ji(JSON.stringify(i)),p=await this.getVerifyContext(g,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:p})}catch(h){await this.sendError(c,t,h),this.client.logger.error(h)}},this.onSessionProposeResponse=async(t,i)=>{const{id:o}=i;if(Dn(i)){const{result:c}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const h=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const f=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const g=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const p=await this.client.core.crypto.generateSharedKey(f,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const v=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:v}),await this.client.core.pairing.activate({topic:t})}else Yr(i)&&(await this.client.proposal.delete(o,At("USER_DISCONNECTED")),this.events.emit(Ht("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(t,i)=>{const{id:o,params:c}=i;try{this.isValidSessionSettleRequest(c);const{relay:h,controller:f,expiry:g,namespaces:p,requiredNamespaces:v,optionalNamespaces:S,sessionProperties:D,pairingTopic:x}=i.params,O=_r({topic:t,relay:h,expiry:g,namespaces:p,acknowledged:!0,pairingTopic:x,requiredNamespaces:v,optionalNamespaces:S,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},D&&{sessionProperties:D});await this.sendResult({id:i.id,topic:t,result:!0}),this.events.emit(Ht("session_connect"),{session:O}),this.cleanupDuplicatePairings(O)}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.onSessionSettleResponse=async(t,i)=>{const{id:o}=i;Dn(i)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ht("session_approve",o),{})):Yr(i)&&(await this.client.session.delete(t,At("USER_DISCONNECTED")),this.events.emit(Ht("session_approve",o),{error:i.error}))},this.onSessionUpdateRequest=async(t,i)=>{const{params:o,id:c}=i;try{const h=`${t}_session_update`,f=Bo.get(h);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(_r({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),Bo.set(h,c)}catch(h){await this.sendError(c,t,h),this.client.logger.error(h)}},this.isRequestOutOfSync=(t,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,i)=>{const{id:o}=i;Dn(i)?this.events.emit(Ht("session_update",o),{}):Yr(i)&&this.events.emit(Ht("session_update",o),{error:i.error})},this.onSessionExtendRequest=async(t,i)=>{const{id:o}=i;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Wr(ko)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,i)=>{const{id:o}=i;Dn(i)?this.events.emit(Ht("session_extend",o),{}):Yr(i)&&this.events.emit(Ht("session_extend",o),{error:i.error})},this.onSessionPingRequest=async(t,i)=>{const{id:o}=i;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,i)=>{const{id:o}=i;setTimeout(()=>{Dn(i)?this.events.emit(Ht("session_ping",o),{}):Yr(i)&&this.events.emit(Ht("session_ping",o),{error:i.error})},500)},this.onSessionDeleteRequest=async(t,i)=>{const{id:o}=i;try{this.isValidDisconnect({topic:t,reason:i.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(tr.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult({id:o,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,i)=>{const{id:o,params:c}=i;try{this.isValidRequest(_r({topic:t},c));const h=ji(JSON.stringify(qi("wc_sessionRequest",c,o))),f=this.client.session.get(t),g=await this.getVerifyContext(h,f.peer.metadata),p={id:o,topic:t,params:c,verifyContext:g};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.onSessionRequestResponse=(t,i)=>{const{id:o}=i;Dn(i)?this.events.emit(Ht("session_request",o),{result:i.result}):Yr(i)&&this.events.emit(Ht("session_request",o),{error:i.error})},this.onSessionEventRequest=async(t,i)=>{const{id:o,params:c}=i;try{const h=`${t}_session_event_${c.event.name}`,f=Bo.get(h);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(_r({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),Bo.set(h,o)}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=En.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===En.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=En.active,this.client.events.emit("session_request",t)}catch(i){this.client.logger.error(i)}},this.onPairingCreated=t=>{if(t.active)return;const i=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);i&&this.onSessionProposeRequest(t.topic,qi("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id))},this.isValidConnect=async t=>{if(!br(t)){const{message:g}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(g)}const{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:h,relays:f}=t;if(ur(i)||await this.isValidPairingTopic(i),!X3(f,!0)){const{message:g}=ue("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(g)}!ur(o)&&Mi(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!ur(c)&&Mi(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),ur(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(t,i)=>{const o=Q3(t,"connect()",i);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!br(t))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:i,namespaces:o,relayProtocol:c,sessionProperties:h}=t;await this.isValidProposalId(i);const f=this.client.proposal.get(i),g=Qo(o,"approve()");if(g)throw new Error(g.message);const p=Gf(f.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Wt(c,!0)){const{message:v}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(v)}ur(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async t=>{if(!br(t)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:i,reason:o}=t;if(await this.isValidProposalId(i),!eD(o)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!br(t)){const{message:p}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:i,controller:o,namespaces:c,expiry:h}=t;if(!jp(i)){const{message:p}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const f=V3(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const g=Qo(c,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(jn(h)){const{message:p}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!br(t)){const{message:g}=ue("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(g)}const{topic:i,namespaces:o}=t;await this.isValidSessionTopic(i);const c=this.client.session.get(i),h=Qo(o,"update()");if(h)throw new Error(h.message);const f=Gf(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!br(t)){const{message:o}=ue("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:i}=t;await this.isValidSessionTopic(i)},this.isValidRequest=async t=>{if(!br(t)){const{message:g}=ue("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(g)}const{topic:i,request:o,chainId:c,expiry:h}=t;await this.isValidSessionTopic(i);const{namespaces:f}=this.client.session.get(i);if(!kf(f,c)){const{message:g}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(g)}if(!tD(o)){const{message:g}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(g)}if(!iD(f,c,o.method)){const{message:g}=ue("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(g)}if(h&&!cD(h,uu)){const{message:g}=ue("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${uu.min} and ${uu.max}`);throw new Error(g)}},this.isValidRespond=async t=>{var i;if(!br(t)){const{message:h}=ue("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(h)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(h){throw(i=t==null?void 0:t.response)!=null&&i.id&&this.cleanupAfterResponse(t),h}if(!rD(c)){const{message:h}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(h)}},this.isValidPing=async t=>{if(!br(t)){const{message:o}=ue("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async t=>{if(!br(t)){const{message:f}=ue("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:i,event:o,chainId:c}=t;await this.isValidSessionTopic(i);const{namespaces:h}=this.client.session.get(i);if(!kf(h,c)){const{message:f}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!nD(o)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!sD(h,c,o.name)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!br(t)){const{message:o}=ue("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(t,i)=>{const o={verified:{verifyUrl:i.verifyUrl||Li,validation:"UNKNOWN",origin:i.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:i.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(i.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,i)=>{Object.values(t).forEach(o=>{if(!Wt(o,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(tr.message,async e=>{const{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const o=await this.client.core.crypto.decode(t,i);try{ch(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ma(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async e=>{const{topic:t,id:i}=Lp(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,ue("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(Es.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Wt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(jn(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Wt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(jn(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=ue("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Wt(e,!1)){const{message:t}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Z3(e)){const{message:t}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(jn(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class Yx extends wa{constructor(e,t){super(e,t,Mx,lh),this.core=e,this.logger=t}}class Jx extends wa{constructor(e,t){super(e,t,qx,lh),this.core=e,this.logger=t}}class Qx extends wa{constructor(e,t){super(e,t,zx,lh,i=>i.id),this.core=e,this.logger=t}}let Xx=class wg extends XS{constructor(e){super(e),this.protocol=vg,this.version=_g,this.name=cu.name,this.events=new Cr.EventEmitter,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(o){throw this.logger.error(o.message),o}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(o){throw this.logger.error(o.message),o}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(o){throw this.logger.error(o.message),o}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(o){throw this.logger.error(o.message),o}},this.update=async i=>{try{return await this.engine.update(i)}catch(o){throw this.logger.error(o.message),o}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(o){throw this.logger.error(o.message),o}},this.request=async i=>{try{return await this.engine.request(i)}catch(o){throw this.logger.error(o.message),o}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(o){throw this.logger.error(o.message),o}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(o){throw this.logger.error(o.message),o}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(o){throw this.logger.error(o.message),o}},this.find=i=>{try{return this.engine.find(i)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=(e==null?void 0:e.name)||cu.name,this.metadata=(e==null?void 0:e.metadata)||y3();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||cu.logger}));this.core=(e==null?void 0:e.core)||new jx(e),this.logger=Je.generateChildLogger(t,this.name),this.session=new Jx(this.core,this.logger),this.proposal=new Yx(this.core,this.logger),this.pendingRequest=new Qx(this.core,this.logger),this.engine=new Wx(this)}static async init(e){const t=new wg(e);return await t.initialize(),t}get context(){return Je.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var zu={exports:{}};(function(n,e){var t=typeof self<"u"?self:Jr,i=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(h){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function g(w){return w&&DataView.prototype.isPrototypeOf(w)}if(f.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(w){return w&&p.indexOf(Object.prototype.toString.call(w))>-1};function S(w){if(typeof w!="string"&&(w=String(w)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(w))throw new TypeError("Invalid character in header field name");return w.toLowerCase()}function D(w){return typeof w!="string"&&(w=String(w)),w}function x(w){var A={next:function(){var ee=w.shift();return{done:ee===void 0,value:ee}}};return f.iterable&&(A[Symbol.iterator]=function(){return A}),A}function O(w){this.map={},w instanceof O?w.forEach(function(A,ee){this.append(ee,A)},this):Array.isArray(w)?w.forEach(function(A){this.append(A[0],A[1])},this):w&&Object.getOwnPropertyNames(w).forEach(function(A){this.append(A,w[A])},this)}O.prototype.append=function(w,A){w=S(w),A=D(A);var ee=this.map[w];this.map[w]=ee?ee+", "+A:A},O.prototype.delete=function(w){delete this.map[S(w)]},O.prototype.get=function(w){return w=S(w),this.has(w)?this.map[w]:null},O.prototype.has=function(w){return this.map.hasOwnProperty(S(w))},O.prototype.set=function(w,A){this.map[S(w)]=D(A)},O.prototype.forEach=function(w,A){for(var ee in this.map)this.map.hasOwnProperty(ee)&&w.call(A,this.map[ee],ee,this)},O.prototype.keys=function(){var w=[];return this.forEach(function(A,ee){w.push(ee)}),x(w)},O.prototype.values=function(){var w=[];return this.forEach(function(A){w.push(A)}),x(w)},O.prototype.entries=function(){var w=[];return this.forEach(function(A,ee){w.push([ee,A])}),x(w)},f.iterable&&(O.prototype[Symbol.iterator]=O.prototype.entries);function z(w){if(w.bodyUsed)return Promise.reject(new TypeError("Already read"));w.bodyUsed=!0}function B(w){return new Promise(function(A,ee){w.onload=function(){A(w.result)},w.onerror=function(){ee(w.error)}})}function ie(w){var A=new FileReader,ee=B(A);return A.readAsArrayBuffer(w),ee}function $(w){var A=new FileReader,ee=B(A);return A.readAsText(w),ee}function U(w){for(var A=new Uint8Array(w),ee=new Array(A.length),Q=0;Q<A.length;Q++)ee[Q]=String.fromCharCode(A[Q]);return ee.join("")}function P(w){if(w.slice)return w.slice(0);var A=new Uint8Array(w.byteLength);return A.set(new Uint8Array(w)),A.buffer}function R(){return this.bodyUsed=!1,this._initBody=function(w){this._bodyInit=w,w?typeof w=="string"?this._bodyText=w:f.blob&&Blob.prototype.isPrototypeOf(w)?this._bodyBlob=w:f.formData&&FormData.prototype.isPrototypeOf(w)?this._bodyFormData=w:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)?this._bodyText=w.toString():f.arrayBuffer&&f.blob&&g(w)?(this._bodyArrayBuffer=P(w.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(w)||v(w))?this._bodyArrayBuffer=P(w):this._bodyText=w=Object.prototype.toString.call(w):this._bodyText="",this.headers.get("content-type")||(typeof w=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var w=z(this);if(w)return w;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?z(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ie)}),this.text=function(){var w=z(this);if(w)return w;if(this._bodyBlob)return $(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(U(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(G)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function u(w){var A=w.toUpperCase();return E.indexOf(A)>-1?A:w}function b(w,A){A=A||{};var ee=A.body;if(w instanceof b){if(w.bodyUsed)throw new TypeError("Already read");this.url=w.url,this.credentials=w.credentials,A.headers||(this.headers=new O(w.headers)),this.method=w.method,this.mode=w.mode,this.signal=w.signal,!ee&&w._bodyInit!=null&&(ee=w._bodyInit,w.bodyUsed=!0)}else this.url=String(w);if(this.credentials=A.credentials||this.credentials||"same-origin",(A.headers||!this.headers)&&(this.headers=new O(A.headers)),this.method=u(A.method||this.method||"GET"),this.mode=A.mode||this.mode||null,this.signal=A.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})};function G(w){var A=new FormData;return w.trim().split("&").forEach(function(ee){if(ee){var Q=ee.split("="),V=Q.shift().replace(/\+/g," "),k=Q.join("=").replace(/\+/g," ");A.append(decodeURIComponent(V),decodeURIComponent(k))}}),A}function W(w){var A=new O,ee=w.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(Q){var V=Q.split(":"),k=V.shift().trim();if(k){var J=V.join(":").trim();A.append(k,J)}}),A}R.call(b.prototype);function se(w,A){A||(A={}),this.type="default",this.status=A.status===void 0?200:A.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in A?A.statusText:"OK",this.headers=new O(A.headers),this.url=A.url||"",this._initBody(w)}R.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},se.error=function(){var w=new se(null,{status:0,statusText:""});return w.type="error",w};var ce=[301,302,303,307,308];se.redirect=function(w,A){if(ce.indexOf(A)===-1)throw new RangeError("Invalid status code");return new se(null,{status:A,headers:{location:w}})},h.DOMException=c.DOMException;try{new h.DOMException}catch{h.DOMException=function(A,ee){this.message=A,this.name=ee;var Q=Error(A);this.stack=Q.stack},h.DOMException.prototype=Object.create(Error.prototype),h.DOMException.prototype.constructor=h.DOMException}function de(w,A){return new Promise(function(ee,Q){var V=new b(w,A);if(V.signal&&V.signal.aborted)return Q(new h.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function J(){k.abort()}k.onload=function(){var re={status:k.status,statusText:k.statusText,headers:W(k.getAllResponseHeaders()||"")};re.url="responseURL"in k?k.responseURL:re.headers.get("X-Request-URL");var be="response"in k?k.response:k.responseText;ee(new se(be,re))},k.onerror=function(){Q(new TypeError("Network request failed"))},k.ontimeout=function(){Q(new TypeError("Network request failed"))},k.onabort=function(){Q(new h.DOMException("Aborted","AbortError"))},k.open(V.method,V.url,!0),V.credentials==="include"?k.withCredentials=!0:V.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&f.blob&&(k.responseType="blob"),V.headers.forEach(function(re,be){k.setRequestHeader(be,re)}),V.signal&&(V.signal.addEventListener("abort",J),k.onreadystatechange=function(){k.readyState===4&&V.signal.removeEventListener("abort",J)}),k.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return de.polyfill=!0,c.fetch||(c.fetch=de,c.Headers=O,c.Request=b,c.Response=se),h.Headers=O,h.Request=b,h.Response=se,h.fetch=de,Object.defineProperty(h,"__esModule",{value:!0}),h})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var o=i;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,n.exports=e})(zu,zu.exports);var Zx=zu.exports;const Fd=aa(Zx),e5={Accept:"application/json","Content-Type":"application/json"},t5="POST",zd={headers:e5,method:t5},Hd=10;class zn{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Cr.EventEmitter,this.isAvailable=!1,this.registering=!1,!pd(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const i=ai(e),c=await(await Fd(this.url,Object.assign(Object.assign({},zd),{body:i}))).json();this.onPayload({data:c})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!pd(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=ai({id:1,jsonrpc:"2.0",method:"test",params:[]});await Fd(e,Object.assign(Object.assign({},zd),{body:t}))}this.onOpen()}catch(t){const i=this.parseError(t);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Us(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),o=i.message||i.toString(),c=_a(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Qp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Hd&&this.events.setMaxListeners(Hd)}}const Bd="error",r5="wss://relay.walletconnect.com",n5="wc",i5="universal_provider",Kd=`${n5}@2:${i5}:`,s5="https://rpc.walletconnect.com/v1/",In={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var bs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Hu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,e){(function(){var t,i="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",p=500,v="__lodash_placeholder__",S=1,D=2,x=4,O=1,z=2,B=1,ie=2,$=4,U=8,P=16,R=32,E=64,u=128,b=256,G=512,W=30,se="...",ce=800,de=16,w=1,A=2,ee=3,Q=1/0,V=9007199254740991,k=17976931348623157e292,J=NaN,re=4294967295,be=re-1,oe=re>>>1,we=[["ary",u],["bind",B],["bindKey",ie],["curry",U],["curryRight",P],["flip",G],["partial",R],["partialRight",E],["rearg",b]],le="[object Arguments]",_e="[object Array]",H="[object AsyncFunction]",F="[object Boolean]",L="[object Date]",d="[object DOMException]",T="[object Error]",ae="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",He="[object Number]",Ve="[object Null]",je="[object Object]",gt="[object Promise]",yt="[object Proxy]",qe="[object RegExp]",xe="[object Set]",Ne="[object String]",$e="[object Symbol]",Fe="[object Undefined]",Pe="[object WeakMap]",Le="[object WeakSet]",Se="[object ArrayBuffer]",Ce="[object DataView]",Be="[object Float32Array]",Oe="[object Float64Array]",ke="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Qe="[object Uint8ClampedArray]",rr="[object Uint16Array]",fr="[object Uint32Array]",Qr=/\b__p \+= '';/g,nr=/\b(__p \+=) '' \+/g,an=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xn=/&(?:amp|lt|gt|quot|#39);/g,Hn=/[&<>"']/g,Dt=RegExp(xn.source),vt=RegExp(Hn.source),St=/<%-([\s\S]+?)%>/g,It=/<%([\s\S]+?)%>/g,wt=/<%=([\s\S]+?)%>/g,_t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Lt=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xt=/[\\^$.*+?()[\]{}|]/g,jt=RegExp(xt.source),Ot=/^\s+/,Tt=/\s/,Pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,qt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ea=/[()=,{}\[\]\/\s]/,Da=/\\(\\)?/g,Sa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tr=/\w*$/,Ia=/^[-+]0x[0-9a-f]+$/i,xa=/^0b[01]+$/i,Oa=/^\[object .+?Constructor\]$/,Pa=/^0o[0-7]+$/i,Ca=/^(?:0|[1-9]\d*)$/,cn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,di=/($^)/,Aa=/['\n\r\u2028\u2029\\]/g,pi="\\ud800-\\udfff",Ta="\\u0300-\\u036f",Ra="\\ufe20-\\ufe2f",gi="\\u20d0-\\u20ff",Ms=Ta+Ra+gi,qs="\\u2700-\\u27bf",zr="a-z\\xdf-\\xf6\\xf8-\\xff",Na="\\xac\\xb1\\xd7\\xf7",$a="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",La="\\u2000-\\u206f",Ua=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fs="A-Z\\xc0-\\xd6\\xd8-\\xde",zs="\\ufe0e\\ufe0f",Bn=Na+$a+La+Ua,Gi="['’]",Kn="["+pi+"]",Wi="["+Bn+"]",Vn="["+Ms+"]",Hs="\\d+",ja="["+qs+"]",Bs="["+zr+"]",Ks="[^"+pi+Bn+Hs+qs+zr+Fs+"]",yi="\\ud83c[\\udffb-\\udfff]",Ma="(?:"+Vn+"|"+yi+")",Vs="[^"+pi+"]",vi="(?:\\ud83c[\\udde6-\\uddff]){2}",On="[\\ud800-\\udbff][\\udc00-\\udfff]",Er="["+Fs+"]",ks="\\u200d",Gs="(?:"+Bs+"|"+Ks+")",Xr="(?:"+Er+"|"+Ks+")",Ws="(?:"+Gi+"(?:d|ll|m|re|s|t|ve))?",Ys="(?:"+Gi+"(?:D|LL|M|RE|S|T|VE))?",Js=Ma+"?",Qs="["+zs+"]?",qa="(?:"+ks+"(?:"+[Vs,vi,On].join("|")+")"+Qs+Js+")*",un="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Xs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zs=Qs+Js+qa,_i="(?:"+[ja,vi,On].join("|")+")"+Zs,Fa="(?:"+[Vs+Vn+"?",Vn,vi,On,Kn].join("|")+")",Yi=RegExp(Gi,"g"),za=RegExp(Vn,"g"),mi=RegExp(yi+"(?="+yi+")|"+Fa+Zs,"g"),eo=RegExp([Er+"?"+Bs+"+"+Ws+"(?="+[Wi,Er,"$"].join("|")+")",Xr+"+"+Ys+"(?="+[Wi,Er+Gs,"$"].join("|")+")",Er+"?"+Gs+"+"+Ws,Er+"+"+Ys,Xs,un,Hs,_i].join("|"),"g"),to=RegExp("["+ks+pi+Ms+zs+"]"),kn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ro=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ha=-1,at={};at[Be]=at[Oe]=at[ke]=at[We]=at[et]=at[tt]=at[Qe]=at[rr]=at[fr]=!0,at[le]=at[_e]=at[Se]=at[F]=at[Ce]=at[L]=at[T]=at[ae]=at[Ie]=at[He]=at[je]=at[qe]=at[xe]=at[Ne]=at[Pe]=!1;var st={};st[le]=st[_e]=st[Se]=st[Ce]=st[F]=st[L]=st[Be]=st[Oe]=st[ke]=st[We]=st[et]=st[Ie]=st[He]=st[je]=st[qe]=st[xe]=st[Ne]=st[$e]=st[tt]=st[Qe]=st[rr]=st[fr]=!0,st[T]=st[ae]=st[Pe]=!1;var I={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,Te=parseInt,dt=typeof bs=="object"&&bs&&bs.Object===Object&&bs,Ft=typeof self=="object"&&self&&self.Object===Object&&self,Xe=dt||Ft||Function("return this")(),ut=e&&!e.nodeType&&e,Rt=ut&&!0&&n&&!n.nodeType&&n,dr=Rt&&Rt.exports===ut,zt=dr&&dt.process,pt=function(){try{var M=Rt&&Rt.require&&Rt.require("util").types;return M||zt&&zt.binding&&zt.binding("util")}catch{}}(),ir=pt&&pt.isArrayBuffer,Hr=pt&&pt.isDate,Rr=pt&&pt.isMap,Zr=pt&&pt.isRegExp,Ji=pt&&pt.isSet,Gn=pt&&pt.isTypedArray;function Vt(M,Y,K){switch(K.length){case 0:return M.call(Y);case 1:return M.call(Y,K[0]);case 2:return M.call(Y,K[0],K[1]);case 3:return M.call(Y,K[0],K[1],K[2])}return M.apply(Y,K)}function Sg(M,Y,K,ge){for(var Ae=-1,rt=M==null?0:M.length;++Ae<rt;){var Bt=M[Ae];Y(ge,Bt,K(Bt),M)}return ge}function Nr(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge&&Y(M[K],K,M)!==!1;);return M}function Ig(M,Y){for(var K=M==null?0:M.length;K--&&Y(M[K],K,M)!==!1;);return M}function ph(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge;)if(!Y(M[K],K,M))return!1;return!0}function Pn(M,Y){for(var K=-1,ge=M==null?0:M.length,Ae=0,rt=[];++K<ge;){var Bt=M[K];Y(Bt,K,M)&&(rt[Ae++]=Bt)}return rt}function no(M,Y){var K=M==null?0:M.length;return!!K&&bi(M,Y,0)>-1}function Ba(M,Y,K){for(var ge=-1,Ae=M==null?0:M.length;++ge<Ae;)if(K(Y,M[ge]))return!0;return!1}function mt(M,Y){for(var K=-1,ge=M==null?0:M.length,Ae=Array(ge);++K<ge;)Ae[K]=Y(M[K],K,M);return Ae}function Cn(M,Y){for(var K=-1,ge=Y.length,Ae=M.length;++K<ge;)M[Ae+K]=Y[K];return M}function Ka(M,Y,K,ge){var Ae=-1,rt=M==null?0:M.length;for(ge&&rt&&(K=M[++Ae]);++Ae<rt;)K=Y(K,M[Ae],Ae,M);return K}function xg(M,Y,K,ge){var Ae=M==null?0:M.length;for(ge&&Ae&&(K=M[--Ae]);Ae--;)K=Y(K,M[Ae],Ae,M);return K}function Va(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge;)if(Y(M[K],K,M))return!0;return!1}var Og=ka("length");function Pg(M){return M.split("")}function Cg(M){return M.match(qt)||[]}function gh(M,Y,K){var ge;return K(M,function(Ae,rt,Bt){if(Y(Ae,rt,Bt))return ge=rt,!1}),ge}function io(M,Y,K,ge){for(var Ae=M.length,rt=K+(ge?1:-1);ge?rt--:++rt<Ae;)if(Y(M[rt],rt,M))return rt;return-1}function bi(M,Y,K){return Y===Y?zg(M,Y,K):io(M,yh,K)}function Ag(M,Y,K,ge){for(var Ae=K-1,rt=M.length;++Ae<rt;)if(ge(M[Ae],Y))return Ae;return-1}function yh(M){return M!==M}function vh(M,Y){var K=M==null?0:M.length;return K?Wa(M,Y)/K:J}function ka(M){return function(Y){return Y==null?t:Y[M]}}function Ga(M){return function(Y){return M==null?t:M[Y]}}function _h(M,Y,K,ge,Ae){return Ae(M,function(rt,Bt,ht){K=ge?(ge=!1,rt):Y(K,rt,Bt,ht)}),K}function Tg(M,Y){var K=M.length;for(M.sort(Y);K--;)M[K]=M[K].value;return M}function Wa(M,Y){for(var K,ge=-1,Ae=M.length;++ge<Ae;){var rt=Y(M[ge]);rt!==t&&(K=K===t?rt:K+rt)}return K}function Ya(M,Y){for(var K=-1,ge=Array(M);++K<M;)ge[K]=Y(K);return ge}function Rg(M,Y){return mt(Y,function(K){return[K,M[K]]})}function mh(M){return M&&M.slice(0,Dh(M)+1).replace(Ot,"")}function Dr(M){return function(Y){return M(Y)}}function Ja(M,Y){return mt(Y,function(K){return M[K]})}function Qi(M,Y){return M.has(Y)}function bh(M,Y){for(var K=-1,ge=M.length;++K<ge&&bi(Y,M[K],0)>-1;);return K}function wh(M,Y){for(var K=M.length;K--&&bi(Y,M[K],0)>-1;);return K}function Ng(M,Y){for(var K=M.length,ge=0;K--;)M[K]===Y&&++ge;return ge}var $g=Ga(I),Lg=Ga(j);function Ug(M){return"\\"+pe[M]}function jg(M,Y){return M==null?t:M[Y]}function wi(M){return to.test(M)}function Mg(M){return kn.test(M)}function qg(M){for(var Y,K=[];!(Y=M.next()).done;)K.push(Y.value);return K}function Qa(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge,Ae){K[++Y]=[Ae,ge]}),K}function Eh(M,Y){return function(K){return M(Y(K))}}function An(M,Y){for(var K=-1,ge=M.length,Ae=0,rt=[];++K<ge;){var Bt=M[K];(Bt===Y||Bt===v)&&(M[K]=v,rt[Ae++]=K)}return rt}function so(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge){K[++Y]=ge}),K}function Fg(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge){K[++Y]=[ge,ge]}),K}function zg(M,Y,K){for(var ge=K-1,Ae=M.length;++ge<Ae;)if(M[ge]===Y)return ge;return-1}function Hg(M,Y,K){for(var ge=K+1;ge--;)if(M[ge]===Y)return ge;return ge}function Ei(M){return wi(M)?Kg(M):Og(M)}function Br(M){return wi(M)?Vg(M):Pg(M)}function Dh(M){for(var Y=M.length;Y--&&Tt.test(M.charAt(Y)););return Y}var Bg=Ga(te);function Kg(M){for(var Y=mi.lastIndex=0;mi.test(M);)++Y;return Y}function Vg(M){return M.match(mi)||[]}function kg(M){return M.match(eo)||[]}var Gg=function M(Y){Y=Y==null?Xe:Di.defaults(Xe.Object(),Y,Di.pick(Xe,ro));var K=Y.Array,ge=Y.Date,Ae=Y.Error,rt=Y.Function,Bt=Y.Math,ht=Y.Object,Xa=Y.RegExp,Wg=Y.String,$r=Y.TypeError,oo=K.prototype,Yg=rt.prototype,Si=ht.prototype,ao=Y["__core-js_shared__"],co=Yg.toString,it=Si.hasOwnProperty,Jg=0,Sh=function(){var r=/[^.]+$/.exec(ao&&ao.keys&&ao.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),uo=Si.toString,Qg=co.call(ht),Xg=Xe._,Zg=Xa("^"+co.call(it).replace(xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ho=dr?Y.Buffer:t,Tn=Y.Symbol,lo=Y.Uint8Array,Ih=ho?ho.allocUnsafe:t,fo=Eh(ht.getPrototypeOf,ht),xh=ht.create,Oh=Si.propertyIsEnumerable,po=oo.splice,Ph=Tn?Tn.isConcatSpreadable:t,Xi=Tn?Tn.iterator:t,Wn=Tn?Tn.toStringTag:t,go=function(){try{var r=Zn(ht,"defineProperty");return r({},"",{}),r}catch{}}(),e0=Y.clearTimeout!==Xe.clearTimeout&&Y.clearTimeout,t0=ge&&ge.now!==Xe.Date.now&&ge.now,r0=Y.setTimeout!==Xe.setTimeout&&Y.setTimeout,yo=Bt.ceil,vo=Bt.floor,Za=ht.getOwnPropertySymbols,n0=ho?ho.isBuffer:t,Ch=Y.isFinite,i0=oo.join,s0=Eh(ht.keys,ht),Kt=Bt.max,Xt=Bt.min,o0=ge.now,a0=Y.parseInt,Ah=Bt.random,c0=oo.reverse,ec=Zn(Y,"DataView"),Zi=Zn(Y,"Map"),tc=Zn(Y,"Promise"),Ii=Zn(Y,"Set"),es=Zn(Y,"WeakMap"),ts=Zn(ht,"create"),_o=es&&new es,xi={},u0=ei(ec),h0=ei(Zi),l0=ei(tc),f0=ei(Ii),d0=ei(es),mo=Tn?Tn.prototype:t,rs=mo?mo.valueOf:t,Th=mo?mo.toString:t;function _(r){if(Ct(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof Lr)return r;if(it.call(r,"__wrapped__"))return Rl(r)}return new Lr(r)}var Oi=function(){function r(){}return function(s){if(!Et(s))return{};if(xh)return xh(s);r.prototype=s;var a=new r;return r.prototype=t,a}}();function bo(){}function Lr(r,s){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=t}_.templateSettings={escape:St,evaluate:It,interpolate:wt,variable:"",imports:{_}},_.prototype=bo.prototype,_.prototype.constructor=_,Lr.prototype=Oi(bo.prototype),Lr.prototype.constructor=Lr;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function p0(){var r=new Ye(this.__wrapped__);return r.__actions__=pr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=pr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=pr(this.__views__),r}function g0(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function y0(){var r=this.__wrapped__.value(),s=this.__dir__,a=Re(r),l=s<0,y=a?r.length:0,m=Py(0,y,this.__views__),C=m.start,N=m.end,q=N-C,X=l?N:C-1,Z=this.__iteratees__,ne=Z.length,he=0,ye=Xt(q,this.__takeCount__);if(!a||!l&&y==q&&ye==q)return tl(r,this.__actions__);var Ee=[];e:for(;q--&&he<ye;){X+=s;for(var ze=-1,De=r[X];++ze<ne;){var Ge=Z[ze],Ze=Ge.iteratee,xr=Ge.type,ar=Ze(De);if(xr==A)De=ar;else if(!ar){if(xr==w)continue e;break e}}Ee[he++]=De}return Ee}Ye.prototype=Oi(bo.prototype),Ye.prototype.constructor=Ye;function Yn(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var l=r[s];this.set(l[0],l[1])}}function v0(){this.__data__=ts?ts(null):{},this.size=0}function _0(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}function m0(r){var s=this.__data__;if(ts){var a=s[r];return a===g?t:a}return it.call(s,r)?s[r]:t}function b0(r){var s=this.__data__;return ts?s[r]!==t:it.call(s,r)}function w0(r,s){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=ts&&s===t?g:s,this}Yn.prototype.clear=v0,Yn.prototype.delete=_0,Yn.prototype.get=m0,Yn.prototype.has=b0,Yn.prototype.set=w0;function hn(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var l=r[s];this.set(l[0],l[1])}}function E0(){this.__data__=[],this.size=0}function D0(r){var s=this.__data__,a=wo(s,r);if(a<0)return!1;var l=s.length-1;return a==l?s.pop():po.call(s,a,1),--this.size,!0}function S0(r){var s=this.__data__,a=wo(s,r);return a<0?t:s[a][1]}function I0(r){return wo(this.__data__,r)>-1}function x0(r,s){var a=this.__data__,l=wo(a,r);return l<0?(++this.size,a.push([r,s])):a[l][1]=s,this}hn.prototype.clear=E0,hn.prototype.delete=D0,hn.prototype.get=S0,hn.prototype.has=I0,hn.prototype.set=x0;function ln(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var l=r[s];this.set(l[0],l[1])}}function O0(){this.size=0,this.__data__={hash:new Yn,map:new(Zi||hn),string:new Yn}}function P0(r){var s=No(this,r).delete(r);return this.size-=s?1:0,s}function C0(r){return No(this,r).get(r)}function A0(r){return No(this,r).has(r)}function T0(r,s){var a=No(this,r),l=a.size;return a.set(r,s),this.size+=a.size==l?0:1,this}ln.prototype.clear=O0,ln.prototype.delete=P0,ln.prototype.get=C0,ln.prototype.has=A0,ln.prototype.set=T0;function Jn(r){var s=-1,a=r==null?0:r.length;for(this.__data__=new ln;++s<a;)this.add(r[s])}function R0(r){return this.__data__.set(r,g),this}function N0(r){return this.__data__.has(r)}Jn.prototype.add=Jn.prototype.push=R0,Jn.prototype.has=N0;function Kr(r){var s=this.__data__=new hn(r);this.size=s.size}function $0(){this.__data__=new hn,this.size=0}function L0(r){var s=this.__data__,a=s.delete(r);return this.size=s.size,a}function U0(r){return this.__data__.get(r)}function j0(r){return this.__data__.has(r)}function M0(r,s){var a=this.__data__;if(a instanceof hn){var l=a.__data__;if(!Zi||l.length<o-1)return l.push([r,s]),this.size=++a.size,this;a=this.__data__=new ln(l)}return a.set(r,s),this.size=a.size,this}Kr.prototype.clear=$0,Kr.prototype.delete=L0,Kr.prototype.get=U0,Kr.prototype.has=j0,Kr.prototype.set=M0;function Rh(r,s){var a=Re(r),l=!a&&ti(r),y=!a&&!l&&Un(r),m=!a&&!l&&!y&&Ti(r),C=a||l||y||m,N=C?Ya(r.length,Wg):[],q=N.length;for(var X in r)(s||it.call(r,X))&&!(C&&(X=="length"||y&&(X=="offset"||X=="parent")||m&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||gn(X,q)))&&N.push(X);return N}function Nh(r){var s=r.length;return s?r[fc(0,s-1)]:t}function q0(r,s){return $o(pr(r),Qn(s,0,r.length))}function F0(r){return $o(pr(r))}function rc(r,s,a){(a!==t&&!Vr(r[s],a)||a===t&&!(s in r))&&fn(r,s,a)}function ns(r,s,a){var l=r[s];(!(it.call(r,s)&&Vr(l,a))||a===t&&!(s in r))&&fn(r,s,a)}function wo(r,s){for(var a=r.length;a--;)if(Vr(r[a][0],s))return a;return-1}function z0(r,s,a,l){return Rn(r,function(y,m,C){s(l,y,a(y),C)}),l}function $h(r,s){return r&&tn(s,kt(s),r)}function H0(r,s){return r&&tn(s,yr(s),r)}function fn(r,s,a){s=="__proto__"&&go?go(r,s,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[s]=a}function nc(r,s){for(var a=-1,l=s.length,y=K(l),m=r==null;++a<l;)y[a]=m?t:jc(r,s[a]);return y}function Qn(r,s,a){return r===r&&(a!==t&&(r=r<=a?r:a),s!==t&&(r=r>=s?r:s)),r}function Ur(r,s,a,l,y,m){var C,N=s&S,q=s&D,X=s&x;if(a&&(C=y?a(r,l,y,m):a(r)),C!==t)return C;if(!Et(r))return r;var Z=Re(r);if(Z){if(C=Ay(r),!N)return pr(r,C)}else{var ne=Zt(r),he=ne==ae||ne==fe;if(Un(r))return il(r,N);if(ne==je||ne==le||he&&!y){if(C=q||he?{}:Dl(r),!N)return q?my(r,H0(C,r)):_y(r,$h(C,r))}else{if(!st[ne])return y?r:{};C=Ty(r,ne,N)}}m||(m=new Kr);var ye=m.get(r);if(ye)return ye;m.set(r,C),Xl(r)?r.forEach(function(De){C.add(Ur(De,s,a,De,r,m))}):Jl(r)&&r.forEach(function(De,Ge){C.set(Ge,Ur(De,s,a,Ge,r,m))});var Ee=X?q?Dc:Ec:q?yr:kt,ze=Z?t:Ee(r);return Nr(ze||r,function(De,Ge){ze&&(Ge=De,De=r[Ge]),ns(C,Ge,Ur(De,s,a,Ge,r,m))}),C}function B0(r){var s=kt(r);return function(a){return Lh(a,r,s)}}function Lh(r,s,a){var l=a.length;if(r==null)return!l;for(r=ht(r);l--;){var y=a[l],m=s[y],C=r[y];if(C===t&&!(y in r)||!m(C))return!1}return!0}function Uh(r,s,a){if(typeof r!="function")throw new $r(h);return hs(function(){r.apply(t,a)},s)}function is(r,s,a,l){var y=-1,m=no,C=!0,N=r.length,q=[],X=s.length;if(!N)return q;a&&(s=mt(s,Dr(a))),l?(m=Ba,C=!1):s.length>=o&&(m=Qi,C=!1,s=new Jn(s));e:for(;++y<N;){var Z=r[y],ne=a==null?Z:a(Z);if(Z=l||Z!==0?Z:0,C&&ne===ne){for(var he=X;he--;)if(s[he]===ne)continue e;q.push(Z)}else m(s,ne,l)||q.push(Z)}return q}var Rn=ul(en),jh=ul(sc,!0);function K0(r,s){var a=!0;return Rn(r,function(l,y,m){return a=!!s(l,y,m),a}),a}function Eo(r,s,a){for(var l=-1,y=r.length;++l<y;){var m=r[l],C=s(m);if(C!=null&&(N===t?C===C&&!Ir(C):a(C,N)))var N=C,q=m}return q}function V0(r,s,a,l){var y=r.length;for(a=Me(a),a<0&&(a=-a>y?0:y+a),l=l===t||l>y?y:Me(l),l<0&&(l+=y),l=a>l?0:ef(l);a<l;)r[a++]=s;return r}function Mh(r,s){var a=[];return Rn(r,function(l,y,m){s(l,y,m)&&a.push(l)}),a}function Yt(r,s,a,l,y){var m=-1,C=r.length;for(a||(a=Ny),y||(y=[]);++m<C;){var N=r[m];s>0&&a(N)?s>1?Yt(N,s-1,a,l,y):Cn(y,N):l||(y[y.length]=N)}return y}var ic=hl(),qh=hl(!0);function en(r,s){return r&&ic(r,s,kt)}function sc(r,s){return r&&qh(r,s,kt)}function Do(r,s){return Pn(s,function(a){return yn(r[a])})}function Xn(r,s){s=$n(s,r);for(var a=0,l=s.length;r!=null&&a<l;)r=r[rn(s[a++])];return a&&a==l?r:t}function Fh(r,s,a){var l=s(r);return Re(r)?l:Cn(l,a(r))}function sr(r){return r==null?r===t?Fe:Ve:Wn&&Wn in ht(r)?Oy(r):Fy(r)}function oc(r,s){return r>s}function k0(r,s){return r!=null&&it.call(r,s)}function G0(r,s){return r!=null&&s in ht(r)}function W0(r,s,a){return r>=Xt(s,a)&&r<Kt(s,a)}function ac(r,s,a){for(var l=a?Ba:no,y=r[0].length,m=r.length,C=m,N=K(m),q=1/0,X=[];C--;){var Z=r[C];C&&s&&(Z=mt(Z,Dr(s))),q=Xt(Z.length,q),N[C]=!a&&(s||y>=120&&Z.length>=120)?new Jn(C&&Z):t}Z=r[0];var ne=-1,he=N[0];e:for(;++ne<y&&X.length<q;){var ye=Z[ne],Ee=s?s(ye):ye;if(ye=a||ye!==0?ye:0,!(he?Qi(he,Ee):l(X,Ee,a))){for(C=m;--C;){var ze=N[C];if(!(ze?Qi(ze,Ee):l(r[C],Ee,a)))continue e}he&&he.push(Ee),X.push(ye)}}return X}function Y0(r,s,a,l){return en(r,function(y,m,C){s(l,a(y),m,C)}),l}function ss(r,s,a){s=$n(s,r),r=Ol(r,s);var l=r==null?r:r[rn(Mr(s))];return l==null?t:Vt(l,r,a)}function zh(r){return Ct(r)&&sr(r)==le}function J0(r){return Ct(r)&&sr(r)==Se}function Q0(r){return Ct(r)&&sr(r)==L}function os(r,s,a,l,y){return r===s?!0:r==null||s==null||!Ct(r)&&!Ct(s)?r!==r&&s!==s:X0(r,s,a,l,os,y)}function X0(r,s,a,l,y,m){var C=Re(r),N=Re(s),q=C?_e:Zt(r),X=N?_e:Zt(s);q=q==le?je:q,X=X==le?je:X;var Z=q==je,ne=X==je,he=q==X;if(he&&Un(r)){if(!Un(s))return!1;C=!0,Z=!1}if(he&&!Z)return m||(m=new Kr),C||Ti(r)?bl(r,s,a,l,y,m):Iy(r,s,q,a,l,y,m);if(!(a&O)){var ye=Z&&it.call(r,"__wrapped__"),Ee=ne&&it.call(s,"__wrapped__");if(ye||Ee){var ze=ye?r.value():r,De=Ee?s.value():s;return m||(m=new Kr),y(ze,De,a,l,m)}}return he?(m||(m=new Kr),xy(r,s,a,l,y,m)):!1}function Z0(r){return Ct(r)&&Zt(r)==Ie}function cc(r,s,a,l){var y=a.length,m=y,C=!l;if(r==null)return!m;for(r=ht(r);y--;){var N=a[y];if(C&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++y<m;){N=a[y];var q=N[0],X=r[q],Z=N[1];if(C&&N[2]){if(X===t&&!(q in r))return!1}else{var ne=new Kr;if(l)var he=l(X,Z,q,r,s,ne);if(!(he===t?os(Z,X,O|z,l,ne):he))return!1}}return!0}function Hh(r){if(!Et(r)||Ly(r))return!1;var s=yn(r)?Zg:Oa;return s.test(ei(r))}function ey(r){return Ct(r)&&sr(r)==qe}function ty(r){return Ct(r)&&Zt(r)==xe}function ry(r){return Ct(r)&&Fo(r.length)&&!!at[sr(r)]}function Bh(r){return typeof r=="function"?r:r==null?vr:typeof r=="object"?Re(r)?kh(r[0],r[1]):Vh(r):ff(r)}function uc(r){if(!us(r))return s0(r);var s=[];for(var a in ht(r))it.call(r,a)&&a!="constructor"&&s.push(a);return s}function ny(r){if(!Et(r))return qy(r);var s=us(r),a=[];for(var l in r)l=="constructor"&&(s||!it.call(r,l))||a.push(l);return a}function hc(r,s){return r<s}function Kh(r,s){var a=-1,l=gr(r)?K(r.length):[];return Rn(r,function(y,m,C){l[++a]=s(y,m,C)}),l}function Vh(r){var s=Ic(r);return s.length==1&&s[0][2]?Il(s[0][0],s[0][1]):function(a){return a===r||cc(a,r,s)}}function kh(r,s){return Oc(r)&&Sl(s)?Il(rn(r),s):function(a){var l=jc(a,r);return l===t&&l===s?Mc(a,r):os(s,l,O|z)}}function So(r,s,a,l,y){r!==s&&ic(s,function(m,C){if(y||(y=new Kr),Et(m))iy(r,s,C,a,So,l,y);else{var N=l?l(Cc(r,C),m,C+"",r,s,y):t;N===t&&(N=m),rc(r,C,N)}},yr)}function iy(r,s,a,l,y,m,C){var N=Cc(r,a),q=Cc(s,a),X=C.get(q);if(X){rc(r,a,X);return}var Z=m?m(N,q,a+"",r,s,C):t,ne=Z===t;if(ne){var he=Re(q),ye=!he&&Un(q),Ee=!he&&!ye&&Ti(q);Z=q,he||ye||Ee?Re(N)?Z=N:Nt(N)?Z=pr(N):ye?(ne=!1,Z=il(q,!0)):Ee?(ne=!1,Z=sl(q,!0)):Z=[]:ls(q)||ti(q)?(Z=N,ti(N)?Z=tf(N):(!Et(N)||yn(N))&&(Z=Dl(q))):ne=!1}ne&&(C.set(q,Z),y(Z,q,l,m,C),C.delete(q)),rc(r,a,Z)}function Gh(r,s){var a=r.length;if(a)return s+=s<0?a:0,gn(s,a)?r[s]:t}function Wh(r,s,a){s.length?s=mt(s,function(m){return Re(m)?function(C){return Xn(C,m.length===1?m[0]:m)}:m}):s=[vr];var l=-1;s=mt(s,Dr(me()));var y=Kh(r,function(m,C,N){var q=mt(s,function(X){return X(m)});return{criteria:q,index:++l,value:m}});return Tg(y,function(m,C){return vy(m,C,a)})}function sy(r,s){return Yh(r,s,function(a,l){return Mc(r,l)})}function Yh(r,s,a){for(var l=-1,y=s.length,m={};++l<y;){var C=s[l],N=Xn(r,C);a(N,C)&&as(m,$n(C,r),N)}return m}function oy(r){return function(s){return Xn(s,r)}}function lc(r,s,a,l){var y=l?Ag:bi,m=-1,C=s.length,N=r;for(r===s&&(s=pr(s)),a&&(N=mt(r,Dr(a)));++m<C;)for(var q=0,X=s[m],Z=a?a(X):X;(q=y(N,Z,q,l))>-1;)N!==r&&po.call(N,q,1),po.call(r,q,1);return r}function Jh(r,s){for(var a=r?s.length:0,l=a-1;a--;){var y=s[a];if(a==l||y!==m){var m=y;gn(y)?po.call(r,y,1):gc(r,y)}}return r}function fc(r,s){return r+vo(Ah()*(s-r+1))}function ay(r,s,a,l){for(var y=-1,m=Kt(yo((s-r)/(a||1)),0),C=K(m);m--;)C[l?m:++y]=r,r+=a;return C}function dc(r,s){var a="";if(!r||s<1||s>V)return a;do s%2&&(a+=r),s=vo(s/2),s&&(r+=r);while(s);return a}function Ke(r,s){return Ac(xl(r,s,vr),r+"")}function cy(r){return Nh(Ri(r))}function uy(r,s){var a=Ri(r);return $o(a,Qn(s,0,a.length))}function as(r,s,a,l){if(!Et(r))return r;s=$n(s,r);for(var y=-1,m=s.length,C=m-1,N=r;N!=null&&++y<m;){var q=rn(s[y]),X=a;if(q==="__proto__"||q==="constructor"||q==="prototype")return r;if(y!=C){var Z=N[q];X=l?l(Z,q,N):t,X===t&&(X=Et(Z)?Z:gn(s[y+1])?[]:{})}ns(N,q,X),N=N[q]}return r}var Qh=_o?function(r,s){return _o.set(r,s),r}:vr,hy=go?function(r,s){return go(r,"toString",{configurable:!0,enumerable:!1,value:Fc(s),writable:!0})}:vr;function ly(r){return $o(Ri(r))}function jr(r,s,a){var l=-1,y=r.length;s<0&&(s=-s>y?0:y+s),a=a>y?y:a,a<0&&(a+=y),y=s>a?0:a-s>>>0,s>>>=0;for(var m=K(y);++l<y;)m[l]=r[l+s];return m}function fy(r,s){var a;return Rn(r,function(l,y,m){return a=s(l,y,m),!a}),!!a}function Io(r,s,a){var l=0,y=r==null?l:r.length;if(typeof s=="number"&&s===s&&y<=oe){for(;l<y;){var m=l+y>>>1,C=r[m];C!==null&&!Ir(C)&&(a?C<=s:C<s)?l=m+1:y=m}return y}return pc(r,s,vr,a)}function pc(r,s,a,l){var y=0,m=r==null?0:r.length;if(m===0)return 0;s=a(s);for(var C=s!==s,N=s===null,q=Ir(s),X=s===t;y<m;){var Z=vo((y+m)/2),ne=a(r[Z]),he=ne!==t,ye=ne===null,Ee=ne===ne,ze=Ir(ne);if(C)var De=l||Ee;else X?De=Ee&&(l||he):N?De=Ee&&he&&(l||!ye):q?De=Ee&&he&&!ye&&(l||!ze):ye||ze?De=!1:De=l?ne<=s:ne<s;De?y=Z+1:m=Z}return Xt(m,be)}function Xh(r,s){for(var a=-1,l=r.length,y=0,m=[];++a<l;){var C=r[a],N=s?s(C):C;if(!a||!Vr(N,q)){var q=N;m[y++]=C===0?0:C}}return m}function Zh(r){return typeof r=="number"?r:Ir(r)?J:+r}function Sr(r){if(typeof r=="string")return r;if(Re(r))return mt(r,Sr)+"";if(Ir(r))return Th?Th.call(r):"";var s=r+"";return s=="0"&&1/r==-Q?"-0":s}function Nn(r,s,a){var l=-1,y=no,m=r.length,C=!0,N=[],q=N;if(a)C=!1,y=Ba;else if(m>=o){var X=s?null:Dy(r);if(X)return so(X);C=!1,y=Qi,q=new Jn}else q=s?[]:N;e:for(;++l<m;){var Z=r[l],ne=s?s(Z):Z;if(Z=a||Z!==0?Z:0,C&&ne===ne){for(var he=q.length;he--;)if(q[he]===ne)continue e;s&&q.push(ne),N.push(Z)}else y(q,ne,a)||(q!==N&&q.push(ne),N.push(Z))}return N}function gc(r,s){return s=$n(s,r),r=Ol(r,s),r==null||delete r[rn(Mr(s))]}function el(r,s,a,l){return as(r,s,a(Xn(r,s)),l)}function xo(r,s,a,l){for(var y=r.length,m=l?y:-1;(l?m--:++m<y)&&s(r[m],m,r););return a?jr(r,l?0:m,l?m+1:y):jr(r,l?m+1:0,l?y:m)}function tl(r,s){var a=r;return a instanceof Ye&&(a=a.value()),Ka(s,function(l,y){return y.func.apply(y.thisArg,Cn([l],y.args))},a)}function yc(r,s,a){var l=r.length;if(l<2)return l?Nn(r[0]):[];for(var y=-1,m=K(l);++y<l;)for(var C=r[y],N=-1;++N<l;)N!=y&&(m[y]=is(m[y]||C,r[N],s,a));return Nn(Yt(m,1),s,a)}function rl(r,s,a){for(var l=-1,y=r.length,m=s.length,C={};++l<y;){var N=l<m?s[l]:t;a(C,r[l],N)}return C}function vc(r){return Nt(r)?r:[]}function _c(r){return typeof r=="function"?r:vr}function $n(r,s){return Re(r)?r:Oc(r,s)?[r]:Tl(nt(r))}var dy=Ke;function Ln(r,s,a){var l=r.length;return a=a===t?l:a,!s&&a>=l?r:jr(r,s,a)}var nl=e0||function(r){return Xe.clearTimeout(r)};function il(r,s){if(s)return r.slice();var a=r.length,l=Ih?Ih(a):new r.constructor(a);return r.copy(l),l}function mc(r){var s=new r.constructor(r.byteLength);return new lo(s).set(new lo(r)),s}function py(r,s){var a=s?mc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function gy(r){var s=new r.constructor(r.source,Tr.exec(r));return s.lastIndex=r.lastIndex,s}function yy(r){return rs?ht(rs.call(r)):{}}function sl(r,s){var a=s?mc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function ol(r,s){if(r!==s){var a=r!==t,l=r===null,y=r===r,m=Ir(r),C=s!==t,N=s===null,q=s===s,X=Ir(s);if(!N&&!X&&!m&&r>s||m&&C&&q&&!N&&!X||l&&C&&q||!a&&q||!y)return 1;if(!l&&!m&&!X&&r<s||X&&a&&y&&!l&&!m||N&&a&&y||!C&&y||!q)return-1}return 0}function vy(r,s,a){for(var l=-1,y=r.criteria,m=s.criteria,C=y.length,N=a.length;++l<C;){var q=ol(y[l],m[l]);if(q){if(l>=N)return q;var X=a[l];return q*(X=="desc"?-1:1)}}return r.index-s.index}function al(r,s,a,l){for(var y=-1,m=r.length,C=a.length,N=-1,q=s.length,X=Kt(m-C,0),Z=K(q+X),ne=!l;++N<q;)Z[N]=s[N];for(;++y<C;)(ne||y<m)&&(Z[a[y]]=r[y]);for(;X--;)Z[N++]=r[y++];return Z}function cl(r,s,a,l){for(var y=-1,m=r.length,C=-1,N=a.length,q=-1,X=s.length,Z=Kt(m-N,0),ne=K(Z+X),he=!l;++y<Z;)ne[y]=r[y];for(var ye=y;++q<X;)ne[ye+q]=s[q];for(;++C<N;)(he||y<m)&&(ne[ye+a[C]]=r[y++]);return ne}function pr(r,s){var a=-1,l=r.length;for(s||(s=K(l));++a<l;)s[a]=r[a];return s}function tn(r,s,a,l){var y=!a;a||(a={});for(var m=-1,C=s.length;++m<C;){var N=s[m],q=l?l(a[N],r[N],N,a,r):t;q===t&&(q=r[N]),y?fn(a,N,q):ns(a,N,q)}return a}function _y(r,s){return tn(r,xc(r),s)}function my(r,s){return tn(r,wl(r),s)}function Oo(r,s){return function(a,l){var y=Re(a)?Sg:z0,m=s?s():{};return y(a,r,me(l,2),m)}}function Pi(r){return Ke(function(s,a){var l=-1,y=a.length,m=y>1?a[y-1]:t,C=y>2?a[2]:t;for(m=r.length>3&&typeof m=="function"?(y--,m):t,C&&or(a[0],a[1],C)&&(m=y<3?t:m,y=1),s=ht(s);++l<y;){var N=a[l];N&&r(s,N,l,m)}return s})}function ul(r,s){return function(a,l){if(a==null)return a;if(!gr(a))return r(a,l);for(var y=a.length,m=s?y:-1,C=ht(a);(s?m--:++m<y)&&l(C[m],m,C)!==!1;);return a}}function hl(r){return function(s,a,l){for(var y=-1,m=ht(s),C=l(s),N=C.length;N--;){var q=C[r?N:++y];if(a(m[q],q,m)===!1)break}return s}}function by(r,s,a){var l=s&B,y=cs(r);function m(){var C=this&&this!==Xe&&this instanceof m?y:r;return C.apply(l?a:this,arguments)}return m}function ll(r){return function(s){s=nt(s);var a=wi(s)?Br(s):t,l=a?a[0]:s.charAt(0),y=a?Ln(a,1).join(""):s.slice(1);return l[r]()+y}}function Ci(r){return function(s){return Ka(hf(uf(s).replace(Yi,"")),r,"")}}function cs(r){return function(){var s=arguments;switch(s.length){case 0:return new r;case 1:return new r(s[0]);case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[1],s[2]);case 4:return new r(s[0],s[1],s[2],s[3]);case 5:return new r(s[0],s[1],s[2],s[3],s[4]);case 6:return new r(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new r(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var a=Oi(r.prototype),l=r.apply(a,s);return Et(l)?l:a}}function wy(r,s,a){var l=cs(r);function y(){for(var m=arguments.length,C=K(m),N=m,q=Ai(y);N--;)C[N]=arguments[N];var X=m<3&&C[0]!==q&&C[m-1]!==q?[]:An(C,q);if(m-=X.length,m<a)return yl(r,s,Po,y.placeholder,t,C,X,t,t,a-m);var Z=this&&this!==Xe&&this instanceof y?l:r;return Vt(Z,this,C)}return y}function fl(r){return function(s,a,l){var y=ht(s);if(!gr(s)){var m=me(a,3);s=kt(s),a=function(N){return m(y[N],N,y)}}var C=r(s,a,l);return C>-1?y[m?s[C]:C]:t}}function dl(r){return pn(function(s){var a=s.length,l=a,y=Lr.prototype.thru;for(r&&s.reverse();l--;){var m=s[l];if(typeof m!="function")throw new $r(h);if(y&&!C&&Ro(m)=="wrapper")var C=new Lr([],!0)}for(l=C?l:a;++l<a;){m=s[l];var N=Ro(m),q=N=="wrapper"?Sc(m):t;q&&Pc(q[0])&&q[1]==(u|U|R|b)&&!q[4].length&&q[9]==1?C=C[Ro(q[0])].apply(C,q[3]):C=m.length==1&&Pc(m)?C[N]():C.thru(m)}return function(){var X=arguments,Z=X[0];if(C&&X.length==1&&Re(Z))return C.plant(Z).value();for(var ne=0,he=a?s[ne].apply(this,X):Z;++ne<a;)he=s[ne].call(this,he);return he}})}function Po(r,s,a,l,y,m,C,N,q,X){var Z=s&u,ne=s&B,he=s&ie,ye=s&(U|P),Ee=s&G,ze=he?t:cs(r);function De(){for(var Ge=arguments.length,Ze=K(Ge),xr=Ge;xr--;)Ze[xr]=arguments[xr];if(ye)var ar=Ai(De),Or=Ng(Ze,ar);if(l&&(Ze=al(Ze,l,y,ye)),m&&(Ze=cl(Ze,m,C,ye)),Ge-=Or,ye&&Ge<X){var $t=An(Ze,ar);return yl(r,s,Po,De.placeholder,a,Ze,$t,N,q,X-Ge)}var kr=ne?a:this,_n=he?kr[r]:r;return Ge=Ze.length,N?Ze=zy(Ze,N):Ee&&Ge>1&&Ze.reverse(),Z&&q<Ge&&(Ze.length=q),this&&this!==Xe&&this instanceof De&&(_n=ze||cs(_n)),_n.apply(kr,Ze)}return De}function pl(r,s){return function(a,l){return Y0(a,r,s(l),{})}}function Co(r,s){return function(a,l){var y;if(a===t&&l===t)return s;if(a!==t&&(y=a),l!==t){if(y===t)return l;typeof a=="string"||typeof l=="string"?(a=Sr(a),l=Sr(l)):(a=Zh(a),l=Zh(l)),y=r(a,l)}return y}}function bc(r){return pn(function(s){return s=mt(s,Dr(me())),Ke(function(a){var l=this;return r(s,function(y){return Vt(y,l,a)})})})}function Ao(r,s){s=s===t?" ":Sr(s);var a=s.length;if(a<2)return a?dc(s,r):s;var l=dc(s,yo(r/Ei(s)));return wi(s)?Ln(Br(l),0,r).join(""):l.slice(0,r)}function Ey(r,s,a,l){var y=s&B,m=cs(r);function C(){for(var N=-1,q=arguments.length,X=-1,Z=l.length,ne=K(Z+q),he=this&&this!==Xe&&this instanceof C?m:r;++X<Z;)ne[X]=l[X];for(;q--;)ne[X++]=arguments[++N];return Vt(he,y?a:this,ne)}return C}function gl(r){return function(s,a,l){return l&&typeof l!="number"&&or(s,a,l)&&(a=l=t),s=vn(s),a===t?(a=s,s=0):a=vn(a),l=l===t?s<a?1:-1:vn(l),ay(s,a,l,r)}}function To(r){return function(s,a){return typeof s=="string"&&typeof a=="string"||(s=qr(s),a=qr(a)),r(s,a)}}function yl(r,s,a,l,y,m,C,N,q,X){var Z=s&U,ne=Z?C:t,he=Z?t:C,ye=Z?m:t,Ee=Z?t:m;s|=Z?R:E,s&=~(Z?E:R),s&$||(s&=~(B|ie));var ze=[r,s,y,ye,ne,Ee,he,N,q,X],De=a.apply(t,ze);return Pc(r)&&Pl(De,ze),De.placeholder=l,Cl(De,r,s)}function wc(r){var s=Bt[r];return function(a,l){if(a=qr(a),l=l==null?0:Xt(Me(l),292),l&&Ch(a)){var y=(nt(a)+"e").split("e"),m=s(y[0]+"e"+(+y[1]+l));return y=(nt(m)+"e").split("e"),+(y[0]+"e"+(+y[1]-l))}return s(a)}}var Dy=Ii&&1/so(new Ii([,-0]))[1]==Q?function(r){return new Ii(r)}:Bc;function vl(r){return function(s){var a=Zt(s);return a==Ie?Qa(s):a==xe?Fg(s):Rg(s,r(s))}}function dn(r,s,a,l,y,m,C,N){var q=s&ie;if(!q&&typeof r!="function")throw new $r(h);var X=l?l.length:0;if(X||(s&=~(R|E),l=y=t),C=C===t?C:Kt(Me(C),0),N=N===t?N:Me(N),X-=y?y.length:0,s&E){var Z=l,ne=y;l=y=t}var he=q?t:Sc(r),ye=[r,s,a,l,y,Z,ne,m,C,N];if(he&&My(ye,he),r=ye[0],s=ye[1],a=ye[2],l=ye[3],y=ye[4],N=ye[9]=ye[9]===t?q?0:r.length:Kt(ye[9]-X,0),!N&&s&(U|P)&&(s&=~(U|P)),!s||s==B)var Ee=by(r,s,a);else s==U||s==P?Ee=wy(r,s,N):(s==R||s==(B|R))&&!y.length?Ee=Ey(r,s,a,l):Ee=Po.apply(t,ye);var ze=he?Qh:Pl;return Cl(ze(Ee,ye),r,s)}function _l(r,s,a,l){return r===t||Vr(r,Si[a])&&!it.call(l,a)?s:r}function ml(r,s,a,l,y,m){return Et(r)&&Et(s)&&(m.set(s,r),So(r,s,t,ml,m),m.delete(s)),r}function Sy(r){return ls(r)?t:r}function bl(r,s,a,l,y,m){var C=a&O,N=r.length,q=s.length;if(N!=q&&!(C&&q>N))return!1;var X=m.get(r),Z=m.get(s);if(X&&Z)return X==s&&Z==r;var ne=-1,he=!0,ye=a&z?new Jn:t;for(m.set(r,s),m.set(s,r);++ne<N;){var Ee=r[ne],ze=s[ne];if(l)var De=C?l(ze,Ee,ne,s,r,m):l(Ee,ze,ne,r,s,m);if(De!==t){if(De)continue;he=!1;break}if(ye){if(!Va(s,function(Ge,Ze){if(!Qi(ye,Ze)&&(Ee===Ge||y(Ee,Ge,a,l,m)))return ye.push(Ze)})){he=!1;break}}else if(!(Ee===ze||y(Ee,ze,a,l,m))){he=!1;break}}return m.delete(r),m.delete(s),he}function Iy(r,s,a,l,y,m,C){switch(a){case Ce:if(r.byteLength!=s.byteLength||r.byteOffset!=s.byteOffset)return!1;r=r.buffer,s=s.buffer;case Se:return!(r.byteLength!=s.byteLength||!m(new lo(r),new lo(s)));case F:case L:case He:return Vr(+r,+s);case T:return r.name==s.name&&r.message==s.message;case qe:case Ne:return r==s+"";case Ie:var N=Qa;case xe:var q=l&O;if(N||(N=so),r.size!=s.size&&!q)return!1;var X=C.get(r);if(X)return X==s;l|=z,C.set(r,s);var Z=bl(N(r),N(s),l,y,m,C);return C.delete(r),Z;case $e:if(rs)return rs.call(r)==rs.call(s)}return!1}function xy(r,s,a,l,y,m){var C=a&O,N=Ec(r),q=N.length,X=Ec(s),Z=X.length;if(q!=Z&&!C)return!1;for(var ne=q;ne--;){var he=N[ne];if(!(C?he in s:it.call(s,he)))return!1}var ye=m.get(r),Ee=m.get(s);if(ye&&Ee)return ye==s&&Ee==r;var ze=!0;m.set(r,s),m.set(s,r);for(var De=C;++ne<q;){he=N[ne];var Ge=r[he],Ze=s[he];if(l)var xr=C?l(Ze,Ge,he,s,r,m):l(Ge,Ze,he,r,s,m);if(!(xr===t?Ge===Ze||y(Ge,Ze,a,l,m):xr)){ze=!1;break}De||(De=he=="constructor")}if(ze&&!De){var ar=r.constructor,Or=s.constructor;ar!=Or&&"constructor"in r&&"constructor"in s&&!(typeof ar=="function"&&ar instanceof ar&&typeof Or=="function"&&Or instanceof Or)&&(ze=!1)}return m.delete(r),m.delete(s),ze}function pn(r){return Ac(xl(r,t,Ll),r+"")}function Ec(r){return Fh(r,kt,xc)}function Dc(r){return Fh(r,yr,wl)}var Sc=_o?function(r){return _o.get(r)}:Bc;function Ro(r){for(var s=r.name+"",a=xi[s],l=it.call(xi,s)?a.length:0;l--;){var y=a[l],m=y.func;if(m==null||m==r)return y.name}return s}function Ai(r){var s=it.call(_,"placeholder")?_:r;return s.placeholder}function me(){var r=_.iteratee||zc;return r=r===zc?Bh:r,arguments.length?r(arguments[0],arguments[1]):r}function No(r,s){var a=r.__data__;return $y(s)?a[typeof s=="string"?"string":"hash"]:a.map}function Ic(r){for(var s=kt(r),a=s.length;a--;){var l=s[a],y=r[l];s[a]=[l,y,Sl(y)]}return s}function Zn(r,s){var a=jg(r,s);return Hh(a)?a:t}function Oy(r){var s=it.call(r,Wn),a=r[Wn];try{r[Wn]=t;var l=!0}catch{}var y=uo.call(r);return l&&(s?r[Wn]=a:delete r[Wn]),y}var xc=Za?function(r){return r==null?[]:(r=ht(r),Pn(Za(r),function(s){return Oh.call(r,s)}))}:Kc,wl=Za?function(r){for(var s=[];r;)Cn(s,xc(r)),r=fo(r);return s}:Kc,Zt=sr;(ec&&Zt(new ec(new ArrayBuffer(1)))!=Ce||Zi&&Zt(new Zi)!=Ie||tc&&Zt(tc.resolve())!=gt||Ii&&Zt(new Ii)!=xe||es&&Zt(new es)!=Pe)&&(Zt=function(r){var s=sr(r),a=s==je?r.constructor:t,l=a?ei(a):"";if(l)switch(l){case u0:return Ce;case h0:return Ie;case l0:return gt;case f0:return xe;case d0:return Pe}return s});function Py(r,s,a){for(var l=-1,y=a.length;++l<y;){var m=a[l],C=m.size;switch(m.type){case"drop":r+=C;break;case"dropRight":s-=C;break;case"take":s=Xt(s,r+C);break;case"takeRight":r=Kt(r,s-C);break}}return{start:r,end:s}}function Cy(r){var s=r.match(lt);return s?s[1].split(Mt):[]}function El(r,s,a){s=$n(s,r);for(var l=-1,y=s.length,m=!1;++l<y;){var C=rn(s[l]);if(!(m=r!=null&&a(r,C)))break;r=r[C]}return m||++l!=y?m:(y=r==null?0:r.length,!!y&&Fo(y)&&gn(C,y)&&(Re(r)||ti(r)))}function Ay(r){var s=r.length,a=new r.constructor(s);return s&&typeof r[0]=="string"&&it.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function Dl(r){return typeof r.constructor=="function"&&!us(r)?Oi(fo(r)):{}}function Ty(r,s,a){var l=r.constructor;switch(s){case Se:return mc(r);case F:case L:return new l(+r);case Ce:return py(r,a);case Be:case Oe:case ke:case We:case et:case tt:case Qe:case rr:case fr:return sl(r,a);case Ie:return new l;case He:case Ne:return new l(r);case qe:return gy(r);case xe:return new l;case $e:return yy(r)}}function Ry(r,s){var a=s.length;if(!a)return r;var l=a-1;return s[l]=(a>1?"& ":"")+s[l],s=s.join(a>2?", ":" "),r.replace(Pt,`{
/* [wrapped with `+s+`] */
`)}function Ny(r){return Re(r)||ti(r)||!!(Ph&&r&&r[Ph])}function gn(r,s){var a=typeof r;return s=s??V,!!s&&(a=="number"||a!="symbol"&&Ca.test(r))&&r>-1&&r%1==0&&r<s}function or(r,s,a){if(!Et(a))return!1;var l=typeof s;return(l=="number"?gr(a)&&gn(s,a.length):l=="string"&&s in a)?Vr(a[s],r):!1}function Oc(r,s){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Ir(r)?!0:Lt.test(r)||!_t.test(r)||s!=null&&r in ht(s)}function $y(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}function Pc(r){var s=Ro(r),a=_[s];if(typeof a!="function"||!(s in Ye.prototype))return!1;if(r===a)return!0;var l=Sc(a);return!!l&&r===l[0]}function Ly(r){return!!Sh&&Sh in r}var Uy=ao?yn:Vc;function us(r){var s=r&&r.constructor,a=typeof s=="function"&&s.prototype||Si;return r===a}function Sl(r){return r===r&&!Et(r)}function Il(r,s){return function(a){return a==null?!1:a[r]===s&&(s!==t||r in ht(a))}}function jy(r){var s=Mo(r,function(l){return a.size===p&&a.clear(),l}),a=s.cache;return s}function My(r,s){var a=r[1],l=s[1],y=a|l,m=y<(B|ie|u),C=l==u&&a==U||l==u&&a==b&&r[7].length<=s[8]||l==(u|b)&&s[7].length<=s[8]&&a==U;if(!(m||C))return r;l&B&&(r[2]=s[2],y|=a&B?0:$);var N=s[3];if(N){var q=r[3];r[3]=q?al(q,N,s[4]):N,r[4]=q?An(r[3],v):s[4]}return N=s[5],N&&(q=r[5],r[5]=q?cl(q,N,s[6]):N,r[6]=q?An(r[5],v):s[6]),N=s[7],N&&(r[7]=N),l&u&&(r[8]=r[8]==null?s[8]:Xt(r[8],s[8])),r[9]==null&&(r[9]=s[9]),r[0]=s[0],r[1]=y,r}function qy(r){var s=[];if(r!=null)for(var a in ht(r))s.push(a);return s}function Fy(r){return uo.call(r)}function xl(r,s,a){return s=Kt(s===t?r.length-1:s,0),function(){for(var l=arguments,y=-1,m=Kt(l.length-s,0),C=K(m);++y<m;)C[y]=l[s+y];y=-1;for(var N=K(s+1);++y<s;)N[y]=l[y];return N[s]=a(C),Vt(r,this,N)}}function Ol(r,s){return s.length<2?r:Xn(r,jr(s,0,-1))}function zy(r,s){for(var a=r.length,l=Xt(s.length,a),y=pr(r);l--;){var m=s[l];r[l]=gn(m,a)?y[m]:t}return r}function Cc(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}var Pl=Al(Qh),hs=r0||function(r,s){return Xe.setTimeout(r,s)},Ac=Al(hy);function Cl(r,s,a){var l=s+"";return Ac(r,Ry(l,Hy(Cy(l),a)))}function Al(r){var s=0,a=0;return function(){var l=o0(),y=de-(l-a);if(a=l,y>0){if(++s>=ce)return arguments[0]}else s=0;return r.apply(t,arguments)}}function $o(r,s){var a=-1,l=r.length,y=l-1;for(s=s===t?l:s;++a<s;){var m=fc(a,y),C=r[m];r[m]=r[a],r[a]=C}return r.length=s,r}var Tl=jy(function(r){var s=[];return r.charCodeAt(0)===46&&s.push(""),r.replace(Ut,function(a,l,y,m){s.push(y?m.replace(Da,"$1"):l||a)}),s});function rn(r){if(typeof r=="string"||Ir(r))return r;var s=r+"";return s=="0"&&1/r==-Q?"-0":s}function ei(r){if(r!=null){try{return co.call(r)}catch{}try{return r+""}catch{}}return""}function Hy(r,s){return Nr(we,function(a){var l="_."+a[0];s&a[1]&&!no(r,l)&&r.push(l)}),r.sort()}function Rl(r){if(r instanceof Ye)return r.clone();var s=new Lr(r.__wrapped__,r.__chain__);return s.__actions__=pr(r.__actions__),s.__index__=r.__index__,s.__values__=r.__values__,s}function By(r,s,a){(a?or(r,s,a):s===t)?s=1:s=Kt(Me(s),0);var l=r==null?0:r.length;if(!l||s<1)return[];for(var y=0,m=0,C=K(yo(l/s));y<l;)C[m++]=jr(r,y,y+=s);return C}function Ky(r){for(var s=-1,a=r==null?0:r.length,l=0,y=[];++s<a;){var m=r[s];m&&(y[l++]=m)}return y}function Vy(){var r=arguments.length;if(!r)return[];for(var s=K(r-1),a=arguments[0],l=r;l--;)s[l-1]=arguments[l];return Cn(Re(a)?pr(a):[a],Yt(s,1))}var ky=Ke(function(r,s){return Nt(r)?is(r,Yt(s,1,Nt,!0)):[]}),Gy=Ke(function(r,s){var a=Mr(s);return Nt(a)&&(a=t),Nt(r)?is(r,Yt(s,1,Nt,!0),me(a,2)):[]}),Wy=Ke(function(r,s){var a=Mr(s);return Nt(a)&&(a=t),Nt(r)?is(r,Yt(s,1,Nt,!0),t,a):[]});function Yy(r,s,a){var l=r==null?0:r.length;return l?(s=a||s===t?1:Me(s),jr(r,s<0?0:s,l)):[]}function Jy(r,s,a){var l=r==null?0:r.length;return l?(s=a||s===t?1:Me(s),s=l-s,jr(r,0,s<0?0:s)):[]}function Qy(r,s){return r&&r.length?xo(r,me(s,3),!0,!0):[]}function Xy(r,s){return r&&r.length?xo(r,me(s,3),!0):[]}function Zy(r,s,a,l){var y=r==null?0:r.length;return y?(a&&typeof a!="number"&&or(r,s,a)&&(a=0,l=y),V0(r,s,a,l)):[]}function Nl(r,s,a){var l=r==null?0:r.length;if(!l)return-1;var y=a==null?0:Me(a);return y<0&&(y=Kt(l+y,0)),io(r,me(s,3),y)}function $l(r,s,a){var l=r==null?0:r.length;if(!l)return-1;var y=l-1;return a!==t&&(y=Me(a),y=a<0?Kt(l+y,0):Xt(y,l-1)),io(r,me(s,3),y,!0)}function Ll(r){var s=r==null?0:r.length;return s?Yt(r,1):[]}function ev(r){var s=r==null?0:r.length;return s?Yt(r,Q):[]}function tv(r,s){var a=r==null?0:r.length;return a?(s=s===t?1:Me(s),Yt(r,s)):[]}function rv(r){for(var s=-1,a=r==null?0:r.length,l={};++s<a;){var y=r[s];l[y[0]]=y[1]}return l}function Ul(r){return r&&r.length?r[0]:t}function nv(r,s,a){var l=r==null?0:r.length;if(!l)return-1;var y=a==null?0:Me(a);return y<0&&(y=Kt(l+y,0)),bi(r,s,y)}function iv(r){var s=r==null?0:r.length;return s?jr(r,0,-1):[]}var sv=Ke(function(r){var s=mt(r,vc);return s.length&&s[0]===r[0]?ac(s):[]}),ov=Ke(function(r){var s=Mr(r),a=mt(r,vc);return s===Mr(a)?s=t:a.pop(),a.length&&a[0]===r[0]?ac(a,me(s,2)):[]}),av=Ke(function(r){var s=Mr(r),a=mt(r,vc);return s=typeof s=="function"?s:t,s&&a.pop(),a.length&&a[0]===r[0]?ac(a,t,s):[]});function cv(r,s){return r==null?"":i0.call(r,s)}function Mr(r){var s=r==null?0:r.length;return s?r[s-1]:t}function uv(r,s,a){var l=r==null?0:r.length;if(!l)return-1;var y=l;return a!==t&&(y=Me(a),y=y<0?Kt(l+y,0):Xt(y,l-1)),s===s?Hg(r,s,y):io(r,yh,y,!0)}function hv(r,s){return r&&r.length?Gh(r,Me(s)):t}var lv=Ke(jl);function jl(r,s){return r&&r.length&&s&&s.length?lc(r,s):r}function fv(r,s,a){return r&&r.length&&s&&s.length?lc(r,s,me(a,2)):r}function dv(r,s,a){return r&&r.length&&s&&s.length?lc(r,s,t,a):r}var pv=pn(function(r,s){var a=r==null?0:r.length,l=nc(r,s);return Jh(r,mt(s,function(y){return gn(y,a)?+y:y}).sort(ol)),l});function gv(r,s){var a=[];if(!(r&&r.length))return a;var l=-1,y=[],m=r.length;for(s=me(s,3);++l<m;){var C=r[l];s(C,l,r)&&(a.push(C),y.push(l))}return Jh(r,y),a}function Tc(r){return r==null?r:c0.call(r)}function yv(r,s,a){var l=r==null?0:r.length;return l?(a&&typeof a!="number"&&or(r,s,a)?(s=0,a=l):(s=s==null?0:Me(s),a=a===t?l:Me(a)),jr(r,s,a)):[]}function vv(r,s){return Io(r,s)}function _v(r,s,a){return pc(r,s,me(a,2))}function mv(r,s){var a=r==null?0:r.length;if(a){var l=Io(r,s);if(l<a&&Vr(r[l],s))return l}return-1}function bv(r,s){return Io(r,s,!0)}function wv(r,s,a){return pc(r,s,me(a,2),!0)}function Ev(r,s){var a=r==null?0:r.length;if(a){var l=Io(r,s,!0)-1;if(Vr(r[l],s))return l}return-1}function Dv(r){return r&&r.length?Xh(r):[]}function Sv(r,s){return r&&r.length?Xh(r,me(s,2)):[]}function Iv(r){var s=r==null?0:r.length;return s?jr(r,1,s):[]}function xv(r,s,a){return r&&r.length?(s=a||s===t?1:Me(s),jr(r,0,s<0?0:s)):[]}function Ov(r,s,a){var l=r==null?0:r.length;return l?(s=a||s===t?1:Me(s),s=l-s,jr(r,s<0?0:s,l)):[]}function Pv(r,s){return r&&r.length?xo(r,me(s,3),!1,!0):[]}function Cv(r,s){return r&&r.length?xo(r,me(s,3)):[]}var Av=Ke(function(r){return Nn(Yt(r,1,Nt,!0))}),Tv=Ke(function(r){var s=Mr(r);return Nt(s)&&(s=t),Nn(Yt(r,1,Nt,!0),me(s,2))}),Rv=Ke(function(r){var s=Mr(r);return s=typeof s=="function"?s:t,Nn(Yt(r,1,Nt,!0),t,s)});function Nv(r){return r&&r.length?Nn(r):[]}function $v(r,s){return r&&r.length?Nn(r,me(s,2)):[]}function Lv(r,s){return s=typeof s=="function"?s:t,r&&r.length?Nn(r,t,s):[]}function Rc(r){if(!(r&&r.length))return[];var s=0;return r=Pn(r,function(a){if(Nt(a))return s=Kt(a.length,s),!0}),Ya(s,function(a){return mt(r,ka(a))})}function Ml(r,s){if(!(r&&r.length))return[];var a=Rc(r);return s==null?a:mt(a,function(l){return Vt(s,t,l)})}var Uv=Ke(function(r,s){return Nt(r)?is(r,s):[]}),jv=Ke(function(r){return yc(Pn(r,Nt))}),Mv=Ke(function(r){var s=Mr(r);return Nt(s)&&(s=t),yc(Pn(r,Nt),me(s,2))}),qv=Ke(function(r){var s=Mr(r);return s=typeof s=="function"?s:t,yc(Pn(r,Nt),t,s)}),Fv=Ke(Rc);function zv(r,s){return rl(r||[],s||[],ns)}function Hv(r,s){return rl(r||[],s||[],as)}var Bv=Ke(function(r){var s=r.length,a=s>1?r[s-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Ml(r,a)});function ql(r){var s=_(r);return s.__chain__=!0,s}function Kv(r,s){return s(r),r}function Lo(r,s){return s(r)}var Vv=pn(function(r){var s=r.length,a=s?r[0]:0,l=this.__wrapped__,y=function(m){return nc(m,r)};return s>1||this.__actions__.length||!(l instanceof Ye)||!gn(a)?this.thru(y):(l=l.slice(a,+a+(s?1:0)),l.__actions__.push({func:Lo,args:[y],thisArg:t}),new Lr(l,this.__chain__).thru(function(m){return s&&!m.length&&m.push(t),m}))});function kv(){return ql(this)}function Gv(){return new Lr(this.value(),this.__chain__)}function Wv(){this.__values__===t&&(this.__values__=Zl(this.value()));var r=this.__index__>=this.__values__.length,s=r?t:this.__values__[this.__index__++];return{done:r,value:s}}function Yv(){return this}function Jv(r){for(var s,a=this;a instanceof bo;){var l=Rl(a);l.__index__=0,l.__values__=t,s?y.__wrapped__=l:s=l;var y=l;a=a.__wrapped__}return y.__wrapped__=r,s}function Qv(){var r=this.__wrapped__;if(r instanceof Ye){var s=r;return this.__actions__.length&&(s=new Ye(this)),s=s.reverse(),s.__actions__.push({func:Lo,args:[Tc],thisArg:t}),new Lr(s,this.__chain__)}return this.thru(Tc)}function Xv(){return tl(this.__wrapped__,this.__actions__)}var Zv=Oo(function(r,s,a){it.call(r,a)?++r[a]:fn(r,a,1)});function e_(r,s,a){var l=Re(r)?ph:K0;return a&&or(r,s,a)&&(s=t),l(r,me(s,3))}function t_(r,s){var a=Re(r)?Pn:Mh;return a(r,me(s,3))}var r_=fl(Nl),n_=fl($l);function i_(r,s){return Yt(Uo(r,s),1)}function s_(r,s){return Yt(Uo(r,s),Q)}function o_(r,s,a){return a=a===t?1:Me(a),Yt(Uo(r,s),a)}function Fl(r,s){var a=Re(r)?Nr:Rn;return a(r,me(s,3))}function zl(r,s){var a=Re(r)?Ig:jh;return a(r,me(s,3))}var a_=Oo(function(r,s,a){it.call(r,a)?r[a].push(s):fn(r,a,[s])});function c_(r,s,a,l){r=gr(r)?r:Ri(r),a=a&&!l?Me(a):0;var y=r.length;return a<0&&(a=Kt(y+a,0)),zo(r)?a<=y&&r.indexOf(s,a)>-1:!!y&&bi(r,s,a)>-1}var u_=Ke(function(r,s,a){var l=-1,y=typeof s=="function",m=gr(r)?K(r.length):[];return Rn(r,function(C){m[++l]=y?Vt(s,C,a):ss(C,s,a)}),m}),h_=Oo(function(r,s,a){fn(r,a,s)});function Uo(r,s){var a=Re(r)?mt:Kh;return a(r,me(s,3))}function l_(r,s,a,l){return r==null?[]:(Re(s)||(s=s==null?[]:[s]),a=l?t:a,Re(a)||(a=a==null?[]:[a]),Wh(r,s,a))}var f_=Oo(function(r,s,a){r[a?0:1].push(s)},function(){return[[],[]]});function d_(r,s,a){var l=Re(r)?Ka:_h,y=arguments.length<3;return l(r,me(s,4),a,y,Rn)}function p_(r,s,a){var l=Re(r)?xg:_h,y=arguments.length<3;return l(r,me(s,4),a,y,jh)}function g_(r,s){var a=Re(r)?Pn:Mh;return a(r,qo(me(s,3)))}function y_(r){var s=Re(r)?Nh:cy;return s(r)}function v_(r,s,a){(a?or(r,s,a):s===t)?s=1:s=Me(s);var l=Re(r)?q0:uy;return l(r,s)}function __(r){var s=Re(r)?F0:ly;return s(r)}function m_(r){if(r==null)return 0;if(gr(r))return zo(r)?Ei(r):r.length;var s=Zt(r);return s==Ie||s==xe?r.size:uc(r).length}function b_(r,s,a){var l=Re(r)?Va:fy;return a&&or(r,s,a)&&(s=t),l(r,me(s,3))}var w_=Ke(function(r,s){if(r==null)return[];var a=s.length;return a>1&&or(r,s[0],s[1])?s=[]:a>2&&or(s[0],s[1],s[2])&&(s=[s[0]]),Wh(r,Yt(s,1),[])}),jo=t0||function(){return Xe.Date.now()};function E_(r,s){if(typeof s!="function")throw new $r(h);return r=Me(r),function(){if(--r<1)return s.apply(this,arguments)}}function Hl(r,s,a){return s=a?t:s,s=r&&s==null?r.length:s,dn(r,u,t,t,t,t,s)}function Bl(r,s){var a;if(typeof s!="function")throw new $r(h);return r=Me(r),function(){return--r>0&&(a=s.apply(this,arguments)),r<=1&&(s=t),a}}var Nc=Ke(function(r,s,a){var l=B;if(a.length){var y=An(a,Ai(Nc));l|=R}return dn(r,l,s,a,y)}),Kl=Ke(function(r,s,a){var l=B|ie;if(a.length){var y=An(a,Ai(Kl));l|=R}return dn(s,l,r,a,y)});function Vl(r,s,a){s=a?t:s;var l=dn(r,U,t,t,t,t,t,s);return l.placeholder=Vl.placeholder,l}function kl(r,s,a){s=a?t:s;var l=dn(r,P,t,t,t,t,t,s);return l.placeholder=kl.placeholder,l}function Gl(r,s,a){var l,y,m,C,N,q,X=0,Z=!1,ne=!1,he=!0;if(typeof r!="function")throw new $r(h);s=qr(s)||0,Et(a)&&(Z=!!a.leading,ne="maxWait"in a,m=ne?Kt(qr(a.maxWait)||0,s):m,he="trailing"in a?!!a.trailing:he);function ye($t){var kr=l,_n=y;return l=y=t,X=$t,C=r.apply(_n,kr),C}function Ee($t){return X=$t,N=hs(Ge,s),Z?ye($t):C}function ze($t){var kr=$t-q,_n=$t-X,df=s-kr;return ne?Xt(df,m-_n):df}function De($t){var kr=$t-q,_n=$t-X;return q===t||kr>=s||kr<0||ne&&_n>=m}function Ge(){var $t=jo();if(De($t))return Ze($t);N=hs(Ge,ze($t))}function Ze($t){return N=t,he&&l?ye($t):(l=y=t,C)}function xr(){N!==t&&nl(N),X=0,l=q=y=N=t}function ar(){return N===t?C:Ze(jo())}function Or(){var $t=jo(),kr=De($t);if(l=arguments,y=this,q=$t,kr){if(N===t)return Ee(q);if(ne)return nl(N),N=hs(Ge,s),ye(q)}return N===t&&(N=hs(Ge,s)),C}return Or.cancel=xr,Or.flush=ar,Or}var D_=Ke(function(r,s){return Uh(r,1,s)}),S_=Ke(function(r,s,a){return Uh(r,qr(s)||0,a)});function I_(r){return dn(r,G)}function Mo(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new $r(h);var a=function(){var l=arguments,y=s?s.apply(this,l):l[0],m=a.cache;if(m.has(y))return m.get(y);var C=r.apply(this,l);return a.cache=m.set(y,C)||m,C};return a.cache=new(Mo.Cache||ln),a}Mo.Cache=ln;function qo(r){if(typeof r!="function")throw new $r(h);return function(){var s=arguments;switch(s.length){case 0:return!r.call(this);case 1:return!r.call(this,s[0]);case 2:return!r.call(this,s[0],s[1]);case 3:return!r.call(this,s[0],s[1],s[2])}return!r.apply(this,s)}}function x_(r){return Bl(2,r)}var O_=dy(function(r,s){s=s.length==1&&Re(s[0])?mt(s[0],Dr(me())):mt(Yt(s,1),Dr(me()));var a=s.length;return Ke(function(l){for(var y=-1,m=Xt(l.length,a);++y<m;)l[y]=s[y].call(this,l[y]);return Vt(r,this,l)})}),$c=Ke(function(r,s){var a=An(s,Ai($c));return dn(r,R,t,s,a)}),Wl=Ke(function(r,s){var a=An(s,Ai(Wl));return dn(r,E,t,s,a)}),P_=pn(function(r,s){return dn(r,b,t,t,t,s)});function C_(r,s){if(typeof r!="function")throw new $r(h);return s=s===t?s:Me(s),Ke(r,s)}function A_(r,s){if(typeof r!="function")throw new $r(h);return s=s==null?0:Kt(Me(s),0),Ke(function(a){var l=a[s],y=Ln(a,0,s);return l&&Cn(y,l),Vt(r,this,y)})}function T_(r,s,a){var l=!0,y=!0;if(typeof r!="function")throw new $r(h);return Et(a)&&(l="leading"in a?!!a.leading:l,y="trailing"in a?!!a.trailing:y),Gl(r,s,{leading:l,maxWait:s,trailing:y})}function R_(r){return Hl(r,1)}function N_(r,s){return $c(_c(s),r)}function $_(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function L_(r){return Ur(r,x)}function U_(r,s){return s=typeof s=="function"?s:t,Ur(r,x,s)}function j_(r){return Ur(r,S|x)}function M_(r,s){return s=typeof s=="function"?s:t,Ur(r,S|x,s)}function q_(r,s){return s==null||Lh(r,s,kt(s))}function Vr(r,s){return r===s||r!==r&&s!==s}var F_=To(oc),z_=To(function(r,s){return r>=s}),ti=zh(function(){return arguments}())?zh:function(r){return Ct(r)&&it.call(r,"callee")&&!Oh.call(r,"callee")},Re=K.isArray,H_=ir?Dr(ir):J0;function gr(r){return r!=null&&Fo(r.length)&&!yn(r)}function Nt(r){return Ct(r)&&gr(r)}function B_(r){return r===!0||r===!1||Ct(r)&&sr(r)==F}var Un=n0||Vc,K_=Hr?Dr(Hr):Q0;function V_(r){return Ct(r)&&r.nodeType===1&&!ls(r)}function k_(r){if(r==null)return!0;if(gr(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||Un(r)||Ti(r)||ti(r)))return!r.length;var s=Zt(r);if(s==Ie||s==xe)return!r.size;if(us(r))return!uc(r).length;for(var a in r)if(it.call(r,a))return!1;return!0}function G_(r,s){return os(r,s)}function W_(r,s,a){a=typeof a=="function"?a:t;var l=a?a(r,s):t;return l===t?os(r,s,t,a):!!l}function Lc(r){if(!Ct(r))return!1;var s=sr(r);return s==T||s==d||typeof r.message=="string"&&typeof r.name=="string"&&!ls(r)}function Y_(r){return typeof r=="number"&&Ch(r)}function yn(r){if(!Et(r))return!1;var s=sr(r);return s==ae||s==fe||s==H||s==yt}function Yl(r){return typeof r=="number"&&r==Me(r)}function Fo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=V}function Et(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}function Ct(r){return r!=null&&typeof r=="object"}var Jl=Rr?Dr(Rr):Z0;function J_(r,s){return r===s||cc(r,s,Ic(s))}function Q_(r,s,a){return a=typeof a=="function"?a:t,cc(r,s,Ic(s),a)}function X_(r){return Ql(r)&&r!=+r}function Z_(r){if(Uy(r))throw new Ae(c);return Hh(r)}function em(r){return r===null}function tm(r){return r==null}function Ql(r){return typeof r=="number"||Ct(r)&&sr(r)==He}function ls(r){if(!Ct(r)||sr(r)!=je)return!1;var s=fo(r);if(s===null)return!0;var a=it.call(s,"constructor")&&s.constructor;return typeof a=="function"&&a instanceof a&&co.call(a)==Qg}var Uc=Zr?Dr(Zr):ey;function rm(r){return Yl(r)&&r>=-V&&r<=V}var Xl=Ji?Dr(Ji):ty;function zo(r){return typeof r=="string"||!Re(r)&&Ct(r)&&sr(r)==Ne}function Ir(r){return typeof r=="symbol"||Ct(r)&&sr(r)==$e}var Ti=Gn?Dr(Gn):ry;function nm(r){return r===t}function im(r){return Ct(r)&&Zt(r)==Pe}function sm(r){return Ct(r)&&sr(r)==Le}var om=To(hc),am=To(function(r,s){return r<=s});function Zl(r){if(!r)return[];if(gr(r))return zo(r)?Br(r):pr(r);if(Xi&&r[Xi])return qg(r[Xi]());var s=Zt(r),a=s==Ie?Qa:s==xe?so:Ri;return a(r)}function vn(r){if(!r)return r===0?r:0;if(r=qr(r),r===Q||r===-Q){var s=r<0?-1:1;return s*k}return r===r?r:0}function Me(r){var s=vn(r),a=s%1;return s===s?a?s-a:s:0}function ef(r){return r?Qn(Me(r),0,re):0}function qr(r){if(typeof r=="number")return r;if(Ir(r))return J;if(Et(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=Et(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=mh(r);var a=xa.test(r);return a||Pa.test(r)?Te(r.slice(2),a?2:8):Ia.test(r)?J:+r}function tf(r){return tn(r,yr(r))}function cm(r){return r?Qn(Me(r),-V,V):r===0?r:0}function nt(r){return r==null?"":Sr(r)}var um=Pi(function(r,s){if(us(s)||gr(s)){tn(s,kt(s),r);return}for(var a in s)it.call(s,a)&&ns(r,a,s[a])}),rf=Pi(function(r,s){tn(s,yr(s),r)}),Ho=Pi(function(r,s,a,l){tn(s,yr(s),r,l)}),hm=Pi(function(r,s,a,l){tn(s,kt(s),r,l)}),lm=pn(nc);function fm(r,s){var a=Oi(r);return s==null?a:$h(a,s)}var dm=Ke(function(r,s){r=ht(r);var a=-1,l=s.length,y=l>2?s[2]:t;for(y&&or(s[0],s[1],y)&&(l=1);++a<l;)for(var m=s[a],C=yr(m),N=-1,q=C.length;++N<q;){var X=C[N],Z=r[X];(Z===t||Vr(Z,Si[X])&&!it.call(r,X))&&(r[X]=m[X])}return r}),pm=Ke(function(r){return r.push(t,ml),Vt(nf,t,r)});function gm(r,s){return gh(r,me(s,3),en)}function ym(r,s){return gh(r,me(s,3),sc)}function vm(r,s){return r==null?r:ic(r,me(s,3),yr)}function _m(r,s){return r==null?r:qh(r,me(s,3),yr)}function mm(r,s){return r&&en(r,me(s,3))}function bm(r,s){return r&&sc(r,me(s,3))}function wm(r){return r==null?[]:Do(r,kt(r))}function Em(r){return r==null?[]:Do(r,yr(r))}function jc(r,s,a){var l=r==null?t:Xn(r,s);return l===t?a:l}function Dm(r,s){return r!=null&&El(r,s,k0)}function Mc(r,s){return r!=null&&El(r,s,G0)}var Sm=pl(function(r,s,a){s!=null&&typeof s.toString!="function"&&(s=uo.call(s)),r[s]=a},Fc(vr)),Im=pl(function(r,s,a){s!=null&&typeof s.toString!="function"&&(s=uo.call(s)),it.call(r,s)?r[s].push(a):r[s]=[a]},me),xm=Ke(ss);function kt(r){return gr(r)?Rh(r):uc(r)}function yr(r){return gr(r)?Rh(r,!0):ny(r)}function Om(r,s){var a={};return s=me(s,3),en(r,function(l,y,m){fn(a,s(l,y,m),l)}),a}function Pm(r,s){var a={};return s=me(s,3),en(r,function(l,y,m){fn(a,y,s(l,y,m))}),a}var Cm=Pi(function(r,s,a){So(r,s,a)}),nf=Pi(function(r,s,a,l){So(r,s,a,l)}),Am=pn(function(r,s){var a={};if(r==null)return a;var l=!1;s=mt(s,function(m){return m=$n(m,r),l||(l=m.length>1),m}),tn(r,Dc(r),a),l&&(a=Ur(a,S|D|x,Sy));for(var y=s.length;y--;)gc(a,s[y]);return a});function Tm(r,s){return sf(r,qo(me(s)))}var Rm=pn(function(r,s){return r==null?{}:sy(r,s)});function sf(r,s){if(r==null)return{};var a=mt(Dc(r),function(l){return[l]});return s=me(s),Yh(r,a,function(l,y){return s(l,y[0])})}function Nm(r,s,a){s=$n(s,r);var l=-1,y=s.length;for(y||(y=1,r=t);++l<y;){var m=r==null?t:r[rn(s[l])];m===t&&(l=y,m=a),r=yn(m)?m.call(r):m}return r}function $m(r,s,a){return r==null?r:as(r,s,a)}function Lm(r,s,a,l){return l=typeof l=="function"?l:t,r==null?r:as(r,s,a,l)}var of=vl(kt),af=vl(yr);function Um(r,s,a){var l=Re(r),y=l||Un(r)||Ti(r);if(s=me(s,4),a==null){var m=r&&r.constructor;y?a=l?new m:[]:Et(r)?a=yn(m)?Oi(fo(r)):{}:a={}}return(y?Nr:en)(r,function(C,N,q){return s(a,C,N,q)}),a}function jm(r,s){return r==null?!0:gc(r,s)}function Mm(r,s,a){return r==null?r:el(r,s,_c(a))}function qm(r,s,a,l){return l=typeof l=="function"?l:t,r==null?r:el(r,s,_c(a),l)}function Ri(r){return r==null?[]:Ja(r,kt(r))}function Fm(r){return r==null?[]:Ja(r,yr(r))}function zm(r,s,a){return a===t&&(a=s,s=t),a!==t&&(a=qr(a),a=a===a?a:0),s!==t&&(s=qr(s),s=s===s?s:0),Qn(qr(r),s,a)}function Hm(r,s,a){return s=vn(s),a===t?(a=s,s=0):a=vn(a),r=qr(r),W0(r,s,a)}function Bm(r,s,a){if(a&&typeof a!="boolean"&&or(r,s,a)&&(s=a=t),a===t&&(typeof s=="boolean"?(a=s,s=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&s===t?(r=0,s=1):(r=vn(r),s===t?(s=r,r=0):s=vn(s)),r>s){var l=r;r=s,s=l}if(a||r%1||s%1){var y=Ah();return Xt(r+y*(s-r+ct("1e-"+((y+"").length-1))),s)}return fc(r,s)}var Km=Ci(function(r,s,a){return s=s.toLowerCase(),r+(a?cf(s):s)});function cf(r){return qc(nt(r).toLowerCase())}function uf(r){return r=nt(r),r&&r.replace(cn,$g).replace(za,"")}function Vm(r,s,a){r=nt(r),s=Sr(s);var l=r.length;a=a===t?l:Qn(Me(a),0,l);var y=a;return a-=s.length,a>=0&&r.slice(a,y)==s}function km(r){return r=nt(r),r&&vt.test(r)?r.replace(Hn,Lg):r}function Gm(r){return r=nt(r),r&&jt.test(r)?r.replace(xt,"\\$&"):r}var Wm=Ci(function(r,s,a){return r+(a?"-":"")+s.toLowerCase()}),Ym=Ci(function(r,s,a){return r+(a?" ":"")+s.toLowerCase()}),Jm=ll("toLowerCase");function Qm(r,s,a){r=nt(r),s=Me(s);var l=s?Ei(r):0;if(!s||l>=s)return r;var y=(s-l)/2;return Ao(vo(y),a)+r+Ao(yo(y),a)}function Xm(r,s,a){r=nt(r),s=Me(s);var l=s?Ei(r):0;return s&&l<s?r+Ao(s-l,a):r}function Zm(r,s,a){r=nt(r),s=Me(s);var l=s?Ei(r):0;return s&&l<s?Ao(s-l,a)+r:r}function eb(r,s,a){return a||s==null?s=0:s&&(s=+s),a0(nt(r).replace(Ot,""),s||0)}function tb(r,s,a){return(a?or(r,s,a):s===t)?s=1:s=Me(s),dc(nt(r),s)}function rb(){var r=arguments,s=nt(r[0]);return r.length<3?s:s.replace(r[1],r[2])}var nb=Ci(function(r,s,a){return r+(a?"_":"")+s.toLowerCase()});function ib(r,s,a){return a&&typeof a!="number"&&or(r,s,a)&&(s=a=t),a=a===t?re:a>>>0,a?(r=nt(r),r&&(typeof s=="string"||s!=null&&!Uc(s))&&(s=Sr(s),!s&&wi(r))?Ln(Br(r),0,a):r.split(s,a)):[]}var sb=Ci(function(r,s,a){return r+(a?" ":"")+qc(s)});function ob(r,s,a){return r=nt(r),a=a==null?0:Qn(Me(a),0,r.length),s=Sr(s),r.slice(a,a+s.length)==s}function ab(r,s,a){var l=_.templateSettings;a&&or(r,s,a)&&(s=t),r=nt(r),s=Ho({},s,l,_l);var y=Ho({},s.imports,l.imports,_l),m=kt(y),C=Ja(y,m),N,q,X=0,Z=s.interpolate||di,ne="__p += '",he=Xa((s.escape||di).source+"|"+Z.source+"|"+(Z===wt?Sa:di).source+"|"+(s.evaluate||di).source+"|$","g"),ye="//# sourceURL="+(it.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ha+"]")+`
`;r.replace(he,function(De,Ge,Ze,xr,ar,Or){return Ze||(Ze=xr),ne+=r.slice(X,Or).replace(Aa,Ug),Ge&&(N=!0,ne+=`' +
__e(`+Ge+`) +
'`),ar&&(q=!0,ne+=`';
`+ar+`;
__p += '`),Ze&&(ne+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),X=Or+De.length,De}),ne+=`';
`;var Ee=it.call(s,"variable")&&s.variable;if(!Ee)ne=`with (obj) {
`+ne+`
}
`;else if(Ea.test(Ee))throw new Ae(f);ne=(q?ne.replace(Qr,""):ne).replace(nr,"$1").replace(an,"$1;"),ne="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ne+`return __p
}`;var ze=lf(function(){return rt(m,ye+"return "+ne).apply(t,C)});if(ze.source=ne,Lc(ze))throw ze;return ze}function cb(r){return nt(r).toLowerCase()}function ub(r){return nt(r).toUpperCase()}function hb(r,s,a){if(r=nt(r),r&&(a||s===t))return mh(r);if(!r||!(s=Sr(s)))return r;var l=Br(r),y=Br(s),m=bh(l,y),C=wh(l,y)+1;return Ln(l,m,C).join("")}function lb(r,s,a){if(r=nt(r),r&&(a||s===t))return r.slice(0,Dh(r)+1);if(!r||!(s=Sr(s)))return r;var l=Br(r),y=wh(l,Br(s))+1;return Ln(l,0,y).join("")}function fb(r,s,a){if(r=nt(r),r&&(a||s===t))return r.replace(Ot,"");if(!r||!(s=Sr(s)))return r;var l=Br(r),y=bh(l,Br(s));return Ln(l,y).join("")}function db(r,s){var a=W,l=se;if(Et(s)){var y="separator"in s?s.separator:y;a="length"in s?Me(s.length):a,l="omission"in s?Sr(s.omission):l}r=nt(r);var m=r.length;if(wi(r)){var C=Br(r);m=C.length}if(a>=m)return r;var N=a-Ei(l);if(N<1)return l;var q=C?Ln(C,0,N).join(""):r.slice(0,N);if(y===t)return q+l;if(C&&(N+=q.length-N),Uc(y)){if(r.slice(N).search(y)){var X,Z=q;for(y.global||(y=Xa(y.source,nt(Tr.exec(y))+"g")),y.lastIndex=0;X=y.exec(Z);)var ne=X.index;q=q.slice(0,ne===t?N:ne)}}else if(r.indexOf(Sr(y),N)!=N){var he=q.lastIndexOf(y);he>-1&&(q=q.slice(0,he))}return q+l}function pb(r){return r=nt(r),r&&Dt.test(r)?r.replace(xn,Bg):r}var gb=Ci(function(r,s,a){return r+(a?" ":"")+s.toUpperCase()}),qc=ll("toUpperCase");function hf(r,s,a){return r=nt(r),s=a?t:s,s===t?Mg(r)?kg(r):Cg(r):r.match(s)||[]}var lf=Ke(function(r,s){try{return Vt(r,t,s)}catch(a){return Lc(a)?a:new Ae(a)}}),yb=pn(function(r,s){return Nr(s,function(a){a=rn(a),fn(r,a,Nc(r[a],r))}),r});function vb(r){var s=r==null?0:r.length,a=me();return r=s?mt(r,function(l){if(typeof l[1]!="function")throw new $r(h);return[a(l[0]),l[1]]}):[],Ke(function(l){for(var y=-1;++y<s;){var m=r[y];if(Vt(m[0],this,l))return Vt(m[1],this,l)}})}function _b(r){return B0(Ur(r,S))}function Fc(r){return function(){return r}}function mb(r,s){return r==null||r!==r?s:r}var bb=dl(),wb=dl(!0);function vr(r){return r}function zc(r){return Bh(typeof r=="function"?r:Ur(r,S))}function Eb(r){return Vh(Ur(r,S))}function Db(r,s){return kh(r,Ur(s,S))}var Sb=Ke(function(r,s){return function(a){return ss(a,r,s)}}),Ib=Ke(function(r,s){return function(a){return ss(r,a,s)}});function Hc(r,s,a){var l=kt(s),y=Do(s,l);a==null&&!(Et(s)&&(y.length||!l.length))&&(a=s,s=r,r=this,y=Do(s,kt(s)));var m=!(Et(a)&&"chain"in a)||!!a.chain,C=yn(r);return Nr(y,function(N){var q=s[N];r[N]=q,C&&(r.prototype[N]=function(){var X=this.__chain__;if(m||X){var Z=r(this.__wrapped__),ne=Z.__actions__=pr(this.__actions__);return ne.push({func:q,args:arguments,thisArg:r}),Z.__chain__=X,Z}return q.apply(r,Cn([this.value()],arguments))})}),r}function xb(){return Xe._===this&&(Xe._=Xg),this}function Bc(){}function Ob(r){return r=Me(r),Ke(function(s){return Gh(s,r)})}var Pb=bc(mt),Cb=bc(ph),Ab=bc(Va);function ff(r){return Oc(r)?ka(rn(r)):oy(r)}function Tb(r){return function(s){return r==null?t:Xn(r,s)}}var Rb=gl(),Nb=gl(!0);function Kc(){return[]}function Vc(){return!1}function $b(){return{}}function Lb(){return""}function Ub(){return!0}function jb(r,s){if(r=Me(r),r<1||r>V)return[];var a=re,l=Xt(r,re);s=me(s),r-=re;for(var y=Ya(l,s);++a<r;)s(a);return y}function Mb(r){return Re(r)?mt(r,rn):Ir(r)?[r]:pr(Tl(nt(r)))}function qb(r){var s=++Jg;return nt(r)+s}var Fb=Co(function(r,s){return r+s},0),zb=wc("ceil"),Hb=Co(function(r,s){return r/s},1),Bb=wc("floor");function Kb(r){return r&&r.length?Eo(r,vr,oc):t}function Vb(r,s){return r&&r.length?Eo(r,me(s,2),oc):t}function kb(r){return vh(r,vr)}function Gb(r,s){return vh(r,me(s,2))}function Wb(r){return r&&r.length?Eo(r,vr,hc):t}function Yb(r,s){return r&&r.length?Eo(r,me(s,2),hc):t}var Jb=Co(function(r,s){return r*s},1),Qb=wc("round"),Xb=Co(function(r,s){return r-s},0);function Zb(r){return r&&r.length?Wa(r,vr):0}function ew(r,s){return r&&r.length?Wa(r,me(s,2)):0}return _.after=E_,_.ary=Hl,_.assign=um,_.assignIn=rf,_.assignInWith=Ho,_.assignWith=hm,_.at=lm,_.before=Bl,_.bind=Nc,_.bindAll=yb,_.bindKey=Kl,_.castArray=$_,_.chain=ql,_.chunk=By,_.compact=Ky,_.concat=Vy,_.cond=vb,_.conforms=_b,_.constant=Fc,_.countBy=Zv,_.create=fm,_.curry=Vl,_.curryRight=kl,_.debounce=Gl,_.defaults=dm,_.defaultsDeep=pm,_.defer=D_,_.delay=S_,_.difference=ky,_.differenceBy=Gy,_.differenceWith=Wy,_.drop=Yy,_.dropRight=Jy,_.dropRightWhile=Qy,_.dropWhile=Xy,_.fill=Zy,_.filter=t_,_.flatMap=i_,_.flatMapDeep=s_,_.flatMapDepth=o_,_.flatten=Ll,_.flattenDeep=ev,_.flattenDepth=tv,_.flip=I_,_.flow=bb,_.flowRight=wb,_.fromPairs=rv,_.functions=wm,_.functionsIn=Em,_.groupBy=a_,_.initial=iv,_.intersection=sv,_.intersectionBy=ov,_.intersectionWith=av,_.invert=Sm,_.invertBy=Im,_.invokeMap=u_,_.iteratee=zc,_.keyBy=h_,_.keys=kt,_.keysIn=yr,_.map=Uo,_.mapKeys=Om,_.mapValues=Pm,_.matches=Eb,_.matchesProperty=Db,_.memoize=Mo,_.merge=Cm,_.mergeWith=nf,_.method=Sb,_.methodOf=Ib,_.mixin=Hc,_.negate=qo,_.nthArg=Ob,_.omit=Am,_.omitBy=Tm,_.once=x_,_.orderBy=l_,_.over=Pb,_.overArgs=O_,_.overEvery=Cb,_.overSome=Ab,_.partial=$c,_.partialRight=Wl,_.partition=f_,_.pick=Rm,_.pickBy=sf,_.property=ff,_.propertyOf=Tb,_.pull=lv,_.pullAll=jl,_.pullAllBy=fv,_.pullAllWith=dv,_.pullAt=pv,_.range=Rb,_.rangeRight=Nb,_.rearg=P_,_.reject=g_,_.remove=gv,_.rest=C_,_.reverse=Tc,_.sampleSize=v_,_.set=$m,_.setWith=Lm,_.shuffle=__,_.slice=yv,_.sortBy=w_,_.sortedUniq=Dv,_.sortedUniqBy=Sv,_.split=ib,_.spread=A_,_.tail=Iv,_.take=xv,_.takeRight=Ov,_.takeRightWhile=Pv,_.takeWhile=Cv,_.tap=Kv,_.throttle=T_,_.thru=Lo,_.toArray=Zl,_.toPairs=of,_.toPairsIn=af,_.toPath=Mb,_.toPlainObject=tf,_.transform=Um,_.unary=R_,_.union=Av,_.unionBy=Tv,_.unionWith=Rv,_.uniq=Nv,_.uniqBy=$v,_.uniqWith=Lv,_.unset=jm,_.unzip=Rc,_.unzipWith=Ml,_.update=Mm,_.updateWith=qm,_.values=Ri,_.valuesIn=Fm,_.without=Uv,_.words=hf,_.wrap=N_,_.xor=jv,_.xorBy=Mv,_.xorWith=qv,_.zip=Fv,_.zipObject=zv,_.zipObjectDeep=Hv,_.zipWith=Bv,_.entries=of,_.entriesIn=af,_.extend=rf,_.extendWith=Ho,Hc(_,_),_.add=Fb,_.attempt=lf,_.camelCase=Km,_.capitalize=cf,_.ceil=zb,_.clamp=zm,_.clone=L_,_.cloneDeep=j_,_.cloneDeepWith=M_,_.cloneWith=U_,_.conformsTo=q_,_.deburr=uf,_.defaultTo=mb,_.divide=Hb,_.endsWith=Vm,_.eq=Vr,_.escape=km,_.escapeRegExp=Gm,_.every=e_,_.find=r_,_.findIndex=Nl,_.findKey=gm,_.findLast=n_,_.findLastIndex=$l,_.findLastKey=ym,_.floor=Bb,_.forEach=Fl,_.forEachRight=zl,_.forIn=vm,_.forInRight=_m,_.forOwn=mm,_.forOwnRight=bm,_.get=jc,_.gt=F_,_.gte=z_,_.has=Dm,_.hasIn=Mc,_.head=Ul,_.identity=vr,_.includes=c_,_.indexOf=nv,_.inRange=Hm,_.invoke=xm,_.isArguments=ti,_.isArray=Re,_.isArrayBuffer=H_,_.isArrayLike=gr,_.isArrayLikeObject=Nt,_.isBoolean=B_,_.isBuffer=Un,_.isDate=K_,_.isElement=V_,_.isEmpty=k_,_.isEqual=G_,_.isEqualWith=W_,_.isError=Lc,_.isFinite=Y_,_.isFunction=yn,_.isInteger=Yl,_.isLength=Fo,_.isMap=Jl,_.isMatch=J_,_.isMatchWith=Q_,_.isNaN=X_,_.isNative=Z_,_.isNil=tm,_.isNull=em,_.isNumber=Ql,_.isObject=Et,_.isObjectLike=Ct,_.isPlainObject=ls,_.isRegExp=Uc,_.isSafeInteger=rm,_.isSet=Xl,_.isString=zo,_.isSymbol=Ir,_.isTypedArray=Ti,_.isUndefined=nm,_.isWeakMap=im,_.isWeakSet=sm,_.join=cv,_.kebabCase=Wm,_.last=Mr,_.lastIndexOf=uv,_.lowerCase=Ym,_.lowerFirst=Jm,_.lt=om,_.lte=am,_.max=Kb,_.maxBy=Vb,_.mean=kb,_.meanBy=Gb,_.min=Wb,_.minBy=Yb,_.stubArray=Kc,_.stubFalse=Vc,_.stubObject=$b,_.stubString=Lb,_.stubTrue=Ub,_.multiply=Jb,_.nth=hv,_.noConflict=xb,_.noop=Bc,_.now=jo,_.pad=Qm,_.padEnd=Xm,_.padStart=Zm,_.parseInt=eb,_.random=Bm,_.reduce=d_,_.reduceRight=p_,_.repeat=tb,_.replace=rb,_.result=Nm,_.round=Qb,_.runInContext=M,_.sample=y_,_.size=m_,_.snakeCase=nb,_.some=b_,_.sortedIndex=vv,_.sortedIndexBy=_v,_.sortedIndexOf=mv,_.sortedLastIndex=bv,_.sortedLastIndexBy=wv,_.sortedLastIndexOf=Ev,_.startCase=sb,_.startsWith=ob,_.subtract=Xb,_.sum=Zb,_.sumBy=ew,_.template=ab,_.times=jb,_.toFinite=vn,_.toInteger=Me,_.toLength=ef,_.toLower=cb,_.toNumber=qr,_.toSafeInteger=cm,_.toString=nt,_.toUpper=ub,_.trim=hb,_.trimEnd=lb,_.trimStart=fb,_.truncate=db,_.unescape=pb,_.uniqueId=qb,_.upperCase=gb,_.upperFirst=qc,_.each=Fl,_.eachRight=zl,_.first=Ul,Hc(_,function(){var r={};return en(_,function(s,a){it.call(_.prototype,a)||(r[a]=s)}),r}(),{chain:!1}),_.VERSION=i,Nr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){_[r].placeholder=_}),Nr(["drop","take"],function(r,s){Ye.prototype[r]=function(a){a=a===t?1:Kt(Me(a),0);var l=this.__filtered__&&!s?new Ye(this):this.clone();return l.__filtered__?l.__takeCount__=Xt(a,l.__takeCount__):l.__views__.push({size:Xt(a,re),type:r+(l.__dir__<0?"Right":"")}),l},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Nr(["filter","map","takeWhile"],function(r,s){var a=s+1,l=a==w||a==ee;Ye.prototype[r]=function(y){var m=this.clone();return m.__iteratees__.push({iteratee:me(y,3),type:a}),m.__filtered__=m.__filtered__||l,m}}),Nr(["head","last"],function(r,s){var a="take"+(s?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Nr(["initial","tail"],function(r,s){var a="drop"+(s?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(vr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,s){return typeof r=="function"?new Ye(this):this.map(function(a){return ss(a,r,s)})}),Ye.prototype.reject=function(r){return this.filter(qo(me(r)))},Ye.prototype.slice=function(r,s){r=Me(r);var a=this;return a.__filtered__&&(r>0||s<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),s!==t&&(s=Me(s),a=s<0?a.dropRight(-s):a.take(s-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},en(Ye.prototype,function(r,s){var a=/^(?:filter|find|map|reject)|While$/.test(s),l=/^(?:head|last)$/.test(s),y=_[l?"take"+(s=="last"?"Right":""):s],m=l||/^find/.test(s);y&&(_.prototype[s]=function(){var C=this.__wrapped__,N=l?[1]:arguments,q=C instanceof Ye,X=N[0],Z=q||Re(C),ne=function(Ge){var Ze=y.apply(_,Cn([Ge],N));return l&&he?Ze[0]:Ze};Z&&a&&typeof X=="function"&&X.length!=1&&(q=Z=!1);var he=this.__chain__,ye=!!this.__actions__.length,Ee=m&&!he,ze=q&&!ye;if(!m&&Z){C=ze?C:new Ye(this);var De=r.apply(C,N);return De.__actions__.push({func:Lo,args:[ne],thisArg:t}),new Lr(De,he)}return Ee&&ze?r.apply(this,N):(De=this.thru(ne),Ee?l?De.value()[0]:De.value():De)})}),Nr(["pop","push","shift","sort","splice","unshift"],function(r){var s=oo[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",l=/^(?:pop|shift)$/.test(r);_.prototype[r]=function(){var y=arguments;if(l&&!this.__chain__){var m=this.value();return s.apply(Re(m)?m:[],y)}return this[a](function(C){return s.apply(Re(C)?C:[],y)})}}),en(Ye.prototype,function(r,s){var a=_[s];if(a){var l=a.name+"";it.call(xi,l)||(xi[l]=[]),xi[l].push({name:s,func:a})}}),xi[Po(t,ie).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=p0,Ye.prototype.reverse=g0,Ye.prototype.value=y0,_.prototype.at=Vv,_.prototype.chain=kv,_.prototype.commit=Gv,_.prototype.next=Wv,_.prototype.plant=Jv,_.prototype.reverse=Qv,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=Xv,_.prototype.first=_.prototype.head,Xi&&(_.prototype[Xi]=Yv),_},Di=Gg();Rt?((Rt.exports=Di)._=Di,ut._=Di):Xe._=Di}).call(bs)})(Hu,Hu.exports);var o5=Object.defineProperty,a5=Object.defineProperties,c5=Object.getOwnPropertyDescriptors,Vd=Object.getOwnPropertySymbols,u5=Object.prototype.hasOwnProperty,h5=Object.prototype.propertyIsEnumerable,kd=(n,e,t)=>e in n?o5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Go=(n,e)=>{for(var t in e||(e={}))u5.call(e,t)&&kd(n,t,e[t]);if(Vd)for(var t of Vd(e))h5.call(e,t)&&kd(n,t,e[t]);return n},l5=(n,e)=>a5(n,c5(e));function qn(n,e,t){var i;const o=XE(n);return((i=e.rpcMap)==null?void 0:i[o.reference])||`${s5}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function fi(n){return n.includes(":")?n.split(":")[1]:n}function Eg(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function f5(n,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(n));if(!t.length)return[];const i=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;i.push(...c)}),i}function d5(n={},e={}){const t=Gd(n),i=Gd(e);return Hu.exports.merge(t,i)}function Gd(n){var e,t,i,o;const c={};if(!Mi(n))return c;for(const[h,f]of Object.entries(n)){const g=nh(h)?[h]:f.chains,p=f.methods||[],v=f.events||[],S=f.rpcMap||{},D=ws(h);c[D]=l5(Go(Go({},c[D]),f),{chains:Qc(g,(e=c[D])==null?void 0:e.chains),methods:Qc(p,(t=c[D])==null?void 0:t.methods),events:Qc(v,(i=c[D])==null?void 0:i.events),rpcMap:Go(Go({},S),(o=c[D])==null?void 0:o.rpcMap)})}return c}function p5(n){return n.includes(":")?n.split(":")[2]:n}function g5(n){const e={};for(const[t,i]of Object.entries(n)){const o=i.methods||[],c=i.events||[],h=i.accounts||[],f=nh(t)?[t]:i.chains?i.chains:Eg(i.accounts);e[t]={chains:f,methods:o,events:c,accounts:h}}return e}function hu(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Dg={},bt=n=>Dg[n],lu=(n,e)=>{Dg[n]=e};class y5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(In.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const o=fi(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||qn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sn(new zn(i,bt("disableProviderPing")))}}class v5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(In.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const i=t||qn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sn(new zn(i,bt("disableProviderPing")))}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const o=parseInt(fi(t));e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,i;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class _5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(In.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const o=fi(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||qn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sn(new zn(i,bt("disableProviderPing")))}}class m5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(In.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const o=fi(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||qn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sn(new zn(i,bt("disableProviderPing")))}}class b5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(In.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const i=this.getCardanoRPCUrl(t),o=fi(t);e[o]=this.createHttpProvider(o,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sn(new zn(i,bt("disableProviderPing")))}}class w5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(In.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const o=fi(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||qn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sn(new zn(i,bt("disableProviderPing")))}}class E5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(In.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const o=fi(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||qn(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sn(new zn(i,bt("disableProviderPing")))}}class D5{constructor(e){this.name="near",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||qn(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(In.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||qn(e,this.namespace);return typeof i>"u"?void 0:new Sn(new zn(i,bt("disableProviderPing")))}}var S5=Object.defineProperty,I5=Object.defineProperties,x5=Object.getOwnPropertyDescriptors,Wd=Object.getOwnPropertySymbols,O5=Object.prototype.hasOwnProperty,P5=Object.prototype.propertyIsEnumerable,Yd=(n,e,t)=>e in n?S5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Wo=(n,e)=>{for(var t in e||(e={}))O5.call(e,t)&&Yd(n,t,e[t]);if(Wd)for(var t of Wd(e))P5.call(e,t)&&Yd(n,t,e[t]);return n},fu=(n,e)=>I5(n,x5(e));class fh{constructor(e){this.events=new ku,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Bd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new fh(e);return await t.initialize(),t}async request(e,t){const[i,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Wo({},e),chainId:`${i}:${o}`,topic:this.session.topic})}sendAsync(e,t,i){const o=new Date().getTime();this.request(e,i).then(c=>t(null,va(o,c))).catch(c=>t(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:At("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=g5(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==bg)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[i,o]=this.validateChain(e);this.getProvider(i).setDefaultChain(o,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(on(t)){for(const i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Xx.init({logger:this.providerOpts.logger||Bd,relayUrl:this.providerOpts.relayUrl||r5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>ws(t)))];lu("client",this.client),lu("events",this.events),lu("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const i=f5(t,this.session),o=Eg(i),c=d5(this.namespaces,this.optionalNamespaces),h=fu(Wo({},c[t]),{accounts:i,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new v5({namespace:h});break;case"solana":this.rpcProviders[t]=new _5({namespace:h});break;case"cosmos":this.rpcProviders[t]=new m5({namespace:h});break;case"polkadot":this.rpcProviders[t]=new y5({namespace:h});break;case"cip34":this.rpcProviders[t]=new b5({namespace:h});break;case"elrond":this.rpcProviders[t]=new w5({namespace:h});break;case"multiversx":this.rpcProviders[t]=new E5({namespace:h});break;case"near":this.rpcProviders[t]=new D5({namespace:h});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:i}=t;if(i.name==="accountsChanged"){const o=i.data;o&&on(o)&&this.events.emit("accountsChanged",o.map(p5))}else if(i.name==="chainChanged"){const o=t.chainId,c=t.event.data,h=ws(o),f=hu(o)!==hu(c)?`${h}:${hu(c)}`:o;this.onChainChanged(f)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i;const{namespaces:o}=t,c=(i=this.client)==null?void 0:i.session.get(e);this.session=fu(Wo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",fu(Wo({},At("USER_DISCONNECTED")),{data:e.topic}))}),this.on(In.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:i,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",i)}validateChain(e){const[t,i]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,i];if(t&&!Object.keys(this.namespaces||{}).map(h=>ws(h)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];const o=ws(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var i;if(!this.namespaces)return;const[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((i=this.namespaces[o])!=null?i:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Kd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Kd}/${e}`)}}const C5=fh,A5="wc",T5="ethereum_provider",R5=`${A5}@2:${T5}:`,N5="https://rpc.walletconnect.com/v1/",Bu=["eth_sendTransaction","personal_sign"],$5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Ku=["chainChanged","accountsChanged"],L5=["chainChanged","accountsChanged","message","disconnect","connect"];var U5=Object.defineProperty,j5=Object.defineProperties,M5=Object.getOwnPropertyDescriptors,Jd=Object.getOwnPropertySymbols,q5=Object.prototype.hasOwnProperty,F5=Object.prototype.propertyIsEnumerable,Qd=(n,e,t)=>e in n?U5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ds=(n,e)=>{for(var t in e||(e={}))q5.call(e,t)&&Qd(n,t,e[t]);if(Jd)for(var t of Jd(e))F5.call(e,t)&&Qd(n,t,e[t]);return n},Xd=(n,e)=>j5(n,M5(e));function oa(n){return Number(n[0].split(":")[1])}function du(n){return`0x${n.toString(16)}`}function z5(n){const{chains:e,optionalChains:t,methods:i,optionalMethods:o,events:c,optionalEvents:h,rpcMap:f}=n;if(!on(e))throw new Error("Invalid chains");const g={chains:e,methods:i||Bu,events:c||Ku,rpcMap:Ds({},e.length?{[oa(e)]:f[oa(e)]}:{})},p=c==null?void 0:c.filter(x=>!Ku.includes(x)),v=i==null?void 0:i.filter(x=>!Bu.includes(x));if(!t&&!h&&!o&&!(p!=null&&p.length)&&!(v!=null&&v.length))return{required:e.length?g:void 0};const S=(p==null?void 0:p.length)&&(v==null?void 0:v.length)||!t,D={chains:[...new Set(S?g.chains.concat(t||[]):t)],methods:[...new Set(g.methods.concat(o!=null&&o.length?o:$5))],events:[...new Set(g.events.concat(h!=null&&h.length?h:L5))],rpcMap:f};return{required:e.length?g:void 0,optional:t.length?D:void 0}}class dh{constructor(){this.events=new Cr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=R5,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new dh;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:i}=z5(this.rpc);try{const o=await new Promise(async(h,f)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Xd(Ds({namespaces:Ds({},t&&{[this.namespace]:t})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{h(p)}).catch(p=>{f(new Error(p.message))})});if(!o)return;const c=ZE(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:du(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:i}=t;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",du(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Xd(Ds({},At("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,i;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(i=this.modal)==null||i.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",du(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,i,o]=e.split(":");return{chainId:`${t}:${i}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,i;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(i=e==null?void 0:e.optionalChains)!=null?i:[],h=o.concat(c);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Bu:[],g=o.length?(e==null?void 0:e.events)||Ku:[],p=(e==null?void 0:e.optionalMethods)||[],v=(e==null?void 0:e.optionalEvents)||[],S=(e==null?void 0:e.rpcMap)||this.buildRpcMap(h,e.projectId),D=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(x=>this.formatChainId(x)),optionalChains:c.map(x=>this.formatChainId(x)),methods:f,events:g,optionalMethods:p,optionalEvents:v,rpcMap:S,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:D,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const i={};return e.forEach(o=>{i[o]=this.getRpcUrl(o,t)}),i}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?oa(this.rpc.chains):oa(this.rpc.optionalChains),this.signer=await C5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:i}=await rw(()=>import("./index-hmIGmlT8.js").then(o=>o.i),__vite__mapDeps([0,1,2]));t=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Ds({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:i,rpcMap:o}=e;t&&on(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),i&&on(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(c=>this.formatChainId(c)),i.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var i;return((i=this.rpc.rpcMap)==null?void 0:i[e])||`${N5}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const iO=dh;export{iO as EthereumProvider,L5 as OPTIONAL_EVENTS,$5 as OPTIONAL_METHODS,Ku as REQUIRED_EVENTS,Bu as REQUIRED_METHODS,dh as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-hmIGmlT8.js","assets/index-07IEkagI.js","assets/index-FoI3ykbO.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}